

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>freqDomain &mdash; blip 0.01 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../blip.html" class="icon icon-home"> blip
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../classes.html">Modules and Methods</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../blip.html">blip</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../blip.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>freqDomain</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for freqDomain</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<div class="viewcode-block" id="freqDomain"><a class="viewcode-back" href="../classes.html#freqDomain.freqDomain">[docs]</a><span class="k">class</span> <span class="nc">freqDomain</span><span class="p">():</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Module containing methods which do various types of frequency domain calcualtions. The methods here include calculation of antenna patters for a single doppler channel, for the three michelson channels or for the AET TDI channels and calculation of noise power spectra for various channel combinations. </span>
<span class="sd">    &#39;&#39;&#39;</span>


<div class="viewcode-block" id="freqDomain.doppler_response"><a class="viewcode-back" href="../classes.html#freqDomain.freqDomain.doppler_response">[docs]</a>    <span class="k">def</span> <span class="nf">doppler_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
        
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculate Antenna pattern/ detector transfer function for a GW originating in the direction of (theta, phi) for the doppler channel of a stationary LISA. Return the detector response for + and x polarization. Note that f0 is (pi*L*f)/c and is input as an array</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">        f0   : float</span>
<span class="sd">            A numpy array of scaled frequencies (see above for def)</span>

<span class="sd">        phi theta  : float</span>
<span class="sd">            Sky position values. </span>
<span class="sd">    </span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>

<span class="sd">        Rplus, Rcorss   :   float</span>
<span class="sd">            Plus and cross antenna Patterns for the given sky direction</span>
<span class="sd">        &#39;&#39;&#39;</span>


        <span class="n">ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        
        <span class="c1">## udir is just u.r, where r is the directional vector</span>
        <span class="n">udir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>

        <span class="c1"># Initlize arrays for the detector reponse</span>
        <span class="n">Rplus</span><span class="p">,</span> <span class="n">Rcross</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

        <span class="c1"># Calculate the detector response for each frequency</span>

        <span class="c1"># Calculate GW transfer function for the michelson channels</span>
        <span class="n">gammaU</span>    <span class="o">=</span>    <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">udir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">udir</span><span class="p">))</span> <span class="o">+</span> \
                            <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">udir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">udir</span><span class="p">)))</span>


        <span class="c1">## Michelson Channel Antenna patterns for + pol: Fplus_u = 1/2(u x u)Gamma(udir, f):eplus</span>

        <span class="n">Rplus</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
                            <span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">gammaU</span>

        <span class="c1">## Michelson Channel Antenna patterns for x pol</span>
        <span class="c1">##  Fcross_u = 1/2(u x u)Gamma(udir, f):ecross</span>

        <span class="n">Rcross</span> <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">gammaU</span>

        <span class="k">return</span> <span class="n">Rplus</span><span class="p">,</span> <span class="n">Rcross</span></div>


<div class="viewcode-block" id="freqDomain.michelson_response"><a class="viewcode-back" href="../classes.html#freqDomain.freqDomain.michelson_response">[docs]</a>    <span class="k">def</span> <span class="nf">michelson_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span> 

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculate Antenna pattern/ detector transfer function for a GW originating in the direction of (theta, phi) for the three Michelson channels of a stationary LISA. Return the detector response for + and x polarization. Note that f0 is (pi*L*f)/c and is input as an array</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">        f0   : float</span>
<span class="sd">            A numpy array of scaled frequencies (see above for def)</span>

<span class="sd">        phi theta  : float</span>
<span class="sd">            Sky position values. </span>
<span class="sd">    </span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>

<span class="sd">        R1plus, R1cross, R2plus, R2cross, R3plus, R3cross   :   float</span>
<span class="sd">            Plus and cross antenna Patterns for the given sky direction for the three channels</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

        <span class="c1">## udir is just u.r, where r is the directional vector</span>
        <span class="n">udir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">vdir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">wdir</span> <span class="o">=</span> <span class="n">vdir</span> <span class="o">-</span> <span class="n">udir</span>

        <span class="c1"># Calculate GW transfer function for the michelson channels</span>
        <span class="n">gammaU</span>    <span class="o">=</span>    <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">udir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">udir</span><span class="p">))</span> <span class="o">+</span> \
                         <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">udir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">udir</span><span class="p">)))</span>

        <span class="n">gammaV</span>    <span class="o">=</span>    <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">vdir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">vdir</span><span class="p">))</span> <span class="o">+</span> \
                         <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">vdir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">vdir</span><span class="p">)))</span>

        <span class="n">gammaW</span>    <span class="o">=</span>    <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">wdir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">wdir</span><span class="p">))</span> <span class="o">+</span> \
                         <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">wdir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wdir</span><span class="p">)))</span>

        <span class="c1">## Michelson Channel Antenna patterns for + pol</span>
        <span class="c1">##  Fplus_u = 1/2(u x u)Gamma(udir, f):eplus</span>
        <span class="n">Fplus_u</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
                        <span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">gammaU</span>

        <span class="n">Fplus_v</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span> \
                     <span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">gammaV</span>

        <span class="n">Fplus_w</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">gammaW</span>

        <span class="c1">## Michelson Channel Antenna patterns for x pol</span>
        <span class="c1">##  Fcross_u = 1/2(u x u)Gamma(udir, f):ecross</span>

        <span class="n">Fcross_u</span>  <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">gammaU</span>
        <span class="n">Fcross_v</span>  <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">gammaV</span>
        <span class="n">Fcross_w</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">gammaW</span>

        <span class="c1">## Compelte Michelson antenna patterns</span>
        <span class="c1">## Calculate Fplus</span>
        <span class="n">R1plus</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fplus_u</span> <span class="o">-</span> <span class="n">Fplus_v</span><span class="p">)</span>
        <span class="n">R2plus</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fplus_w</span> <span class="o">-</span> <span class="n">Fplus_u</span><span class="p">)</span>
        <span class="n">R3plus</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fplus_v</span> <span class="o">-</span> <span class="n">Fplus_w</span><span class="p">)</span>

        <span class="c1">## Calculate Fcross</span>
        <span class="n">R1cross</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fcross_u</span> <span class="o">-</span> <span class="n">Fcross_v</span><span class="p">)</span>
        <span class="n">R2cross</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fcross_w</span> <span class="o">-</span> <span class="n">Fcross_u</span><span class="p">)</span>
        <span class="n">R3cross</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fcross_v</span> <span class="o">-</span> <span class="n">Fcross_w</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">R1plus</span><span class="p">,</span> <span class="n">R1cross</span><span class="p">,</span> <span class="n">R2plus</span><span class="p">,</span> <span class="n">R2cross</span><span class="p">,</span> <span class="n">R3plus</span><span class="p">,</span> <span class="n">R3cross</span></div>

<div class="viewcode-block" id="freqDomain.aet_response"><a class="viewcode-back" href="../classes.html#freqDomain.freqDomain.aet_response">[docs]</a>    <span class="k">def</span> <span class="nf">aet_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span> 



        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculate Antenna pattern/ detector transfer function for a GW originating in the direction of (theta, phi) for the A, E and T TDI channels of a stationary LISA. Return the detector response for + and x polarization. Note that f0 is (pi*L*f)/c and is input as an array</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">        f0   : float</span>
<span class="sd">            A numpy array of scaled frequencies (see above for def)</span>

<span class="sd">        phi theta  : float</span>
<span class="sd">            Sky position values. </span>
<span class="sd">    </span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>

<span class="sd">        RAplus, RAcross, REplus, REcross, RTplus, RTcross   :   float</span>
<span class="sd">            Plus and cross antenna Patterns for the given sky direction for the three channels</span>
<span class="sd">        &#39;&#39;&#39;</span>


        <span class="n">R1plus</span><span class="p">,</span> <span class="n">R1cross</span><span class="p">,</span> <span class="n">R2plus</span><span class="p">,</span> <span class="n">R2cross</span><span class="p">,</span> <span class="n">R3plus</span><span class="p">,</span> <span class="n">R3cross</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">michelson_response</span><span class="p">(</span><span class="n">f0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
        

        <span class="c1">## Calculate antenna patterns for the A, E and T channels</span>
        <span class="n">RAplus</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">R1plus</span> <span class="o">-</span> <span class="n">R2plus</span> <span class="o">-</span> <span class="n">R3plus</span><span class="p">)</span>
        <span class="n">REplus</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R3plus</span> <span class="o">-</span> <span class="n">R2plus</span><span class="p">)</span>
        <span class="n">RTplus</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R1plus</span> <span class="o">+</span> <span class="n">R3plus</span> <span class="o">+</span> <span class="n">R2plus</span><span class="p">)</span>

        <span class="n">RAcross</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">R1cross</span> <span class="o">-</span> <span class="n">R2cross</span> <span class="o">-</span> <span class="n">R3cross</span><span class="p">)</span>
        <span class="n">REcross</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R3cross</span> <span class="o">-</span> <span class="n">R2cross</span><span class="p">)</span>
        <span class="n">RTcross</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R1cross</span> <span class="o">+</span> <span class="n">R3cross</span> <span class="o">+</span> <span class="n">R2cross</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">RAplus</span><span class="p">,</span> <span class="n">RAcross</span><span class="p">,</span> <span class="n">REplus</span><span class="p">,</span> <span class="n">REcross</span><span class="p">,</span> <span class="n">RTplus</span><span class="p">,</span> <span class="n">RTcross</span></div>

<div class="viewcode-block" id="freqDomain.tdi_isgwb_response"><a class="viewcode-back" href="../classes.html#freqDomain.freqDomain.tdi_isgwb_response">[docs]</a>    <span class="k">def</span> <span class="nf">tdi_isgwb_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f0</span><span class="p">):</span> 

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calcualte the Antenna pattern/ detector transfer function functions to an isotropic SGWB using A, E and T TDI channels. Note that since this is the response to an isotropic background, the response function is integrated over sky direction and averaged over polarozation. The angular integral is a linear and rectangular in the cos(theta) and phi space.  Note that f0 is (pi*L*f)/c and is input as an array</span>

<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">        f0   : float</span>
<span class="sd">            A numpy array of scaled frequencies (see above for def)</span>

<span class="sd">    </span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>

<span class="sd">        R1, R2 and R3   :   float</span>
<span class="sd">            Antenna Patterns for the given sky direction for the three channels, integrated over sky direction and averaged over polarization.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        
        <span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>

        <span class="p">[</span><span class="n">ct</span><span class="p">,</span> <span class="n">phi</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">pp</span><span class="p">)</span>
        <span class="n">dct</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ct</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dphi</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">phi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1">## udir is just u.r, where r is the directional vector</span>
        <span class="n">udir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">vdir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">wdir</span> <span class="o">=</span> <span class="n">vdir</span> <span class="o">-</span> <span class="n">udir</span>

        <span class="c1"># Initlize arrays for the detector reponse</span>
        <span class="n">R1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">R2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">R3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

        <span class="c1"># Calculate the detector response for each frequency</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>

            <span class="c1"># Calculate GW transfer function for the michelson channels</span>
            <span class="n">gammaU</span>    <span class="o">=</span>    <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">udir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">udir</span><span class="p">))</span> <span class="o">+</span> \
                             <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">udir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">udir</span><span class="p">)))</span>

            <span class="n">gammaV</span>    <span class="o">=</span>    <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">vdir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">vdir</span><span class="p">))</span> <span class="o">+</span> \
                             <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">vdir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">vdir</span><span class="p">)))</span>

            <span class="n">gammaW</span>    <span class="o">=</span>    <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">wdir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">wdir</span><span class="p">))</span> <span class="o">+</span> \
                             <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">wdir</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wdir</span><span class="p">)))</span>

            <span class="c1">## Michelson Channel Antenna patterns for + pol</span>
            <span class="c1">##  Fplus_u = 1/2(u x u)Gamma(udir, f):eplus</span>

            <span class="n">Fplus_u</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
                            <span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">gammaU</span>

            <span class="n">Fplus_v</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span> \
                         <span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">gammaV</span>

            <span class="n">Fplus_w</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">gammaW</span>


            <span class="c1">## Michelson Channel Antenna patterns for x pol</span>
            <span class="c1">##  Fcross_u = 1/2(u x u)Gamma(udir, f):ecross</span>
            <span class="n">Fcross_u</span>  <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">gammaU</span>
            <span class="n">Fcross_v</span>  <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ct</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">gammaV</span>
            <span class="n">Fcross_w</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">gammaW</span>


            <span class="c1">## First Michelson antenna patterns</span>
            <span class="c1">## Calculate Fplus</span>
            <span class="n">Fplus1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fplus_u</span> <span class="o">-</span> <span class="n">Fplus_v</span><span class="p">)</span>
            <span class="n">Fplus2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fplus_w</span> <span class="o">-</span> <span class="n">Fplus_u</span><span class="p">)</span>
            <span class="n">Fplus3</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fplus_v</span> <span class="o">-</span> <span class="n">Fplus_w</span><span class="p">)</span>

            <span class="c1">## Calculate Fcross</span>
            <span class="n">Fcross1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fcross_u</span> <span class="o">-</span> <span class="n">Fcross_v</span><span class="p">)</span>
            <span class="n">Fcross2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fcross_w</span> <span class="o">-</span> <span class="n">Fcross_u</span><span class="p">)</span>
            <span class="n">Fcross3</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fcross_v</span> <span class="o">-</span> <span class="n">Fcross_w</span><span class="p">)</span>

            <span class="c1">## Calculate antenna patterns for the A, E and T channels -  We are switiching to doppler channel.</span>
            <span class="n">FAplus</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Fplus1</span> <span class="o">-</span> <span class="n">Fplus2</span> <span class="o">-</span> <span class="n">Fplus3</span><span class="p">)</span>
            <span class="n">FEplus</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">Fplus3</span> <span class="o">-</span> <span class="n">Fplus2</span><span class="p">)</span>
            <span class="n">FTplus</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">Fplus1</span> <span class="o">+</span> <span class="n">Fplus3</span> <span class="o">+</span> <span class="n">Fplus2</span><span class="p">)</span>

            <span class="n">FAcross</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Fcross1</span> <span class="o">-</span> <span class="n">Fcross2</span> <span class="o">-</span> <span class="n">Fcross3</span><span class="p">)</span>
            <span class="n">FEcross</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">Fcross3</span> <span class="o">-</span> <span class="n">Fcross2</span><span class="p">)</span>
            <span class="n">FTcross</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">Fcross1</span> <span class="o">+</span> <span class="n">Fcross3</span> <span class="o">+</span> <span class="n">Fcross2</span><span class="p">)</span>

            <span class="c1">## Detector response for the TDI Channels, summed over polarization</span>
            <span class="c1">## and integrated over sky direction</span>
            <span class="n">R1</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">dct</span><span class="o">*</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">FAplus</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">FAcross</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">R2</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">dct</span><span class="o">*</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">FEplus</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">FEcross</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">R3</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">dct</span><span class="o">*</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">FTplus</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">FTcross</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>



        <span class="k">return</span> <span class="n">R1</span><span class="p">,</span> <span class="n">R2</span><span class="p">,</span> <span class="n">R3</span></div>

<div class="viewcode-block" id="freqDomain.fundamental_noise_spectrum"><a class="viewcode-back" href="../classes.html#freqDomain.freqDomain.fundamental_noise_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">fundamental_noise_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">Np</span><span class="o">=</span><span class="mf">4e-41</span><span class="p">,</span> <span class="n">Na</span><span class="o">=</span><span class="mf">1.44e-48</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creates a frequency array of fundamentla noise estimates for lisa. Currently we consisder only contain only position and acceleration noise sources. The default values are specifications pulled from 2017 Lisa proposal noise estimations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">        freqs   : float</span>
<span class="sd">            A numpy array of frequencies</span>

<span class="sd">        Np (optional) : float</span>
<span class="sd">            Position noise value</span>
<span class="sd">        </span>
<span class="sd">        Na (optional) : float</span>
<span class="sd">            Acceleration noise level</span>
<span class="sd">    </span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>

<span class="sd">        Sp, Sa   :   float</span>
<span class="sd">            Frequencies array for position and acceleration noises for each satellite</span>


<span class="sd">        &#39;&#39;&#39;</span> 
        
        <span class="n">Sp</span> <span class="o">=</span> <span class="n">Np</span>
        <span class="n">Sa</span> <span class="o">=</span> <span class="n">Na</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">16e-8</span><span class="o">/</span><span class="n">freqs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freqs</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Sp</span><span class="p">,</span> <span class="n">Sa</span></div>

<div class="viewcode-block" id="freqDomain.aet_noise_spectrum"><a class="viewcode-back" href="../classes.html#freqDomain.freqDomain.aet_noise_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">aet_noise_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">Np</span><span class="o">=</span><span class="mf">4e-41</span><span class="p">,</span> <span class="n">Na</span><span class="o">=</span><span class="mf">1.44e-48</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculates A, E, and T channel noise spectra for a stationary lisa. Following the defintions in</span>
<span class="sd">        Adams &amp; Cornish, http://iopscience.iop.org/article/10.1088/0264-9381/18/17/308</span>


<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">        freqs   : float</span>
<span class="sd">            A numpy array of frequencies</span>

<span class="sd">        Np (optional) : float</span>
<span class="sd">            Position noise value</span>
<span class="sd">        </span>
<span class="sd">        Na (optional) : float</span>
<span class="sd">            Acceleration noise level</span>
<span class="sd">    </span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>

<span class="sd">        SAA, SEE, STT   :   float</span>
<span class="sd">            Frequencies arrays with the noise PSD for the A, E and T TDI channels</span>


<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Get Sp and Sa</span>
        <span class="n">Sp</span><span class="p">,</span> <span class="n">Sa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fundamental_noise_spectrum</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">Np</span><span class="p">,</span> <span class="n">Na</span><span class="p">)</span>


        <span class="c1">## Noise spectra of the TDI Channels</span>
        <span class="n">SAA</span> <span class="o">=</span> <span class="p">(</span><span class="mf">16.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Sp</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> \
            <span class="o">+</span> <span class="p">(</span><span class="mf">16.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Sa</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>


        <span class="n">SEE</span> <span class="o">=</span> <span class="p">(</span><span class="mf">16.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Sp</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">))</span> \
            <span class="o">+</span> <span class="p">(</span><span class="mf">16.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Sa</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">)</span> <span class="o">+</span>  <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

        <span class="n">STT</span> <span class="o">=</span> <span class="p">(</span><span class="mf">16.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Sp</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">))</span> \
            <span class="o">+</span> <span class="p">(</span><span class="mf">16.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Sa</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


        <span class="k">return</span> <span class="n">SAA</span><span class="p">,</span> <span class="n">SEE</span><span class="p">,</span> <span class="n">STT</span></div></div>


</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Sharan Banagiri

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>