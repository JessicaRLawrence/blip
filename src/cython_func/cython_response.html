<!DOCTYPE html>
<!-- Generated by Cython 0.29.10 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: cython_response.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.10</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="cython_response.c">cython_response.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="c"># -*- coding: utf-8 -*-</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: <span class="c"># cython: profile=True</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: <span class="k">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">004</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">005</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;gsl/gsl_sf_trig.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>:     <span class="n">double</span> <span class="n">gsl_sf_sinc</span><span class="p">(</span><span class="n">double</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>:     <span class="n">double</span> <span class="n">gsl_sf_sin</span><span class="p">(</span><span class="n">double</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>:     <span class="n">double</span> <span class="n">gsl_sf_cos</span><span class="p">(</span><span class="n">double</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;math.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>:    <span class="n">double</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">double</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: <span class="c">#cdef extern from &quot;gsl/gsl_math.h&quot;:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;gsl/gsl_rng.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>:    <span class="k">ctypedef</span> <span class="k">struct</span> <span class="nc">gsl_rng_type</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>:        <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>:    <span class="k">ctypedef</span> <span class="k">struct</span> <span class="nc">gsl_rng</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>:        <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>:    <span class="n">gsl_rng_type</span> <span class="o">*</span><span class="n">gsl_rng_mt19937</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>:    <span class="n">gsl_rng</span> <span class="o">*</span><span class="n">gsl_rng_alloc</span><span class="p">(</span><span class="n">gsl_rng_type</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">027</span>: <span class="k">cdef</span> <span class="kt">gsl_rng</span> *<span class="nf">r</span> <span class="o">=</span> <span class="n">gsl_rng_alloc</span><span class="p">(</span><span class="n">gsl_rng_mt19937</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_15cython_response_r = gsl_rng_alloc(gsl_rng_mt19937);
</pre><pre class="cython line score-0">&#xA0;<span class="">028</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;gsl/gsl_randist.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>:    <span class="n">double</span> <span class="n">gsl_ran_gaussian</span><span class="p">(</span><span class="n">gsl_rng</span> <span class="o">*</span> <span class="n">r</span><span class="p">,</span><span class="n">double</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>: <span class="c">### --------------- Methods calling GSL Functions ------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">unit_nrm_gsl</span><span class="p">():</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_15cython_response_unit_nrm_gsl(void) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("unit_nrm_gsl", 0);
  <span class='trace'>__Pyx_TraceCall</span>("unit_nrm_gsl", __pyx_f[0], 35, 0, <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("cython_response.unit_nrm_gsl", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>:     <span class="k">return</span> <span class="n">gsl_ran_gaussian</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = gsl_ran_gaussian(__pyx_v_15cython_response_r, 1.0);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">037</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">038</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">sine_gsl</span><span class="p">(</span><span class="n">double</span> <span class="n">x</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_15cython_response_sine_gsl(double __pyx_v_x) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sine_gsl", 0);
  <span class='trace'>__Pyx_TraceCall</span>("sine_gsl", __pyx_f[0], 38, 0, <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("cython_response.sine_gsl", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">039</span>:     <span class="k">return</span> <span class="n">gsl_sf_sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = gsl_sf_sin(__pyx_v_x);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">040</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">cos_gsl</span><span class="p">(</span><span class="n">double</span> <span class="n">x</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_15cython_response_cos_gsl(double __pyx_v_x) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cos_gsl", 0);
  <span class='trace'>__Pyx_TraceCall</span>("cos_gsl", __pyx_f[0], 41, 0, <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("cython_response.cos_gsl", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>:     <span class="k">return</span> <span class="n">gsl_sf_cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = gsl_sf_cos(__pyx_v_x);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">043</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">044</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">sinc_gsl</span><span class="p">(</span><span class="n">double</span> <span class="n">x</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_15cython_response_sinc_gsl(double __pyx_v_x) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sinc_gsl", 0);
  <span class='trace'>__Pyx_TraceCall</span>("sinc_gsl", __pyx_f[0], 44, 0, <span class='error_goto'>__PYX_ERR(0, 44, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("cython_response.sinc_gsl", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>:     <span class="k">return</span> <span class="n">gsl_sf_sinc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = gsl_sf_sinc(__pyx_v_x);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">046</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">sqrt_gsl</span><span class="p">(</span><span class="n">double</span> <span class="n">n</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_15cython_response_sqrt_gsl(double __pyx_v_n) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sqrt_gsl", 0);
  <span class='trace'>__Pyx_TraceCall</span>("sqrt_gsl", __pyx_f[0], 48, 0, <span class='error_goto'>__PYX_ERR(0, 48, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("cython_response.sqrt_gsl", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = sqrt(__pyx_v_n);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">050</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">051</span>: <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">cmp_exp_gsl</span><span class="p">(</span><span class="n">double</span> <span class="n">x</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static __pyx_t_double_complex __pyx_f_15cython_response_cmp_exp_gsl(double __pyx_v_x) {
  __pyx_t_double_complex __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cmp_exp_gsl", 0);
  <span class='trace'>__Pyx_TraceCall</span>("cmp_exp_gsl", __pyx_f[0], 51, 0, <span class='error_goto'>__PYX_ERR(0, 51, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("cython_response.cmp_exp_gsl", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = __pyx_t_double_complex_from_parts(0, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">052</span>:     <span class="k">return</span>  <span class="n">gsl_sf_cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1</span><span class="n">j</span><span class="o">*</span><span class="n">gsl_sf_sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __Pyx_c_sum_double(__pyx_t_double_complex_from_parts(gsl_sf_cos(__pyx_v_x), 0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0, 1.0), __pyx_t_double_complex_from_parts(gsl_sf_sin(__pyx_v_x), 0)));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">053</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">054</span>: <span class="k">def</span> <span class="nf">isgwb_mich_strain_response</span><span class="p">(</span><span class="nb">object</span> <span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-22 '>/* Python wrapper */
static PyObject *__pyx_pw_15cython_response_1isgwb_mich_strain_response(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_15cython_response_isgwb_mich_strain_response[] = "\n        Calculate the detector transfer function functions to an isotropic SGWB non-polarized using basic michelson\n        channels. Note that since this is the response to an isotropic background, the response function is integrated\n        over sky direction and averaged over polarozation. The angular integral is a linear and rectangular in the\n        cos(theta) and phi space.  Note also that f0 is (pi*L*f)/c and is input as an array. The response function is given\n        for the strain of the signal rather than the power\n\n        \n\n        Parameters\n        -----------\n\n        f0   : float\n            A numpy array of scaled frequencies (see above for def)\n\n    \n\n        Returns\n        ---------\n\n        R1, R2 and R3   :   float\n            Antenna Patterns for the given sky direction for the three channels, integrated over sky direction and averaged over polarization.\n        ";
static PyMethodDef __pyx_mdef_15cython_response_1isgwb_mich_strain_response = {"isgwb_mich_strain_response", (PyCFunction)__pyx_pw_15cython_response_1isgwb_mich_strain_response, METH_O, __pyx_doc_15cython_response_isgwb_mich_strain_response};
static PyObject *__pyx_pw_15cython_response_1isgwb_mich_strain_response(PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("isgwb_mich_strain_response (wrapper)", 0);
  __pyx_r = __pyx_pf_15cython_response_isgwb_mich_strain_response(__pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_15cython_response_isgwb_mich_strain_response(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  __Pyx_memviewslice __pyx_v_f0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_pi_val;
  __Pyx_memviewslice __pyx_v_ct = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_phi = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED double __pyx_v_dct;
  CYTHON_UNUSED double __pyx_v_dphi;
  int __pyx_v_numfreqs;
  int __pyx_v_numtheta;
  int __pyx_v_numphi;
  int __pyx_v_ii;
  int __pyx_v_jj;
  int __pyx_v_kk;
  __Pyx_memviewslice __pyx_v_udir = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vdir = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wdir = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Fplus_u = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Fplus_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Fplus_w = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Fcross_u = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Fcross_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Fcross_w = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_norm = 0;
  __pyx_t_double_complex __pyx_v_exp_3f0;
  CYTHON_UNUSED __pyx_t_double_complex __pyx_v_exp_f0;
  __pyx_t_double_complex __pyx_v_exp_u;
  __pyx_t_double_complex __pyx_v_exp_v;
  __pyx_t_double_complex __pyx_v_exp_u_minus;
  __pyx_t_double_complex __pyx_v_exp_v_minus;
  __pyx_t_double_complex __pyx_v_exp_w_minus;
  __pyx_t_double_complex __pyx_v_exp_u_plus;
  __pyx_t_double_complex __pyx_v_exp_v_plus;
  __pyx_t_double_complex __pyx_v_exp_w_plus;
  __Pyx_memviewslice __pyx_v_R1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_R2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_R3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_double_complex __pyx_v_gammaU_plus;
  __pyx_t_double_complex __pyx_v_gammaV_plus;
  __pyx_t_double_complex __pyx_v_gammaW_plus;
  __pyx_t_double_complex __pyx_v_gammaU_minus;
  __pyx_t_double_complex __pyx_v_gammaV_minus;
  __pyx_t_double_complex __pyx_v_gammaW_minus;
  __pyx_t_double_complex __pyx_v_Fplus1;
  __pyx_t_double_complex __pyx_v_Fplus2;
  __pyx_t_double_complex __pyx_v_Fplus3;
  __pyx_t_double_complex __pyx_v_Fcross1;
  __pyx_t_double_complex __pyx_v_Fcross2;
  __pyx_t_double_complex __pyx_v_Fcross3;
  __pyx_t_double_complex __pyx_v_rand_plus;
  __pyx_t_double_complex __pyx_v_rand_cross;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj_)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("isgwb_mich_strain_response", 0);
  <span class='trace'>__Pyx_TraceCall</span>("isgwb_mich_strain_response", __pyx_f[0], 54, 0, <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cython_response.isgwb_mich_strain_response", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_f0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ct, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_phi, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_udir, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vdir, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wdir, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Fplus_u, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Fplus_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Fplus_w, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Fcross_u, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Fcross_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Fcross_w, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_norm);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_R1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_R2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_R3, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(50, __pyx_n_s_self, __pyx_n_s_f0, __pyx_n_s_pi_val, __pyx_n_s_ct, __pyx_n_s_phi, __pyx_n_s_dct, __pyx_n_s_dphi, __pyx_n_s_numfreqs, __pyx_n_s_numtheta, __pyx_n_s_numphi, __pyx_n_s_ii, __pyx_n_s_jj, __pyx_n_s_kk, __pyx_n_s_udir, __pyx_n_s_vdir, __pyx_n_s_wdir, __pyx_n_s_Fplus_u, __pyx_n_s_Fplus_v, __pyx_n_s_Fplus_w, __pyx_n_s_Fcross_u, __pyx_n_s_Fcross_v, __pyx_n_s_Fcross_w, __pyx_n_s_norm, __pyx_n_s_exp_3f0, __pyx_n_s_exp_f0, __pyx_n_s_exp_u, __pyx_n_s_exp_v, __pyx_n_s_exp_u_minus, __pyx_n_s_exp_v_minus, __pyx_n_s_exp_w_minus, __pyx_n_s_exp_u_plus, __pyx_n_s_exp_v_plus, __pyx_n_s_exp_w_plus, __pyx_n_s_R1, __pyx_n_s_R2, __pyx_n_s_R3, __pyx_n_s_gammaU_plus, __pyx_n_s_gammaV_plus, __pyx_n_s_gammaW_plus, __pyx_n_s_gammaU_minus, __pyx_n_s_gammaV_minus, __pyx_n_s_gammaW_minus, __pyx_n_s_Fplus1, __pyx_n_s_Fplus2, __pyx_n_s_Fplus3, __pyx_n_s_Fcross1, __pyx_n_s_Fcross2, __pyx_n_s_Fcross3, __pyx_n_s_rand_plus, __pyx_n_s_rand_cross);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_15cython_response_1isgwb_mich_strain_response, NULL, __pyx_n_s_cython_response);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_isgwb_mich_strain_response, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj_ = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 50, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cython_func_cython_response, __pyx_n_s_isgwb_mich_strain_response, 54, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj_)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">055</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>:         <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>: <span class="sd">        Calculate the detector transfer function functions to an isotropic SGWB non-polarized using basic michelson</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>: <span class="sd">        channels. Note that since this is the response to an isotropic background, the response function is integrated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>: <span class="sd">        over sky direction and averaged over polarozation. The angular integral is a linear and rectangular in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>: <span class="sd">        cos(theta) and phi space.  Note also that f0 is (pi*L*f)/c and is input as an array. The response function is given</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>: <span class="sd">        for the strain of the signal rather than the power</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: <span class="sd">        -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>: <span class="sd">        f0   : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>: <span class="sd">            A numpy array of scaled frequencies (see above for def)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>: <span class="sd">        ---------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>: <span class="sd">        R1, R2 and R3   :   float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>: <span class="sd">            Antenna Patterns for the given sky direction for the three channels, integrated over sky direction and averaged over polarization.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>: <span class="sd">        &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:         <span class="k">cdef</span> <span class="kt">double</span> [<span class="p">:]</span> <span class="n">f0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f0</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_f0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_f0 = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">pi_val</span> <span class="o">=</span> <span class="mf">3.141592653589793238462</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pi_val = 3.141592653589793238462;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">083</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">150</span><span class="p">)</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ct = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_neg_1, __pyx_int_1, __pyx_int_150);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">084</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">*</span><span class="n">pi_val</span><span class="p">,</span> <span class="mf">150</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython code score-35 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_pi_val));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_150);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_150);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_150);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_endpoint, Py_False) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 84, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_phi = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">085</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dct</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ct</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>  __pyx_t_6 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_ct.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_ct.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>
  }
  __pyx_t_8 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_ct.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_ct.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>
  }
  __pyx_v_dct = ((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_6 * __pyx_v_ct.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_8 * __pyx_v_ct.strides[0]) ))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dphi</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">phi</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>  __pyx_t_9 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_9 &lt; 0) {
    __pyx_t_9 += __pyx_v_phi.shape[0];
    if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_phi.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L1_error)</span>
  }
  __pyx_t_10 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_phi.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_phi.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L1_error)</span>
  }
  __pyx_v_dphi = ((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_9 * __pyx_v_phi.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_10 * __pyx_v_phi.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">088</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">numfreqs</span> <span class="o">=</span> <span class="n">f0</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-11 '>  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_f0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 89, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_numfreqs = __pyx_t_7;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">090</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">numtheta</span> <span class="o">=</span>  <span class="n">ct</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_ct, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_numtheta = __pyx_t_7;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">091</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">numphi</span> <span class="o">=</span>  <span class="n">phi</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-11 '>  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_phi, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_numphi = __pyx_t_7;
</pre><pre class="cython line score-0">&#xA0;<span class="">092</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">ii</span><span class="p">,</span> <span class="nf">jj</span><span class="p">,</span> <span class="nf">kk</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">udir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_3);
  __pyx_t_5 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_11) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_udir = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">vdir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_3, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_vdir = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">096</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">wdir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_11 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_wdir = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">097</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">098</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Fplus_u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_3);
  __pyx_t_5 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_11) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Fplus_u = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">099</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Fplus_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_3, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Fplus_v = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">100</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Fplus_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_11 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Fplus_w = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">101</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">102</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Fcross_u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_3);
  __pyx_t_5 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_11) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Fcross_u = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">103</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Fcross_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_3, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Fcross_v = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">104</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Fcross_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_11 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Fcross_w = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">105</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">106</span>:         <span class="k">cdef</span> <span class="nf">norm</span> <span class="o">=</span> <span class="n">sqrt_gsl</span><span class="p">(</span><span class="mf">0.5</span><span class="o">/</span><span class="n">udir</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_udir, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideCObj</span>(__pyx_float_0_5, __pyx_t_5, 0.5, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_15cython_response_sqrt_gsl(__pyx_t_13));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_norm = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">107</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>:         <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">exp_3f0</span><span class="p">,</span> <span class="nf">exp_f0</span><span class="p">,</span> <span class="nf">exp_u</span><span class="p">,</span> <span class="nf">exp_v</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>:         <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">exp_u_minus</span><span class="p">,</span> <span class="nf">exp_v_minus</span><span class="p">,</span> <span class="nf">exp_w_minus</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>:         <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">exp_u_plus</span><span class="p">,</span> <span class="nf">exp_v_plus</span><span class="p">,</span> <span class="nf">exp_w_plus</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>:         <span class="c"># Initlize arrays for the detector reponse</span></pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">113</span>:         <span class="k">cdef</span> <span class="kt">complex</span>[<span class="p">:,:]</span> <span class="n">R1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;complex&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_f0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_2);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_n_s_complex) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 113, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_R1 = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:         <span class="k">cdef</span> <span class="kt">complex</span>[<span class="p">:,:]</span> <span class="n">R2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;complex&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_f0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_n_s_complex) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_R2 = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:         <span class="k">cdef</span> <span class="kt">complex</span>[<span class="p">:,:]</span> <span class="n">R3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;complex&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_f0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_2);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_n_s_complex) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_R3 = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">116</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>:         <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">gammaU_plus</span><span class="p">,</span><span class="nf">gammaV_plus</span><span class="p">,</span><span class="nf">gammaW_plus</span><span class="p">,</span><span class="nf">gammaU_minus</span><span class="p">,</span><span class="nf">gammaV_minus</span><span class="p">,</span><span class="nf">gammaW_minus</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">118</span>:         <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">Fplus1</span><span class="p">,</span><span class="nf">Fplus2</span><span class="p">,</span><span class="nf">Fplus3</span><span class="p">,</span><span class="nf">Fcross1</span><span class="p">,</span><span class="nf">Fcross2</span><span class="p">,</span><span class="nf">Fcross3</span><span class="p">,</span> <span class="nf">rand_plus</span><span class="p">,</span> <span class="nf">rand_cross</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">119</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:         <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numphi</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_numphi;
  __pyx_t_15 = __pyx_t_7;
  for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
    __pyx_v_ii = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:             <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numtheta</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_numtheta;
    __pyx_t_18 = __pyx_t_17;
    for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
      __pyx_v_jj = __pyx_t_19;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:                 <span class="n">udir</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt_gsl</span><span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">+</span> <span class="n">pi_val</span><span class="o">/</span><span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>      __pyx_t_20 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>
      }
      __pyx_t_22 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_22 &lt; 0) {
        __pyx_t_22 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>
      }
      __pyx_t_23 = __pyx_v_ii;
      __pyx_t_24 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_v_udir.shape[0];
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_udir.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_udir.shape[1];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_udir.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_23 * __pyx_v_udir.strides[0]) ) + __pyx_t_24 * __pyx_v_udir.strides[1]) )) = (__pyx_f_15cython_response_sqrt_gsl((1.0 - pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_20 * __pyx_v_ct.strides[0]) ))), 2.0))) * __pyx_f_15cython_response_sine_gsl(((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_22 * __pyx_v_phi.strides[0]) ))) + (__pyx_v_pi_val / 6.0))));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:                 <span class="n">vdir</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt_gsl</span><span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">-</span> <span class="n">pi_val</span><span class="o">/</span><span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>      __pyx_t_25 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
      }
      __pyx_t_26 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
      }
      __pyx_t_27 = __pyx_v_ii;
      __pyx_t_28 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_vdir.shape[0];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_28 &lt; 0) {
        __pyx_t_28 += __pyx_v_vdir.shape[1];
        if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_27 * __pyx_v_vdir.strides[0]) ) + __pyx_t_28 * __pyx_v_vdir.strides[1]) )) = (__pyx_f_15cython_response_sqrt_gsl((1.0 - pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_25 * __pyx_v_ct.strides[0]) ))), 2.0))) * __pyx_f_15cython_response_sine_gsl(((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_26 * __pyx_v_phi.strides[0]) ))) - (__pyx_v_pi_val / 6.0))));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>:                 <span class="n">wdir</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">vdir</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span>  <span class="o">-</span> <span class="n">udir</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>      __pyx_t_29 = __pyx_v_ii;
      __pyx_t_30 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_29 &lt; 0) {
        __pyx_t_29 += __pyx_v_vdir.shape[0];
        if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_30 &lt; 0) {
        __pyx_t_30 += __pyx_v_vdir.shape[1];
        if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_30 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L1_error)</span>
      }
      __pyx_t_31 = __pyx_v_ii;
      __pyx_t_32 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_31 &lt; 0) {
        __pyx_t_31 += __pyx_v_udir.shape[0];
        if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_udir.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_32 &lt; 0) {
        __pyx_t_32 += __pyx_v_udir.shape[1];
        if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_udir.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L1_error)</span>
      }
      __pyx_t_33 = __pyx_v_ii;
      __pyx_t_34 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_33 &lt; 0) {
        __pyx_t_33 += __pyx_v_wdir.shape[0];
        if (unlikely(__pyx_t_33 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_33 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_34 &lt; 0) {
        __pyx_t_34 += __pyx_v_wdir.shape[1];
        if (unlikely(__pyx_t_34 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_34 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_33 * __pyx_v_wdir.strides[0]) ) + __pyx_t_34 * __pyx_v_wdir.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_29 * __pyx_v_vdir.strides[0]) ) + __pyx_t_30 * __pyx_v_vdir.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_31 * __pyx_v_udir.strides[0]) ) + __pyx_t_32 * __pyx_v_udir.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">125</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>:                 <span class="c">##  Fplus_u = (u x u):eplus</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:                 <span class="n">Fplus_u</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span><span class="o">=</span> <span class="p">(</span><span class="mf">1</span><span class="o">/</span><span class="mf">4</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1</span><span class="o">/</span><span class="mf">2</span><span class="o">*</span><span class="p">(</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span><span class="o">**</span><span class="mf">2</span> <span class="o">-</span> \</pre>
<pre class='cython code score-8 '>      __pyx_t_35 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_35 &lt; 0) {
        __pyx_t_35 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
      }
      __pyx_t_36 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_36 &lt; 0) {
        __pyx_t_36 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_36 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_36 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
      }
      __pyx_t_37 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_37 &lt; 0) {
        __pyx_t_37 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
      }
/* … */
      __pyx_t_42 = __pyx_v_ii;
      __pyx_t_43 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_42 &lt; 0) {
        __pyx_t_42 += __pyx_v_Fplus_u.shape[0];
        if (unlikely(__pyx_t_42 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_42 &gt;= __pyx_v_Fplus_u.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_43 &lt; 0) {
        __pyx_t_43 += __pyx_v_Fplus_u.shape[1];
        if (unlikely(__pyx_t_43 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_43 &gt;= __pyx_v_Fplus_u.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fplus_u.data + __pyx_t_42 * __pyx_v_Fplus_u.strides[0]) ) + __pyx_t_43 * __pyx_v_Fplus_u.strides[1]) )) = (((((1.0 / 4.0) * (1.0 - pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_35 * __pyx_v_ct.strides[0]) ))), 2.0))) + (((1.0 / 2.0) * pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_36 * __pyx_v_ct.strides[0]) ))), 2.0)) * pow(__pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_37 * __pyx_v_phi.strides[0]) )))), 2.0))) - ((__pyx_f_15cython_response_sqrt_gsl((3.0 / 16.0)) * __pyx_f_15cython_response_sine_gsl((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_38 * __pyx_v_phi.strides[0]) )))))) * (1.0 + pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_39 * __pyx_v_ct.strides[0]) ))), 2.0)))) + (0.5 * (pow(__pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_40 * __pyx_v_phi.strides[0]) )))), 2.0) - pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_41 * __pyx_v_ct.strides[0]) ))), 2.0))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:                         <span class="n">sqrt_gsl</span><span class="p">(</span><span class="mf">3</span><span class="o">/</span><span class="mf">16</span><span class="p">)</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span>  <span class="o">+</span> \</pre>
<pre class='cython code score-4 '>      __pyx_t_38 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_38 &lt; 0) {
        __pyx_t_38 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>
      }
      __pyx_t_39 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_39 &lt; 0) {
        __pyx_t_39 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_39 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_39 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:                             <span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span><span class="o">**</span><span class="mf">2</span> <span class="o">-</span> <span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-4 '>      __pyx_t_40 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_40 &lt; 0) {
        __pyx_t_40 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_40 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_40 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L1_error)</span>
      }
      __pyx_t_41 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_41 &lt; 0) {
        __pyx_t_41 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_41 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_41 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">130</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:                 <span class="n">Fplus_v</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span>   <span class="o">=</span> <span class="p">(</span><span class="mf">1</span><span class="o">/</span><span class="mf">4</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1</span><span class="o">/</span><span class="mf">2</span><span class="o">*</span><span class="p">(</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> \</pre>
<pre class='cython code score-8 '>      __pyx_t_44 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_44 &lt; 0) {
        __pyx_t_44 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_44 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_44 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 131, __pyx_L1_error)</span>
      }
      __pyx_t_45 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_45 &lt; 0) {
        __pyx_t_45 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_45 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_45 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 131, __pyx_L1_error)</span>
      }
      __pyx_t_46 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_46 &lt; 0) {
        __pyx_t_46 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_46 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_46 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 131, __pyx_L1_error)</span>
      }
/* … */
      __pyx_t_51 = __pyx_v_ii;
      __pyx_t_52 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_51 &lt; 0) {
        __pyx_t_51 += __pyx_v_Fplus_v.shape[0];
        if (unlikely(__pyx_t_51 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_51 &gt;= __pyx_v_Fplus_v.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_52 &lt; 0) {
        __pyx_t_52 += __pyx_v_Fplus_v.shape[1];
        if (unlikely(__pyx_t_52 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_52 &gt;= __pyx_v_Fplus_v.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 131, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fplus_v.data + __pyx_t_51 * __pyx_v_Fplus_v.strides[0]) ) + __pyx_t_52 * __pyx_v_Fplus_v.strides[1]) )) = (((((1.0 / 4.0) * (1.0 - pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_44 * __pyx_v_ct.strides[0]) ))), 2.0))) + (((1.0 / 2.0) * pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_45 * __pyx_v_ct.strides[0]) ))), 2.0)) * pow(__pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_46 * __pyx_v_phi.strides[0]) )))), 2.0))) + ((__pyx_f_15cython_response_sqrt_gsl((3.0 / 16.0)) * __pyx_f_15cython_response_sine_gsl((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_47 * __pyx_v_phi.strides[0]) )))))) * (1.0 + pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_48 * __pyx_v_ct.strides[0]) ))), 2.0)))) + (0.5 * (pow(__pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_49 * __pyx_v_phi.strides[0]) )))), 2.0) - pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_50 * __pyx_v_ct.strides[0]) ))), 2.0))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>:                         <span class="n">sqrt_gsl</span><span class="p">(</span><span class="mf">3</span><span class="o">/</span><span class="mf">16</span><span class="p">)</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span> <span class="o">+</span> \</pre>
<pre class='cython code score-4 '>      __pyx_t_47 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_47 &lt; 0) {
        __pyx_t_47 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_47 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_47 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 132, __pyx_L1_error)</span>
      }
      __pyx_t_48 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_48 &lt; 0) {
        __pyx_t_48 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_48 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_48 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 132, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:                             <span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span><span class="o">**</span><span class="mf">2</span> <span class="o">-</span> <span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-4 '>      __pyx_t_49 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_49 &lt; 0) {
        __pyx_t_49 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_49 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_49 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
      }
      __pyx_t_50 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_50 &lt; 0) {
        __pyx_t_50 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_50 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_50 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">134</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:                 <span class="n">Fplus_w</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span>    <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>      __pyx_t_53 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_53 &lt; 0) {
        __pyx_t_53 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_53 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_53 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
      }
      __pyx_t_54 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_54 &lt; 0) {
        __pyx_t_54 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_54 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_54 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
      }
      __pyx_t_55 = __pyx_v_ii;
      __pyx_t_56 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_55 &lt; 0) {
        __pyx_t_55 += __pyx_v_Fplus_w.shape[0];
        if (unlikely(__pyx_t_55 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_55 &gt;= __pyx_v_Fplus_w.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_56 &lt; 0) {
        __pyx_t_56 += __pyx_v_Fplus_w.shape[1];
        if (unlikely(__pyx_t_56 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_56 &gt;= __pyx_v_Fplus_w.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fplus_w.data + __pyx_t_55 * __pyx_v_Fplus_w.strides[0]) ) + __pyx_t_56 * __pyx_v_Fplus_w.strides[1]) )) = (1.0 - ((1.0 + pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_53 * __pyx_v_ct.strides[0]) ))), 2.0)) * pow(__pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_54 * __pyx_v_phi.strides[0]) )))), 2.0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">136</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">137</span>:                 <span class="c">##  Fcross_u = 1/2(u x u)Gamma(udir, f):ecross</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">138</span>:                 <span class="n">Fcross_u</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span>   <span class="o">=</span> <span class="o">-</span> <span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">sine_gsl</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">+</span> <span class="n">pi_val</span><span class="o">/</span><span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-6 '>      __pyx_t_57 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_57 &lt; 0) {
        __pyx_t_57 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_57 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_57 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 138, __pyx_L1_error)</span>
      }
      __pyx_t_58 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_58 &lt; 0) {
        __pyx_t_58 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_58 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_58 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 138, __pyx_L1_error)</span>
      }
      __pyx_t_59 = __pyx_v_ii;
      __pyx_t_60 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_59 &lt; 0) {
        __pyx_t_59 += __pyx_v_Fcross_u.shape[0];
        if (unlikely(__pyx_t_59 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_59 &gt;= __pyx_v_Fcross_u.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_60 &lt; 0) {
        __pyx_t_60 += __pyx_v_Fcross_u.shape[1];
        if (unlikely(__pyx_t_60 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_60 &gt;= __pyx_v_Fcross_u.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 138, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fcross_u.data + __pyx_t_59 * __pyx_v_Fcross_u.strides[0]) ) + __pyx_t_60 * __pyx_v_Fcross_u.strides[1]) )) = ((-(*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_57 * __pyx_v_ct.strides[0]) )))) * __pyx_f_15cython_response_sine_gsl(((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_58 * __pyx_v_phi.strides[0]) )))) + (__pyx_v_pi_val / 3.0))));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>:                 <span class="n">Fcross_v</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span>   <span class="o">=</span> <span class="o">-</span> <span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">sine_gsl</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">-</span> <span class="n">pi_val</span><span class="o">/</span><span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-6 '>      __pyx_t_61 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_61 &lt; 0) {
        __pyx_t_61 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_61 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_61 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L1_error)</span>
      }
      __pyx_t_62 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_62 &lt; 0) {
        __pyx_t_62 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_62 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_62 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L1_error)</span>
      }
      __pyx_t_63 = __pyx_v_ii;
      __pyx_t_64 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_63 &lt; 0) {
        __pyx_t_63 += __pyx_v_Fcross_v.shape[0];
        if (unlikely(__pyx_t_63 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_63 &gt;= __pyx_v_Fcross_v.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_64 &lt; 0) {
        __pyx_t_64 += __pyx_v_Fcross_v.shape[1];
        if (unlikely(__pyx_t_64 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_64 &gt;= __pyx_v_Fcross_v.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fcross_v.data + __pyx_t_63 * __pyx_v_Fcross_v.strides[0]) ) + __pyx_t_64 * __pyx_v_Fcross_v.strides[1]) )) = ((-(*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_61 * __pyx_v_ct.strides[0]) )))) * __pyx_f_15cython_response_sine_gsl(((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_62 * __pyx_v_phi.strides[0]) )))) - (__pyx_v_pi_val / 3.0))));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">140</span>:                 <span class="n">Fcross_w</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span>   <span class="o">=</span> <span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="o">*</span> <span class="n">sine_gsl</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span></pre>
<pre class='cython code score-6 '>      __pyx_t_65 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_65 &lt; 0) {
        __pyx_t_65 += __pyx_v_ct.shape[0];
        if (unlikely(__pyx_t_65 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_65 &gt;= __pyx_v_ct.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
      }
      __pyx_t_66 = __pyx_v_ii;
      __pyx_t_21 = -1;
      if (__pyx_t_66 &lt; 0) {
        __pyx_t_66 += __pyx_v_phi.shape[0];
        if (unlikely(__pyx_t_66 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_66 &gt;= __pyx_v_phi.shape[0])) __pyx_t_21 = 0;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
      }
      __pyx_t_67 = __pyx_v_ii;
      __pyx_t_68 = __pyx_v_jj;
      __pyx_t_21 = -1;
      if (__pyx_t_67 &lt; 0) {
        __pyx_t_67 += __pyx_v_Fcross_w.shape[0];
        if (unlikely(__pyx_t_67 &lt; 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_67 &gt;= __pyx_v_Fcross_w.shape[0])) __pyx_t_21 = 0;
      if (__pyx_t_68 &lt; 0) {
        __pyx_t_68 += __pyx_v_Fcross_w.shape[1];
        if (unlikely(__pyx_t_68 &lt; 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_68 &gt;= __pyx_v_Fcross_w.shape[1])) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
        <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fcross_w.data + __pyx_t_67 * __pyx_v_Fcross_w.strides[0]) ) + __pyx_t_68 * __pyx_v_Fcross_w.strides[1]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_65 * __pyx_v_ct.strides[0]) ))) * __pyx_f_15cython_response_sine_gsl((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_66 * __pyx_v_phi.strides[0]) ))))));
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">141</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>:         <span class="c"># Calculate the detector response for each frequency</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:         <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numfreqs</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_numfreqs;
  __pyx_t_15 = __pyx_t_7;
  for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
    __pyx_v_ii = __pyx_t_16;
</pre><pre class="cython line score-0">&#xA0;<span class="">144</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:             <span class="n">exp_3f0</span> <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="o">-</span><span class="mf">3</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span></pre>
<pre class='cython code score-2 '>    __pyx_t_69 = __pyx_v_ii;
    __pyx_t_17 = -1;
    if (__pyx_t_69 &lt; 0) {
      __pyx_t_69 += __pyx_v_f0.shape[0];
      if (unlikely(__pyx_t_69 &lt; 0)) __pyx_t_17 = 0;
    } else if (unlikely(__pyx_t_69 &gt;= __pyx_v_f0.shape[0])) __pyx_t_17 = 0;
    if (unlikely(__pyx_t_17 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
      <span class='error_goto'>__PYX_ERR(0, 145, __pyx_L1_error)</span>
    }
    __pyx_v_exp_3f0 = __pyx_f_15cython_response_cmp_exp_gsl((-3.0 * (*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_69 * __pyx_v_f0.strides[0]) )))));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:             <span class="n">exp_f0</span> <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="o">-</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span></pre>
<pre class='cython code score-2 '>    __pyx_t_70 = __pyx_v_ii;
    __pyx_t_17 = -1;
    if (__pyx_t_70 &lt; 0) {
      __pyx_t_70 += __pyx_v_f0.shape[0];
      if (unlikely(__pyx_t_70 &lt; 0)) __pyx_t_17 = 0;
    } else if (unlikely(__pyx_t_70 &gt;= __pyx_v_f0.shape[0])) __pyx_t_17 = 0;
    if (unlikely(__pyx_t_17 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
      <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
    }
    __pyx_v_exp_f0 = __pyx_f_15cython_response_cmp_exp_gsl((-(*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_70 * __pyx_v_f0.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">147</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">148</span>:             <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numphi</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_numphi;
    __pyx_t_18 = __pyx_t_17;
    for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
      __pyx_v_jj = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:                 <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numtheta</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_v_numtheta;
      __pyx_t_71 = __pyx_t_21;
      for (__pyx_t_72 = 0; __pyx_t_72 &lt; __pyx_t_71; __pyx_t_72+=1) {
        __pyx_v_kk = __pyx_t_72;
</pre><pre class="cython line score-0">&#xA0;<span class="">150</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:                     <span class="n">exp_u_minus</span> <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="o">-</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>        __pyx_t_73 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_73 &lt; 0) {
          __pyx_t_73 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_73 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_73 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
        }
        __pyx_t_75 = __pyx_v_jj;
        __pyx_t_76 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_75 &lt; 0) {
          __pyx_t_75 += __pyx_v_udir.shape[0];
          if (unlikely(__pyx_t_75 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_75 &gt;= __pyx_v_udir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_76 &lt; 0) {
          __pyx_t_76 += __pyx_v_udir.shape[1];
          if (unlikely(__pyx_t_76 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_76 &gt;= __pyx_v_udir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
        }
        __pyx_v_exp_u_minus = __pyx_f_15cython_response_cmp_exp_gsl(((-(*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_73 * __pyx_v_f0.strides[0]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_75 * __pyx_v_udir.strides[0]) ) + __pyx_t_76 * __pyx_v_udir.strides[1]) )))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>:                     <span class="n">exp_v_minus</span> <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="o">-</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>        __pyx_t_77 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_77 &lt; 0) {
          __pyx_t_77 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_77 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_77 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>
        }
        __pyx_t_78 = __pyx_v_jj;
        __pyx_t_79 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_78 &lt; 0) {
          __pyx_t_78 += __pyx_v_vdir.shape[0];
          if (unlikely(__pyx_t_78 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_78 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_79 &lt; 0) {
          __pyx_t_79 += __pyx_v_vdir.shape[1];
          if (unlikely(__pyx_t_79 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_79 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>
        }
        __pyx_v_exp_v_minus = __pyx_f_15cython_response_cmp_exp_gsl(((-(*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_77 * __pyx_v_f0.strides[0]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_78 * __pyx_v_vdir.strides[0]) ) + __pyx_t_79 * __pyx_v_vdir.strides[1]) )))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:                     <span class="n">exp_w_minus</span> <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="o">-</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">wdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>        __pyx_t_80 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_80 &lt; 0) {
          __pyx_t_80 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_80 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_80 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 153, __pyx_L1_error)</span>
        }
        __pyx_t_81 = __pyx_v_jj;
        __pyx_t_82 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_81 &lt; 0) {
          __pyx_t_81 += __pyx_v_wdir.shape[0];
          if (unlikely(__pyx_t_81 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_81 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_82 &lt; 0) {
          __pyx_t_82 += __pyx_v_wdir.shape[1];
          if (unlikely(__pyx_t_82 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_82 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 153, __pyx_L1_error)</span>
        }
        __pyx_v_exp_w_minus = __pyx_f_15cython_response_cmp_exp_gsl(((-(*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_80 * __pyx_v_f0.strides[0]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_81 * __pyx_v_wdir.strides[0]) ) + __pyx_t_82 * __pyx_v_wdir.strides[1]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">154</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:                     <span class="n">exp_u_plus</span><span class="p">,</span> <span class="n">exp_v_plus</span><span class="p">,</span> <span class="n">exp_w_plus</span>   <span class="o">=</span> <span class="n">exp_u_minus</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),</span> <span class="n">exp_v_minus</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),</span> <span class="n">exp_w_minus</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>        __pyx_t_83 = __Pyx_c_conj_double(__pyx_v_exp_u_minus);
        __pyx_t_84 = __Pyx_c_conj_double(__pyx_v_exp_v_minus);
        __pyx_t_85 = __Pyx_c_conj_double(__pyx_v_exp_w_minus);
        __pyx_v_exp_u_plus = __pyx_t_83;
        __pyx_v_exp_v_plus = __pyx_t_84;
        __pyx_v_exp_w_plus = __pyx_t_85;
</pre><pre class="cython line score-0">&#xA0;<span class="">156</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">157</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">158</span>:                     <span class="c"># Calculate GW transfer function for the michelson channels</span></pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">159</span>:                     <span class="n">gammaU_plus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>        __pyx_t_86 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_86 &lt; 0) {
          __pyx_t_86 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_86 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_86 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 159, __pyx_L1_error)</span>
        }
        __pyx_t_87 = __pyx_v_jj;
        __pyx_t_88 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_87 &lt; 0) {
          __pyx_t_87 += __pyx_v_udir.shape[0];
          if (unlikely(__pyx_t_87 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_87 &gt;= __pyx_v_udir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_88 &lt; 0) {
          __pyx_t_88 += __pyx_v_udir.shape[1];
          if (unlikely(__pyx_t_88 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_88 &gt;= __pyx_v_udir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 159, __pyx_L1_error)</span>
        }
        __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_86 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_87 * __pyx_v_udir.strides[0]) ) + __pyx_t_88 * __pyx_v_udir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 159, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">160</span>:                                  <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_u_minus</span></pre>
<pre class='cython code score-9 '>        __pyx_t_89 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_89 &lt; 0) {
          __pyx_t_89 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_89 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_89 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 160, __pyx_L1_error)</span>
        }
        __pyx_t_90 = __pyx_v_jj;
        __pyx_t_91 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_90 &lt; 0) {
          __pyx_t_90 += __pyx_v_udir.shape[0];
          if (unlikely(__pyx_t_90 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_90 &gt;= __pyx_v_udir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_91 &lt; 0) {
          __pyx_t_91 += __pyx_v_udir.shape[1];
          if (unlikely(__pyx_t_91 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_91 &gt;= __pyx_v_udir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 160, __pyx_L1_error)</span>
        }
        __pyx_t_92 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_89 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_90 * __pyx_v_udir.strides[0]) ) + __pyx_t_91 * __pyx_v_udir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 160, __pyx_L1_error)</span>
        }
/* … */
        __pyx_v_gammaU_plus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_92 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_u_minus);
</pre><pre class="cython line score-0">&#xA0;<span class="">161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">162</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:                     <span class="n">gammaV_plus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>        __pyx_t_93 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_93 &lt; 0) {
          __pyx_t_93 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_93 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_93 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
        }
        __pyx_t_94 = __pyx_v_jj;
        __pyx_t_95 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_94 &lt; 0) {
          __pyx_t_94 += __pyx_v_vdir.shape[0];
          if (unlikely(__pyx_t_94 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_94 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_95 &lt; 0) {
          __pyx_t_95 += __pyx_v_vdir.shape[1];
          if (unlikely(__pyx_t_95 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_95 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
        }
        __pyx_t_92 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_93 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_94 * __pyx_v_vdir.strides[0]) ) + __pyx_t_95 * __pyx_v_vdir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:                                  <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_v_minus</span></pre>
<pre class='cython code score-9 '>        __pyx_t_96 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_96 &lt; 0) {
          __pyx_t_96 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_96 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_96 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
        }
        __pyx_t_97 = __pyx_v_jj;
        __pyx_t_98 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_97 &lt; 0) {
          __pyx_t_97 += __pyx_v_vdir.shape[0];
          if (unlikely(__pyx_t_97 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_97 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_98 &lt; 0) {
          __pyx_t_98 += __pyx_v_vdir.shape[1];
          if (unlikely(__pyx_t_98 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_98 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
        }
        __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_96 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_97 * __pyx_v_vdir.strides[0]) ) + __pyx_t_98 * __pyx_v_vdir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
        }
/* … */
        __pyx_v_gammaV_plus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_92 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_v_minus);
</pre><pre class="cython line score-0">&#xA0;<span class="">165</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:                     <span class="n">gammaW_plus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">wdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>        __pyx_t_99 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_99 &lt; 0) {
          __pyx_t_99 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_99 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_99 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 166, __pyx_L1_error)</span>
        }
        __pyx_t_100 = __pyx_v_jj;
        __pyx_t_101 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_100 &lt; 0) {
          __pyx_t_100 += __pyx_v_wdir.shape[0];
          if (unlikely(__pyx_t_100 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_100 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_101 &lt; 0) {
          __pyx_t_101 += __pyx_v_wdir.shape[1];
          if (unlikely(__pyx_t_101 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_101 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 166, __pyx_L1_error)</span>
        }
        __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_99 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_100 * __pyx_v_wdir.strides[0]) ) + __pyx_t_101 * __pyx_v_wdir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 166, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">167</span>:                                  <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">wdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_w_minus</span></pre>
<pre class='cython code score-9 '>        __pyx_t_102 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_102 &lt; 0) {
          __pyx_t_102 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_102 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_102 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 167, __pyx_L1_error)</span>
        }
        __pyx_t_103 = __pyx_v_jj;
        __pyx_t_104 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_103 &lt; 0) {
          __pyx_t_103 += __pyx_v_wdir.shape[0];
          if (unlikely(__pyx_t_103 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_103 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_104 &lt; 0) {
          __pyx_t_104 += __pyx_v_wdir.shape[1];
          if (unlikely(__pyx_t_104 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_104 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 167, __pyx_L1_error)</span>
        }
        __pyx_t_92 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_102 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_103 * __pyx_v_wdir.strides[0]) ) + __pyx_t_104 * __pyx_v_wdir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 167, __pyx_L1_error)</span>
        }
/* … */
        __pyx_v_gammaW_plus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_92 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_w_minus);
</pre><pre class="cython line score-0">&#xA0;<span class="">168</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>:                     <span class="c"># Calculate GW transfer function for the michelson channels</span></pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:                     <span class="n">gammaU_minus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>        __pyx_t_105 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_105 &lt; 0) {
          __pyx_t_105 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_105 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_105 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 170, __pyx_L1_error)</span>
        }
        __pyx_t_106 = __pyx_v_jj;
        __pyx_t_107 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_106 &lt; 0) {
          __pyx_t_106 += __pyx_v_udir.shape[0];
          if (unlikely(__pyx_t_106 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_106 &gt;= __pyx_v_udir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_107 &lt; 0) {
          __pyx_t_107 += __pyx_v_udir.shape[1];
          if (unlikely(__pyx_t_107 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_107 &gt;= __pyx_v_udir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 170, __pyx_L1_error)</span>
        }
        __pyx_t_92 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_105 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_106 * __pyx_v_udir.strides[0]) ) + __pyx_t_107 * __pyx_v_udir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 170, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">171</span>:                                  <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_u_plus</span></pre>
<pre class='cython code score-9 '>        __pyx_t_108 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_108 &lt; 0) {
          __pyx_t_108 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_108 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_108 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 171, __pyx_L1_error)</span>
        }
        __pyx_t_109 = __pyx_v_jj;
        __pyx_t_110 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_109 &lt; 0) {
          __pyx_t_109 += __pyx_v_udir.shape[0];
          if (unlikely(__pyx_t_109 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_109 &gt;= __pyx_v_udir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_110 &lt; 0) {
          __pyx_t_110 += __pyx_v_udir.shape[1];
          if (unlikely(__pyx_t_110 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_110 &gt;= __pyx_v_udir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 171, __pyx_L1_error)</span>
        }
        __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_108 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_109 * __pyx_v_udir.strides[0]) ) + __pyx_t_110 * __pyx_v_udir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 171, __pyx_L1_error)</span>
        }
/* … */
        __pyx_v_gammaU_minus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_92 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_u_plus);
</pre><pre class="cython line score-0">&#xA0;<span class="">172</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:                     <span class="n">gammaV_minus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>        __pyx_t_111 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_111 &lt; 0) {
          __pyx_t_111 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_111 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_111 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L1_error)</span>
        }
        __pyx_t_112 = __pyx_v_jj;
        __pyx_t_113 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_112 &lt; 0) {
          __pyx_t_112 += __pyx_v_vdir.shape[0];
          if (unlikely(__pyx_t_112 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_112 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_113 &lt; 0) {
          __pyx_t_113 += __pyx_v_vdir.shape[1];
          if (unlikely(__pyx_t_113 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_113 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L1_error)</span>
        }
        __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_111 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_112 * __pyx_v_vdir.strides[0]) ) + __pyx_t_113 * __pyx_v_vdir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>:                                  <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_v_plus</span></pre>
<pre class='cython code score-9 '>        __pyx_t_114 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_114 &lt; 0) {
          __pyx_t_114 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_114 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_114 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>
        }
        __pyx_t_115 = __pyx_v_jj;
        __pyx_t_116 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_115 &lt; 0) {
          __pyx_t_115 += __pyx_v_vdir.shape[0];
          if (unlikely(__pyx_t_115 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_115 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_116 &lt; 0) {
          __pyx_t_116 += __pyx_v_vdir.shape[1];
          if (unlikely(__pyx_t_116 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_116 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>
        }
        __pyx_t_92 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_114 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_115 * __pyx_v_vdir.strides[0]) ) + __pyx_t_116 * __pyx_v_vdir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>
        }
/* … */
        __pyx_v_gammaV_minus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_92 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_v_plus);
</pre><pre class="cython line score-0">&#xA0;<span class="">175</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">176</span>:                     <span class="n">gammaW_minus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">wdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>        __pyx_t_117 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_117 &lt; 0) {
          __pyx_t_117 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_117 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_117 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 176, __pyx_L1_error)</span>
        }
        __pyx_t_118 = __pyx_v_jj;
        __pyx_t_119 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_118 &lt; 0) {
          __pyx_t_118 += __pyx_v_wdir.shape[0];
          if (unlikely(__pyx_t_118 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_118 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_119 &lt; 0) {
          __pyx_t_119 += __pyx_v_wdir.shape[1];
          if (unlikely(__pyx_t_119 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_119 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 176, __pyx_L1_error)</span>
        }
        __pyx_t_92 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_117 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_118 * __pyx_v_wdir.strides[0]) ) + __pyx_t_119 * __pyx_v_wdir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 176, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:                                  <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">wdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_w_plus</span></pre>
<pre class='cython code score-9 '>        __pyx_t_120 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_120 &lt; 0) {
          __pyx_t_120 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_120 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_120 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L1_error)</span>
        }
        __pyx_t_121 = __pyx_v_jj;
        __pyx_t_122 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_121 &lt; 0) {
          __pyx_t_121 += __pyx_v_wdir.shape[0];
          if (unlikely(__pyx_t_121 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_121 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_122 &lt; 0) {
          __pyx_t_122 += __pyx_v_wdir.shape[1];
          if (unlikely(__pyx_t_122 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_122 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L1_error)</span>
        }
        __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_120 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_121 * __pyx_v_wdir.strides[0]) ) + __pyx_t_122 * __pyx_v_wdir.strides[1]) )))));
        if (unlikely(__pyx_v_pi_val == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L1_error)</span>
        }
/* … */
        __pyx_v_gammaW_minus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_92 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_w_plus);
</pre><pre class="cython line score-0">&#xA0;<span class="">178</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">179</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">180</span>:                     <span class="n">exp_u</span>  <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>        __pyx_t_123 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_123 &lt; 0) {
          __pyx_t_123 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_123 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_123 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 180, __pyx_L1_error)</span>
        }
        __pyx_t_124 = __pyx_v_jj;
        __pyx_t_125 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_124 &lt; 0) {
          __pyx_t_124 += __pyx_v_udir.shape[0];
          if (unlikely(__pyx_t_124 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_124 &gt;= __pyx_v_udir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_125 &lt; 0) {
          __pyx_t_125 += __pyx_v_udir.shape[1];
          if (unlikely(__pyx_t_125 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_125 &gt;= __pyx_v_udir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 180, __pyx_L1_error)</span>
        }
        __pyx_v_exp_u = __pyx_f_15cython_response_cmp_exp_gsl(((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_123 * __pyx_v_f0.strides[0]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_124 * __pyx_v_udir.strides[0]) ) + __pyx_t_125 * __pyx_v_udir.strides[1]) )))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>:                     <span class="n">exp_v</span>  <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>        __pyx_t_126 = __pyx_v_ii;
        __pyx_t_74 = -1;
        if (__pyx_t_126 &lt; 0) {
          __pyx_t_126 += __pyx_v_f0.shape[0];
          if (unlikely(__pyx_t_126 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_126 &gt;= __pyx_v_f0.shape[0])) __pyx_t_74 = 0;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 181, __pyx_L1_error)</span>
        }
        __pyx_t_127 = __pyx_v_jj;
        __pyx_t_128 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_127 &lt; 0) {
          __pyx_t_127 += __pyx_v_vdir.shape[0];
          if (unlikely(__pyx_t_127 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_127 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_128 &lt; 0) {
          __pyx_t_128 += __pyx_v_vdir.shape[1];
          if (unlikely(__pyx_t_128 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_128 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 181, __pyx_L1_error)</span>
        }
        __pyx_v_exp_v = __pyx_f_15cython_response_cmp_exp_gsl(((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_126 * __pyx_v_f0.strides[0]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_127 * __pyx_v_vdir.strides[0]) ) + __pyx_t_128 * __pyx_v_vdir.strides[1]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">182</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>:                     <span class="c">## Michelson antenna patterns: Calculate Fplus</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">184</span>:                     <span class="n">Fplus1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Fplus_u</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaU_plus</span> <span class="o">-</span> <span class="n">Fplus_v</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaV_plus</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>        __pyx_t_129 = __pyx_v_jj;
        __pyx_t_130 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_129 &lt; 0) {
          __pyx_t_129 += __pyx_v_Fplus_u.shape[0];
          if (unlikely(__pyx_t_129 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_129 &gt;= __pyx_v_Fplus_u.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_130 &lt; 0) {
          __pyx_t_130 += __pyx_v_Fplus_u.shape[1];
          if (unlikely(__pyx_t_130 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_130 &gt;= __pyx_v_Fplus_u.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 184, __pyx_L1_error)</span>
        }
        __pyx_t_131 = __pyx_v_jj;
        __pyx_t_132 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_131 &lt; 0) {
          __pyx_t_131 += __pyx_v_Fplus_v.shape[0];
          if (unlikely(__pyx_t_131 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_131 &gt;= __pyx_v_Fplus_v.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_132 &lt; 0) {
          __pyx_t_132 += __pyx_v_Fplus_v.shape[1];
          if (unlikely(__pyx_t_132 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_132 &gt;= __pyx_v_Fplus_v.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 184, __pyx_L1_error)</span>
        }
        __pyx_v_Fplus1 = __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0.5, 0), __Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fplus_u.data + __pyx_t_129 * __pyx_v_Fplus_u.strides[0]) ) + __pyx_t_130 * __pyx_v_Fplus_u.strides[1]) ))), 0), __pyx_v_gammaU_plus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fplus_v.data + __pyx_t_131 * __pyx_v_Fplus_v.strides[0]) ) + __pyx_t_132 * __pyx_v_Fplus_v.strides[1]) ))), 0), __pyx_v_gammaV_plus)));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">185</span>:                     <span class="n">Fplus2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Fplus_w</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaW_plus</span> <span class="o">-</span> <span class="n">Fplus_u</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaU_minus</span><span class="p">)</span><span class="o">*</span><span class="n">exp_u</span></pre>
<pre class='cython code score-4 '>        __pyx_t_133 = __pyx_v_jj;
        __pyx_t_134 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_133 &lt; 0) {
          __pyx_t_133 += __pyx_v_Fplus_w.shape[0];
          if (unlikely(__pyx_t_133 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_133 &gt;= __pyx_v_Fplus_w.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_134 &lt; 0) {
          __pyx_t_134 += __pyx_v_Fplus_w.shape[1];
          if (unlikely(__pyx_t_134 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_134 &gt;= __pyx_v_Fplus_w.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 185, __pyx_L1_error)</span>
        }
        __pyx_t_135 = __pyx_v_jj;
        __pyx_t_136 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_135 &lt; 0) {
          __pyx_t_135 += __pyx_v_Fplus_u.shape[0];
          if (unlikely(__pyx_t_135 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_135 &gt;= __pyx_v_Fplus_u.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_136 &lt; 0) {
          __pyx_t_136 += __pyx_v_Fplus_u.shape[1];
          if (unlikely(__pyx_t_136 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_136 &gt;= __pyx_v_Fplus_u.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 185, __pyx_L1_error)</span>
        }
        __pyx_v_Fplus2 = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0.5, 0), __Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fplus_w.data + __pyx_t_133 * __pyx_v_Fplus_w.strides[0]) ) + __pyx_t_134 * __pyx_v_Fplus_w.strides[1]) ))), 0), __pyx_v_gammaW_plus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fplus_u.data + __pyx_t_135 * __pyx_v_Fplus_u.strides[0]) ) + __pyx_t_136 * __pyx_v_Fplus_u.strides[1]) ))), 0), __pyx_v_gammaU_minus))), __pyx_v_exp_u);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">186</span>:                     <span class="n">Fplus3</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Fplus_v</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaV_minus</span> <span class="o">-</span> <span class="n">Fplus_w</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaW_minus</span><span class="p">)</span><span class="o">*</span><span class="n">exp_v</span></pre>
<pre class='cython code score-4 '>        __pyx_t_137 = __pyx_v_jj;
        __pyx_t_138 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_137 &lt; 0) {
          __pyx_t_137 += __pyx_v_Fplus_v.shape[0];
          if (unlikely(__pyx_t_137 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_137 &gt;= __pyx_v_Fplus_v.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_138 &lt; 0) {
          __pyx_t_138 += __pyx_v_Fplus_v.shape[1];
          if (unlikely(__pyx_t_138 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_138 &gt;= __pyx_v_Fplus_v.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>
        }
        __pyx_t_139 = __pyx_v_jj;
        __pyx_t_140 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_139 &lt; 0) {
          __pyx_t_139 += __pyx_v_Fplus_w.shape[0];
          if (unlikely(__pyx_t_139 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_139 &gt;= __pyx_v_Fplus_w.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_140 &lt; 0) {
          __pyx_t_140 += __pyx_v_Fplus_w.shape[1];
          if (unlikely(__pyx_t_140 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_140 &gt;= __pyx_v_Fplus_w.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>
        }
        __pyx_v_Fplus3 = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0.5, 0), __Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fplus_v.data + __pyx_t_137 * __pyx_v_Fplus_v.strides[0]) ) + __pyx_t_138 * __pyx_v_Fplus_v.strides[1]) ))), 0), __pyx_v_gammaV_minus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fplus_w.data + __pyx_t_139 * __pyx_v_Fplus_w.strides[0]) ) + __pyx_t_140 * __pyx_v_Fplus_w.strides[1]) ))), 0), __pyx_v_gammaW_minus))), __pyx_v_exp_v);
</pre><pre class="cython line score-0">&#xA0;<span class="">187</span>:                     <span class="c">## Michelson antenna patterns: Calculate Fcross</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">188</span>:                     <span class="n">Fcross1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Fcross_u</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaU_plus</span> <span class="o">-</span> <span class="n">Fcross_v</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaV_plus</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>        __pyx_t_141 = __pyx_v_jj;
        __pyx_t_142 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_141 &lt; 0) {
          __pyx_t_141 += __pyx_v_Fcross_u.shape[0];
          if (unlikely(__pyx_t_141 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_141 &gt;= __pyx_v_Fcross_u.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_142 &lt; 0) {
          __pyx_t_142 += __pyx_v_Fcross_u.shape[1];
          if (unlikely(__pyx_t_142 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_142 &gt;= __pyx_v_Fcross_u.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L1_error)</span>
        }
        __pyx_t_143 = __pyx_v_jj;
        __pyx_t_144 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_143 &lt; 0) {
          __pyx_t_143 += __pyx_v_Fcross_v.shape[0];
          if (unlikely(__pyx_t_143 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_143 &gt;= __pyx_v_Fcross_v.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_144 &lt; 0) {
          __pyx_t_144 += __pyx_v_Fcross_v.shape[1];
          if (unlikely(__pyx_t_144 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_144 &gt;= __pyx_v_Fcross_v.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L1_error)</span>
        }
        __pyx_v_Fcross1 = __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0.5, 0), __Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fcross_u.data + __pyx_t_141 * __pyx_v_Fcross_u.strides[0]) ) + __pyx_t_142 * __pyx_v_Fcross_u.strides[1]) ))), 0), __pyx_v_gammaU_plus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fcross_v.data + __pyx_t_143 * __pyx_v_Fcross_v.strides[0]) ) + __pyx_t_144 * __pyx_v_Fcross_v.strides[1]) ))), 0), __pyx_v_gammaV_plus)));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:                     <span class="n">Fcross2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Fcross_w</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaW_plus</span> <span class="o">-</span> <span class="n">Fcross_u</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaU_minus</span><span class="p">)</span><span class="o">*</span><span class="n">exp_u</span></pre>
<pre class='cython code score-4 '>        __pyx_t_145 = __pyx_v_jj;
        __pyx_t_146 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_145 &lt; 0) {
          __pyx_t_145 += __pyx_v_Fcross_w.shape[0];
          if (unlikely(__pyx_t_145 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_145 &gt;= __pyx_v_Fcross_w.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_146 &lt; 0) {
          __pyx_t_146 += __pyx_v_Fcross_w.shape[1];
          if (unlikely(__pyx_t_146 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_146 &gt;= __pyx_v_Fcross_w.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>
        }
        __pyx_t_147 = __pyx_v_jj;
        __pyx_t_148 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_147 &lt; 0) {
          __pyx_t_147 += __pyx_v_Fcross_u.shape[0];
          if (unlikely(__pyx_t_147 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_147 &gt;= __pyx_v_Fcross_u.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_148 &lt; 0) {
          __pyx_t_148 += __pyx_v_Fcross_u.shape[1];
          if (unlikely(__pyx_t_148 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_148 &gt;= __pyx_v_Fcross_u.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>
        }
        __pyx_v_Fcross2 = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0.5, 0), __Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fcross_w.data + __pyx_t_145 * __pyx_v_Fcross_w.strides[0]) ) + __pyx_t_146 * __pyx_v_Fcross_w.strides[1]) ))), 0), __pyx_v_gammaW_plus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fcross_u.data + __pyx_t_147 * __pyx_v_Fcross_u.strides[0]) ) + __pyx_t_148 * __pyx_v_Fcross_u.strides[1]) ))), 0), __pyx_v_gammaU_minus))), __pyx_v_exp_u);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>:                     <span class="n">Fcross3</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Fcross_v</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaV_minus</span> <span class="o">-</span> <span class="n">Fcross_w</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaW_minus</span><span class="p">)</span><span class="o">*</span><span class="n">exp_v</span></pre>
<pre class='cython code score-4 '>        __pyx_t_149 = __pyx_v_jj;
        __pyx_t_150 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_149 &lt; 0) {
          __pyx_t_149 += __pyx_v_Fcross_v.shape[0];
          if (unlikely(__pyx_t_149 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_149 &gt;= __pyx_v_Fcross_v.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_150 &lt; 0) {
          __pyx_t_150 += __pyx_v_Fcross_v.shape[1];
          if (unlikely(__pyx_t_150 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_150 &gt;= __pyx_v_Fcross_v.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span>
        }
        __pyx_t_151 = __pyx_v_jj;
        __pyx_t_152 = __pyx_v_kk;
        __pyx_t_74 = -1;
        if (__pyx_t_151 &lt; 0) {
          __pyx_t_151 += __pyx_v_Fcross_w.shape[0];
          if (unlikely(__pyx_t_151 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_151 &gt;= __pyx_v_Fcross_w.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_152 &lt; 0) {
          __pyx_t_152 += __pyx_v_Fcross_w.shape[1];
          if (unlikely(__pyx_t_152 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_152 &gt;= __pyx_v_Fcross_w.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span>
        }
        __pyx_v_Fcross3 = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0.5, 0), __Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fcross_v.data + __pyx_t_149 * __pyx_v_Fcross_v.strides[0]) ) + __pyx_t_150 * __pyx_v_Fcross_v.strides[1]) ))), 0), __pyx_v_gammaV_minus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Fcross_w.data + __pyx_t_151 * __pyx_v_Fcross_w.strides[0]) ) + __pyx_t_152 * __pyx_v_Fcross_w.strides[1]) ))), 0), __pyx_v_gammaW_minus))), __pyx_v_exp_v);
</pre><pre class="cython line score-0">&#xA0;<span class="">191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>:                     <span class="c">## Directional random number</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">193</span>:                     <span class="n">rand_plus</span> <span class="o">=</span> <span class="n">unit_nrm_gsl</span><span class="p">()</span> <span class="o">+</span> <span class="mf">1</span><span class="n">j</span><span class="o">*</span><span class="n">unit_nrm_gsl</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>        __pyx_v_rand_plus = __Pyx_c_sum_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_unit_nrm_gsl(), 0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0, 1.0), __pyx_t_double_complex_from_parts(__pyx_f_15cython_response_unit_nrm_gsl(), 0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">194</span>:                     <span class="n">rand_cross</span> <span class="o">=</span> <span class="n">unit_nrm_gsl</span><span class="p">()</span> <span class="o">+</span> <span class="mf">1</span><span class="n">j</span><span class="o">*</span> <span class="n">unit_nrm_gsl</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>        __pyx_v_rand_cross = __Pyx_c_sum_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_unit_nrm_gsl(), 0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0, 1.0), __pyx_t_double_complex_from_parts(__pyx_f_15cython_response_unit_nrm_gsl(), 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">195</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">196</span>:                     <span class="c">## Detector response summed over polarization and integrated over sky direction</span></pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">197</span>:                     <span class="n">R1</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">R1</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R1</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fplus1</span><span class="o">*</span><span class="n">rand_plus</span><span class="p">,</span> <span class="n">R1</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fcross1</span><span class="o">*</span><span class="n">rand_cross</span></pre>
<pre class='cython code score-84 '>        __pyx_t_153 = __pyx_v_ii;
        __pyx_t_154 = 0;
        __pyx_t_74 = -1;
        if (__pyx_t_153 &lt; 0) {
          __pyx_t_153 += __pyx_v_R1.shape[0];
          if (unlikely(__pyx_t_153 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_153 &gt;= __pyx_v_R1.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_154 &lt; 0) {
          __pyx_t_154 += __pyx_v_R1.shape[1];
          if (unlikely(__pyx_t_154 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_154 &gt;= __pyx_v_R1.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
        }
        __pyx_t_85 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R1.data + __pyx_t_153 * __pyx_v_R1.strides[0]) ) + __pyx_t_154 * __pyx_v_R1.strides[1]) )));
        __pyx_t_1 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_85);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fplus1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_plus);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_85 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_155 = __pyx_v_ii;
        __pyx_t_156 = 1;
        __pyx_t_74 = -1;
        if (__pyx_t_155 &lt; 0) {
          __pyx_t_155 += __pyx_v_R1.shape[0];
          if (unlikely(__pyx_t_155 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_155 &gt;= __pyx_v_R1.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_156 &lt; 0) {
          __pyx_t_156 += __pyx_v_R1.shape[1];
          if (unlikely(__pyx_t_156 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_156 &gt;= __pyx_v_R1.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
        }
        __pyx_t_84 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R1.data + __pyx_t_155 * __pyx_v_R1.strides[0]) ) + __pyx_t_156 * __pyx_v_R1.strides[1]) )));
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_84);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fcross1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_cross);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_84 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 197, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_157 = __pyx_v_ii;
        __pyx_t_158 = 0;
        __pyx_t_74 = -1;
        if (__pyx_t_157 &lt; 0) {
          __pyx_t_157 += __pyx_v_R1.shape[0];
          if (unlikely(__pyx_t_157 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_157 &gt;= __pyx_v_R1.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_158 &lt; 0) {
          __pyx_t_158 += __pyx_v_R1.shape[1];
          if (unlikely(__pyx_t_158 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_158 &gt;= __pyx_v_R1.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
        }
        *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R1.data + __pyx_t_157 * __pyx_v_R1.strides[0]) ) + __pyx_t_158 * __pyx_v_R1.strides[1]) )) = __pyx_t_85;
        __pyx_t_159 = __pyx_v_ii;
        __pyx_t_160 = 1;
        __pyx_t_74 = -1;
        if (__pyx_t_159 &lt; 0) {
          __pyx_t_159 += __pyx_v_R1.shape[0];
          if (unlikely(__pyx_t_159 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_159 &gt;= __pyx_v_R1.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_160 &lt; 0) {
          __pyx_t_160 += __pyx_v_R1.shape[1];
          if (unlikely(__pyx_t_160 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_160 &gt;= __pyx_v_R1.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
        }
        *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R1.data + __pyx_t_159 * __pyx_v_R1.strides[0]) ) + __pyx_t_160 * __pyx_v_R1.strides[1]) )) = __pyx_t_84;
</pre><pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:                     <span class="n">R2</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">R2</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R2</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fplus2</span><span class="o">*</span><span class="n">rand_plus</span><span class="p">,</span> <span class="n">R2</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fcross2</span><span class="o">*</span><span class="n">rand_cross</span></pre>
<pre class='cython code score-84 '>        __pyx_t_161 = __pyx_v_ii;
        __pyx_t_162 = 0;
        __pyx_t_74 = -1;
        if (__pyx_t_161 &lt; 0) {
          __pyx_t_161 += __pyx_v_R2.shape[0];
          if (unlikely(__pyx_t_161 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_161 &gt;= __pyx_v_R2.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_162 &lt; 0) {
          __pyx_t_162 += __pyx_v_R2.shape[1];
          if (unlikely(__pyx_t_162 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_162 &gt;= __pyx_v_R2.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>
        }
        __pyx_t_84 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R2.data + __pyx_t_161 * __pyx_v_R2.strides[0]) ) + __pyx_t_162 * __pyx_v_R2.strides[1]) )));
        __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_84);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fplus2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_plus);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_84 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_163 = __pyx_v_ii;
        __pyx_t_164 = 1;
        __pyx_t_74 = -1;
        if (__pyx_t_163 &lt; 0) {
          __pyx_t_163 += __pyx_v_R2.shape[0];
          if (unlikely(__pyx_t_163 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_163 &gt;= __pyx_v_R2.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_164 &lt; 0) {
          __pyx_t_164 += __pyx_v_R2.shape[1];
          if (unlikely(__pyx_t_164 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_164 &gt;= __pyx_v_R2.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>
        }
        __pyx_t_85 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R2.data + __pyx_t_163 * __pyx_v_R2.strides[0]) ) + __pyx_t_164 * __pyx_v_R2.strides[1]) )));
        __pyx_t_4 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_85);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_1 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fcross2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_cross);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_85 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 198, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_165 = __pyx_v_ii;
        __pyx_t_166 = 0;
        __pyx_t_74 = -1;
        if (__pyx_t_165 &lt; 0) {
          __pyx_t_165 += __pyx_v_R2.shape[0];
          if (unlikely(__pyx_t_165 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_165 &gt;= __pyx_v_R2.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_166 &lt; 0) {
          __pyx_t_166 += __pyx_v_R2.shape[1];
          if (unlikely(__pyx_t_166 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_166 &gt;= __pyx_v_R2.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>
        }
        *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R2.data + __pyx_t_165 * __pyx_v_R2.strides[0]) ) + __pyx_t_166 * __pyx_v_R2.strides[1]) )) = __pyx_t_84;
        __pyx_t_167 = __pyx_v_ii;
        __pyx_t_168 = 1;
        __pyx_t_74 = -1;
        if (__pyx_t_167 &lt; 0) {
          __pyx_t_167 += __pyx_v_R2.shape[0];
          if (unlikely(__pyx_t_167 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_167 &gt;= __pyx_v_R2.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_168 &lt; 0) {
          __pyx_t_168 += __pyx_v_R2.shape[1];
          if (unlikely(__pyx_t_168 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_168 &gt;= __pyx_v_R2.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>
        }
        *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R2.data + __pyx_t_167 * __pyx_v_R2.strides[0]) ) + __pyx_t_168 * __pyx_v_R2.strides[1]) )) = __pyx_t_85;
</pre><pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:                     <span class="n">R3</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">R3</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R3</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fplus3</span><span class="o">*</span><span class="n">rand_plus</span><span class="p">,</span> <span class="n">R3</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fcross3</span><span class="o">*</span><span class="n">rand_cross</span></pre>
<pre class='cython code score-84 '>        __pyx_t_169 = __pyx_v_ii;
        __pyx_t_170 = 0;
        __pyx_t_74 = -1;
        if (__pyx_t_169 &lt; 0) {
          __pyx_t_169 += __pyx_v_R3.shape[0];
          if (unlikely(__pyx_t_169 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_169 &gt;= __pyx_v_R3.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_170 &lt; 0) {
          __pyx_t_170 += __pyx_v_R3.shape[1];
          if (unlikely(__pyx_t_170 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_170 &gt;= __pyx_v_R3.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
        }
        __pyx_t_85 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R3.data + __pyx_t_169 * __pyx_v_R3.strides[0]) ) + __pyx_t_170 * __pyx_v_R3.strides[1]) )));
        __pyx_t_1 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_85);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fplus3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_plus);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_85 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_171 = __pyx_v_ii;
        __pyx_t_172 = 1;
        __pyx_t_74 = -1;
        if (__pyx_t_171 &lt; 0) {
          __pyx_t_171 += __pyx_v_R3.shape[0];
          if (unlikely(__pyx_t_171 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_171 &gt;= __pyx_v_R3.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_172 &lt; 0) {
          __pyx_t_172 += __pyx_v_R3.shape[1];
          if (unlikely(__pyx_t_172 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_172 &gt;= __pyx_v_R3.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
        }
        __pyx_t_84 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R3.data + __pyx_t_171 * __pyx_v_R3.strides[0]) ) + __pyx_t_172 * __pyx_v_R3.strides[1]) )));
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_84);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fcross3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_cross);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_84 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 199, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_173 = __pyx_v_ii;
        __pyx_t_174 = 0;
        __pyx_t_74 = -1;
        if (__pyx_t_173 &lt; 0) {
          __pyx_t_173 += __pyx_v_R3.shape[0];
          if (unlikely(__pyx_t_173 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_173 &gt;= __pyx_v_R3.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_174 &lt; 0) {
          __pyx_t_174 += __pyx_v_R3.shape[1];
          if (unlikely(__pyx_t_174 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_174 &gt;= __pyx_v_R3.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
        }
        *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R3.data + __pyx_t_173 * __pyx_v_R3.strides[0]) ) + __pyx_t_174 * __pyx_v_R3.strides[1]) )) = __pyx_t_85;
        __pyx_t_175 = __pyx_v_ii;
        __pyx_t_176 = 1;
        __pyx_t_74 = -1;
        if (__pyx_t_175 &lt; 0) {
          __pyx_t_175 += __pyx_v_R3.shape[0];
          if (unlikely(__pyx_t_175 &lt; 0)) __pyx_t_74 = 0;
        } else if (unlikely(__pyx_t_175 &gt;= __pyx_v_R3.shape[0])) __pyx_t_74 = 0;
        if (__pyx_t_176 &lt; 0) {
          __pyx_t_176 += __pyx_v_R3.shape[1];
          if (unlikely(__pyx_t_176 &lt; 0)) __pyx_t_74 = 1;
        } else if (unlikely(__pyx_t_176 &gt;= __pyx_v_R3.shape[1])) __pyx_t_74 = 1;
        if (unlikely(__pyx_t_74 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_74);
          <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
        }
        *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R3.data + __pyx_t_175 * __pyx_v_R3.strides[0]) ) + __pyx_t_176 * __pyx_v_R3.strides[1]) )) = __pyx_t_84;
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">200</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">201</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">202</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">203</span>:         <span class="c">#return R1, R2, R3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">204</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">205</span>: </pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>: <span class="k">def</span> <span class="nf">orbiting_isgwb_mich_strain_response</span><span class="p">(</span><span class="nb">object</span> <span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-25 '>/* Python wrapper */
static PyObject *__pyx_pw_15cython_response_3orbiting_isgwb_mich_strain_response(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_15cython_response_2orbiting_isgwb_mich_strain_response[] = "\n        Calculate the detector transfer function functions to an isotropic SGWB non-polarized using basic michelson\n        channels. Note that since this is the response to an isotropic background, the response function is integrated\n        over sky direction and averaged over polarozation. The angular integral is a linear and rectangular in the\n        cos(theta) and phi space.  Note also that f0 is (pi*L*f)/c and is input as an array. The response function is given\n        for the strain of the signal rather than the power\n\n        \n\n        Parameters\n        -----------\n\n        f0   : float\n            A numpy array of scaled frequencies (see above for def)\n\n    \n\n        Returns\n        ---------\n\n        R1, R2 and R3   :   float\n            Antenna Patterns for the given sky direction for the three channels, integrated over sky direction and averaged over polarization.\n        ";
static PyMethodDef __pyx_mdef_15cython_response_3orbiting_isgwb_mich_strain_response = {"orbiting_isgwb_mich_strain_response", (PyCFunction)__pyx_pw_15cython_response_3orbiting_isgwb_mich_strain_response, METH_O, __pyx_doc_15cython_response_2orbiting_isgwb_mich_strain_response};
static PyObject *__pyx_pw_15cython_response_3orbiting_isgwb_mich_strain_response(PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("orbiting_isgwb_mich_strain_response (wrapper)", 0);
  __pyx_r = __pyx_pf_15cython_response_2orbiting_isgwb_mich_strain_response(__pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_15cython_response_2orbiting_isgwb_mich_strain_response(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  __Pyx_memviewslice __pyx_v_f0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_timearray = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_pi_val;
  __Pyx_memviewslice __pyx_v_ct = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_phi = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_st = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED double __pyx_v_dct;
  CYTHON_UNUSED double __pyx_v_dphi;
  double __pyx_v_x1;
  double __pyx_v_x2;
  double __pyx_v_x3;
  double __pyx_v_y1;
  double __pyx_v_y2;
  double __pyx_v_y3;
  double __pyx_v_z1;
  double __pyx_v_z2;
  double __pyx_v_z3;
  __Pyx_memviewslice __pyx_v_rs1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rs2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rs3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_uvec = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vvec = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wvec = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_Lu;
  double __pyx_v_Lv;
  double __pyx_v_Lw;
  double __pyx_v_x21u;
  double __pyx_v_y21u;
  double __pyx_v_z21u;
  double __pyx_v_x31v;
  double __pyx_v_y31v;
  double __pyx_v_z31v;
  double __pyx_v_x32w;
  double __pyx_v_y32w;
  double __pyx_v_z32w;
  int __pyx_v_numfreqs;
  int __pyx_v_numtheta;
  int __pyx_v_numphi;
  int __pyx_v_numtime;
  int __pyx_v_numdims;
  int __pyx_v_ii;
  int __pyx_v_jj;
  int __pyx_v_kk;
  int __pyx_v_tt;
  int __pyx_v_rr;
  int __pyx_v_cc;
  __Pyx_memviewslice __pyx_v_udir = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vdir = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wdir = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Pcontract_u = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Pcontract_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Pcontract_w = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Ccontract_u = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Ccontract_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Ccontract_w = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_norm = 0;
  __pyx_t_double_complex __pyx_v_exp_3f0;
  CYTHON_UNUSED __pyx_t_double_complex __pyx_v_exp_f0;
  __pyx_t_double_complex __pyx_v_exp_u;
  __pyx_t_double_complex __pyx_v_exp_v;
  __pyx_t_double_complex __pyx_v_exp_u_minus;
  __pyx_t_double_complex __pyx_v_exp_v_minus;
  __pyx_t_double_complex __pyx_v_exp_w_minus;
  __pyx_t_double_complex __pyx_v_exp_u_plus;
  __pyx_t_double_complex __pyx_v_exp_v_plus;
  __pyx_t_double_complex __pyx_v_exp_w_plus;
  __Pyx_memviewslice __pyx_v_R1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_R2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_R3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_double_complex __pyx_v_gammaU_plus;
  __pyx_t_double_complex __pyx_v_gammaV_plus;
  __pyx_t_double_complex __pyx_v_gammaW_plus;
  __pyx_t_double_complex __pyx_v_gammaU_minus;
  __pyx_t_double_complex __pyx_v_gammaV_minus;
  __pyx_t_double_complex __pyx_v_gammaW_minus;
  __pyx_t_double_complex __pyx_v_Fplus1;
  __pyx_t_double_complex __pyx_v_Fplus2;
  __pyx_t_double_complex __pyx_v_Fplus3;
  __pyx_t_double_complex __pyx_v_Fcross1;
  __pyx_t_double_complex __pyx_v_Fcross2;
  __pyx_t_double_complex __pyx_v_Fcross3;
  __pyx_t_double_complex __pyx_v_rand_plus;
  __pyx_t_double_complex __pyx_v_rand_cross;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__3)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("orbiting_isgwb_mich_strain_response", 0);
  <span class='trace'>__Pyx_TraceCall</span>("orbiting_isgwb_mich_strain_response", __pyx_f[0], 206, 0, <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_58);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_59);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_60);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cython_response.orbiting_isgwb_mich_strain_response", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_f0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_timearray, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ct, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_phi, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_st, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rs1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rs2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rs3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_uvec, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vvec, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wvec, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_udir, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vdir, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wdir, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Pcontract_u, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Pcontract_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Pcontract_w, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Ccontract_u, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Ccontract_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Ccontract_w, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_norm);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_R1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_R2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_R3, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(84, __pyx_n_s_self, __pyx_n_s_f0, __pyx_n_s_timearray, __pyx_n_s_pi_val, __pyx_n_s_ct, __pyx_n_s_phi, __pyx_n_s_st, __pyx_n_s_dct, __pyx_n_s_dphi, __pyx_n_s_x1, __pyx_n_s_x2, __pyx_n_s_x3, __pyx_n_s_y1, __pyx_n_s_y2, __pyx_n_s_y3, __pyx_n_s_z1, __pyx_n_s_z2, __pyx_n_s_z3, __pyx_n_s_rs1, __pyx_n_s_rs2, __pyx_n_s_rs3, __pyx_n_s_uvec, __pyx_n_s_vvec, __pyx_n_s_wvec, __pyx_n_s_Lu, __pyx_n_s_Lv, __pyx_n_s_Lw, __pyx_n_s_x21u, __pyx_n_s_y21u, __pyx_n_s_z21u, __pyx_n_s_x31v, __pyx_n_s_y31v, __pyx_n_s_z31v, __pyx_n_s_x32w, __pyx_n_s_y32w, __pyx_n_s_z32w, __pyx_n_s_numfreqs, __pyx_n_s_numtheta, __pyx_n_s_numphi, __pyx_n_s_numtime, __pyx_n_s_numdims, __pyx_n_s_ii, __pyx_n_s_jj, __pyx_n_s_kk, __pyx_n_s_tt, __pyx_n_s_rr, __pyx_n_s_cc, __pyx_n_s_udir, __pyx_n_s_vdir, __pyx_n_s_wdir, __pyx_n_s_Pcontract_u, __pyx_n_s_Pcontract_v, __pyx_n_s_Pcontract_w, __pyx_n_s_Ccontract_u, __pyx_n_s_Ccontract_v, __pyx_n_s_Ccontract_w, __pyx_n_s_norm, __pyx_n_s_exp_3f0, __pyx_n_s_exp_f0, __pyx_n_s_exp_u, __pyx_n_s_exp_v, __pyx_n_s_exp_u_minus, __pyx_n_s_exp_v_minus, __pyx_n_s_exp_w_minus, __pyx_n_s_exp_u_plus, __pyx_n_s_exp_v_plus, __pyx_n_s_exp_w_plus, __pyx_n_s_R1, __pyx_n_s_R2, __pyx_n_s_R3, __pyx_n_s_gammaU_plus, __pyx_n_s_gammaV_plus, __pyx_n_s_gammaW_plus, __pyx_n_s_gammaU_minus, __pyx_n_s_gammaV_minus, __pyx_n_s_gammaW_minus, __pyx_n_s_Fplus1, __pyx_n_s_Fplus2, __pyx_n_s_Fplus3, __pyx_n_s_Fcross1, __pyx_n_s_Fcross2, __pyx_n_s_Fcross3, __pyx_n_s_rand_plus, __pyx_n_s_rand_cross);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_15cython_response_3orbiting_isgwb_mich_strain_response, NULL, __pyx_n_s_cython_response);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_orbiting_isgwb_mich_strain_respo, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__3 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 84, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cython_func_cython_response, __pyx_n_s_orbiting_isgwb_mich_strain_respo, 206, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__3)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">207</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">208</span>:         <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">209</span>: <span class="sd">        Calculate the detector transfer function functions to an isotropic SGWB non-polarized using basic michelson</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">210</span>: <span class="sd">        channels. Note that since this is the response to an isotropic background, the response function is integrated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">211</span>: <span class="sd">        over sky direction and averaged over polarozation. The angular integral is a linear and rectangular in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">212</span>: <span class="sd">        cos(theta) and phi space.  Note also that f0 is (pi*L*f)/c and is input as an array. The response function is given</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">213</span>: <span class="sd">        for the strain of the signal rather than the power</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">214</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">215</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">216</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">217</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">218</span>: <span class="sd">        -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">220</span>: <span class="sd">        f0   : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">221</span>: <span class="sd">            A numpy array of scaled frequencies (see above for def)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">222</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">223</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">224</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">225</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">226</span>: <span class="sd">        ---------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">227</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">228</span>: <span class="sd">        R1, R2 and R3   :   float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">229</span>: <span class="sd">            Antenna Patterns for the given sky direction for the three channels, integrated over sky direction and averaged over polarization.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">230</span>: <span class="sd">        &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">231</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">232</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">f0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f0</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_f0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 233, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 233, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_f0 = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">timearray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timearray</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_timearray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_timearray = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">pi_val</span> <span class="o">=</span> <span class="mf">3.141592653589793238462</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pi_val = 3.141592653589793238462;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">150</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 236, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 236, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 236, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ct = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">*</span><span class="n">pi_val</span><span class="p">,</span> <span class="mf">150</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython code score-35 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_pi_val));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_150);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_150);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_150);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_endpoint, Py_False) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 237, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_phi = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">st</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ct</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_ct, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 238, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_st = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dct</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ct</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>  __pyx_t_6 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_ct.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_ct.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 239, __pyx_L1_error)</span>
  }
  __pyx_t_8 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_ct.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_ct.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 239, __pyx_L1_error)</span>
  }
  __pyx_v_dct = ((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_6 * __pyx_v_ct.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_8 * __pyx_v_ct.strides[0]) ))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dphi</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">phi</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>  __pyx_t_9 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_9 &lt; 0) {
    __pyx_t_9 += __pyx_v_phi.shape[0];
    if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_phi.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>
  }
  __pyx_t_10 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_phi.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_phi.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>
  }
  __pyx_v_dphi = ((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_9 * __pyx_v_phi.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_10 * __pyx_v_phi.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">241</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">242</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">x1</span><span class="p">,</span> <span class="nf">x2</span><span class="p">,</span> <span class="nf">x3</span><span class="p">,</span> <span class="nf">y1</span><span class="p">,</span> <span class="nf">y2</span><span class="p">,</span> <span class="nf">y3</span><span class="p">,</span> <span class="nf">z1</span><span class="p">,</span> <span class="nf">z2</span><span class="p">,</span> <span class="nf">z3</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">rs1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rs1</span></pre>
<pre class='cython code score-5 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_rs1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rs1 = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">rs2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rs2</span></pre>
<pre class='cython code score-5 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_rs2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 244, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 244, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rs2 = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">rs3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rs3</span></pre>
<pre class='cython code score-5 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_rs3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rs3 = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">uvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rs1</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_2.data = __pyx_v_rs1.data;
  __pyx_t_2.memview = __pyx_v_rs1.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  __pyx_t_2.shape[0] = __pyx_v_rs1.shape[0];
__pyx_t_2.strides[0] = __pyx_v_rs1.strides[0];
    __pyx_t_2.suboffsets[0] = -1;

{
    Py_ssize_t __pyx_tmp_idx = 0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_rs1.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_rs1.strides[1];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 1)");
            <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_uvec = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">vvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rs1</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2.data = __pyx_v_rs1.data;
  __pyx_t_2.memview = __pyx_v_rs1.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  __pyx_t_2.shape[0] = __pyx_v_rs1.shape[0];
__pyx_t_2.strides[0] = __pyx_v_rs1.strides[0];
    __pyx_t_2.suboffsets[0] = -1;

{
    Py_ssize_t __pyx_tmp_idx = 0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_rs1.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_rs1.strides[1];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 1)");
            <span class='error_goto'>__PYX_ERR(0, 247, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_vvec = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">248</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">wvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rs1</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_2.data = __pyx_v_rs1.data;
  __pyx_t_2.memview = __pyx_v_rs1.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  __pyx_t_2.shape[0] = __pyx_v_rs1.shape[0];
__pyx_t_2.strides[0] = __pyx_v_rs1.strides[0];
    __pyx_t_2.suboffsets[0] = -1;

{
    Py_ssize_t __pyx_tmp_idx = 0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_rs1.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_rs1.strides[1];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 1)");
            <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_wvec = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">249</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">Lu</span><span class="p">,</span> <span class="nf">Lv</span><span class="p">,</span> <span class="nf">Lw</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">x21u</span><span class="p">,</span> <span class="nf">y21u</span><span class="p">,</span> <span class="nf">z21u</span><span class="p">,</span> <span class="nf">x31v</span><span class="p">,</span> <span class="nf">y31v</span><span class="p">,</span> <span class="nf">z31v</span><span class="p">,</span> <span class="nf">x32w</span><span class="p">,</span> <span class="nf">y32w</span><span class="p">,</span> <span class="nf">z32w</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">numfreqs</span> <span class="o">=</span> <span class="n">f0</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-11 '>  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_f0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_numfreqs = __pyx_t_7;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">numtheta</span> <span class="o">=</span>  <span class="n">ct</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-11 '>  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_ct, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_numtheta = __pyx_t_7;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">numphi</span> <span class="o">=</span>  <span class="n">phi</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-11 '>  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_phi, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 254, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_numphi = __pyx_t_7;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">255</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">numtime</span> <span class="o">=</span> <span class="n">timearray</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-11 '>  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_timearray, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 255, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 255, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 255, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_numtime = __pyx_t_7;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">numdims</span> <span class="o">=</span> <span class="n">rs1</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-11 '>  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_rs1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 256, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_numdims = __pyx_t_7;
</pre><pre class="cython line score-0">&#xA0;<span class="">257</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">ii</span><span class="p">,</span> <span class="nf">jj</span><span class="p">,</span> <span class="nf">kk</span><span class="p">,</span> <span class="nf">tt</span><span class="p">,</span> <span class="nf">rr</span><span class="p">,</span> <span class="nf">cc</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">258</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">udir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_1);
  __pyx_t_5 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_12) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_udir = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">vdir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_1);
  __pyx_t_3 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_1, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_vdir = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">wdir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_12, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
  __pyx_t_12 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 261, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_wdir = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">262</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">263</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Pcontract_u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_1);
  __pyx_t_5 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_12) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 263, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Pcontract_u = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Pcontract_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 264, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 264, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_1);
  __pyx_t_3 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_1, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 264, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 264, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Pcontract_v = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Pcontract_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_12, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
  __pyx_t_12 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Pcontract_w = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">266</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">267</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Ccontract_u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_1);
  __pyx_t_5 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_12) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 267, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Ccontract_u = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Ccontract_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_1);
  __pyx_t_3 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_1, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Ccontract_v = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span class="n">Ccontract_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numphi</span><span class="p">,</span> <span class="n">numtheta</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_12, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numphi);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
  __pyx_t_12 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Ccontract_w = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">270</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:         <span class="k">cdef</span> <span class="nf">norm</span> <span class="o">=</span> <span class="n">sqrt_gsl</span><span class="p">(</span><span class="mf">0.5</span><span class="o">/</span><span class="n">udir</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_udir, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 271, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 271, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideCObj</span>(__pyx_float_0_5, __pyx_t_5, 0.5, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 271, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 271, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_15cython_response_sqrt_gsl(__pyx_t_13));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 271, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_norm = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">272</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">273</span>:         <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">exp_3f0</span><span class="p">,</span> <span class="nf">exp_f0</span><span class="p">,</span> <span class="nf">exp_u</span><span class="p">,</span> <span class="nf">exp_v</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">274</span>:         <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">exp_u_minus</span><span class="p">,</span> <span class="nf">exp_v_minus</span><span class="p">,</span> <span class="nf">exp_w_minus</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">275</span>:         <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">exp_u_plus</span><span class="p">,</span> <span class="nf">exp_v_plus</span><span class="p">,</span> <span class="nf">exp_w_plus</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">276</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">277</span>:         <span class="c"># Initlize arrays for the detector reponse</span></pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:         <span class="k">cdef</span> <span class="kt">complex</span>[<span class="p">:,:]</span> <span class="n">R1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;complex&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_f0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_2);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_n_s_complex) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_R1 = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:         <span class="k">cdef</span> <span class="kt">complex</span>[<span class="p">:,:]</span> <span class="n">R2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;complex&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_f0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_2);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_n_s_complex) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_R2 = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:         <span class="k">cdef</span> <span class="kt">complex</span>[<span class="p">:,:]</span> <span class="n">R3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">f0</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;complex&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_f0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_2);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_n_s_complex) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 280, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_R3 = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">281</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">282</span>:         <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">gammaU_plus</span><span class="p">,</span><span class="nf">gammaV_plus</span><span class="p">,</span><span class="nf">gammaW_plus</span><span class="p">,</span><span class="nf">gammaU_minus</span><span class="p">,</span><span class="nf">gammaV_minus</span><span class="p">,</span><span class="nf">gammaW_minus</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">283</span>:         <span class="k">cdef</span> <span class="kt">complex</span> <span class="nf">Fplus1</span><span class="p">,</span><span class="nf">Fplus2</span><span class="p">,</span><span class="nf">Fplus3</span><span class="p">,</span><span class="nf">Fcross1</span><span class="p">,</span><span class="nf">Fcross2</span><span class="p">,</span><span class="nf">Fcross3</span><span class="p">,</span> <span class="nf">rand_plus</span><span class="p">,</span> <span class="nf">rand_cross</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">284</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:         <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ct</span><span class="o">.</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-11 '>  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_ct, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_5); if (unlikely((__pyx_t_15 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_16 = __pyx_t_15;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_16; __pyx_t_7+=1) {
    __pyx_v_cc = __pyx_t_7;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:             <span class="n">st</span><span class="p">[</span><span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt_gsl</span><span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="n">ct</span><span class="p">[</span><span class="n">cc</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>    __pyx_t_17 = __pyx_v_cc;
    __pyx_t_18 = -1;
    if (__pyx_t_17 &lt; 0) {
      __pyx_t_17 += __pyx_v_ct.shape[0];
      if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_18 = 0;
    } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_ct.shape[0])) __pyx_t_18 = 0;
    if (unlikely(__pyx_t_18 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_18);
      <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    }
    __pyx_t_19 = __pyx_v_cc;
    __pyx_t_18 = -1;
    if (__pyx_t_19 &lt; 0) {
      __pyx_t_19 += __pyx_v_st.shape[0];
      if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_18 = 0;
    } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_st.shape[0])) __pyx_t_18 = 0;
    if (unlikely(__pyx_t_18 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_18);
      <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_19 * __pyx_v_st.strides[0]) )) = __pyx_f_15cython_response_sqrt_gsl((1.0 - pow((*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_17 * __pyx_v_ct.strides[0]) ))), 2.0)));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">287</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:         <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numtime</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_numtime;
  __pyx_t_18 = __pyx_t_7;
  for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_18; __pyx_t_20+=1) {
    __pyx_v_tt = __pyx_t_20;
</pre><pre class="cython line score-0">&#xA0;<span class="">289</span>:             <span class="c">## Define x/y/z for each satellite at time given by midpoints[ti]</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:             <span class="n">x1</span> <span class="o">=</span> <span class="n">rs1</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_21 = 0;
    __pyx_t_22 = __pyx_v_tt;
    __pyx_t_23 = -1;
    if (__pyx_t_21 &lt; 0) {
      __pyx_t_21 += __pyx_v_rs1.shape[0];
      if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_23 = 0;
    } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_rs1.shape[0])) __pyx_t_23 = 0;
    if (__pyx_t_22 &lt; 0) {
      __pyx_t_22 += __pyx_v_rs1.shape[1];
      if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_23 = 1;
    } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_rs1.shape[1])) __pyx_t_23 = 1;
    if (unlikely(__pyx_t_23 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
      <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L1_error)</span>
    }
    __pyx_v_x1 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs1.data + __pyx_t_21 * __pyx_v_rs1.strides[0]) ) + __pyx_t_22 * __pyx_v_rs1.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">291</span>:             <span class="n">y1</span> <span class="o">=</span> <span class="n">rs1</span><span class="p">[</span><span class="mf">1</span><span class="p">][</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_24 = 1;
    __pyx_t_25 = __pyx_v_tt;
    __pyx_t_23 = -1;
    if (__pyx_t_24 &lt; 0) {
      __pyx_t_24 += __pyx_v_rs1.shape[0];
      if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_23 = 0;
    } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_rs1.shape[0])) __pyx_t_23 = 0;
    if (__pyx_t_25 &lt; 0) {
      __pyx_t_25 += __pyx_v_rs1.shape[1];
      if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_23 = 1;
    } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_rs1.shape[1])) __pyx_t_23 = 1;
    if (unlikely(__pyx_t_23 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
      <span class='error_goto'>__PYX_ERR(0, 291, __pyx_L1_error)</span>
    }
    __pyx_v_y1 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs1.data + __pyx_t_24 * __pyx_v_rs1.strides[0]) ) + __pyx_t_25 * __pyx_v_rs1.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:             <span class="n">z1</span> <span class="o">=</span> <span class="n">rs1</span><span class="p">[</span><span class="mf">2</span><span class="p">][</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_26 = 2;
    __pyx_t_27 = __pyx_v_tt;
    __pyx_t_23 = -1;
    if (__pyx_t_26 &lt; 0) {
      __pyx_t_26 += __pyx_v_rs1.shape[0];
      if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_23 = 0;
    } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_rs1.shape[0])) __pyx_t_23 = 0;
    if (__pyx_t_27 &lt; 0) {
      __pyx_t_27 += __pyx_v_rs1.shape[1];
      if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_23 = 1;
    } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_rs1.shape[1])) __pyx_t_23 = 1;
    if (unlikely(__pyx_t_23 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
      <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span>
    }
    __pyx_v_z1 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs1.data + __pyx_t_26 * __pyx_v_rs1.strides[0]) ) + __pyx_t_27 * __pyx_v_rs1.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:             <span class="n">x2</span> <span class="o">=</span> <span class="n">rs2</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_28 = 0;
    __pyx_t_29 = __pyx_v_tt;
    __pyx_t_23 = -1;
    if (__pyx_t_28 &lt; 0) {
      __pyx_t_28 += __pyx_v_rs2.shape[0];
      if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_23 = 0;
    } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_rs2.shape[0])) __pyx_t_23 = 0;
    if (__pyx_t_29 &lt; 0) {
      __pyx_t_29 += __pyx_v_rs2.shape[1];
      if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_23 = 1;
    } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_rs2.shape[1])) __pyx_t_23 = 1;
    if (unlikely(__pyx_t_23 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
      <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>
    }
    __pyx_v_x2 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs2.data + __pyx_t_28 * __pyx_v_rs2.strides[0]) ) + __pyx_t_29 * __pyx_v_rs2.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">294</span>:             <span class="n">y2</span> <span class="o">=</span> <span class="n">rs2</span><span class="p">[</span><span class="mf">1</span><span class="p">][</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_30 = 1;
    __pyx_t_31 = __pyx_v_tt;
    __pyx_t_23 = -1;
    if (__pyx_t_30 &lt; 0) {
      __pyx_t_30 += __pyx_v_rs2.shape[0];
      if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_23 = 0;
    } else if (unlikely(__pyx_t_30 &gt;= __pyx_v_rs2.shape[0])) __pyx_t_23 = 0;
    if (__pyx_t_31 &lt; 0) {
      __pyx_t_31 += __pyx_v_rs2.shape[1];
      if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_23 = 1;
    } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_rs2.shape[1])) __pyx_t_23 = 1;
    if (unlikely(__pyx_t_23 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
      <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span>
    }
    __pyx_v_y2 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs2.data + __pyx_t_30 * __pyx_v_rs2.strides[0]) ) + __pyx_t_31 * __pyx_v_rs2.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:             <span class="n">z2</span> <span class="o">=</span> <span class="n">rs2</span><span class="p">[</span><span class="mf">2</span><span class="p">][</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_32 = 2;
    __pyx_t_33 = __pyx_v_tt;
    __pyx_t_23 = -1;
    if (__pyx_t_32 &lt; 0) {
      __pyx_t_32 += __pyx_v_rs2.shape[0];
      if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_23 = 0;
    } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_rs2.shape[0])) __pyx_t_23 = 0;
    if (__pyx_t_33 &lt; 0) {
      __pyx_t_33 += __pyx_v_rs2.shape[1];
      if (unlikely(__pyx_t_33 &lt; 0)) __pyx_t_23 = 1;
    } else if (unlikely(__pyx_t_33 &gt;= __pyx_v_rs2.shape[1])) __pyx_t_23 = 1;
    if (unlikely(__pyx_t_23 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
      <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>
    }
    __pyx_v_z2 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs2.data + __pyx_t_32 * __pyx_v_rs2.strides[0]) ) + __pyx_t_33 * __pyx_v_rs2.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:             <span class="n">x3</span> <span class="o">=</span> <span class="n">rs3</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_34 = 0;
    __pyx_t_35 = __pyx_v_tt;
    __pyx_t_23 = -1;
    if (__pyx_t_34 &lt; 0) {
      __pyx_t_34 += __pyx_v_rs3.shape[0];
      if (unlikely(__pyx_t_34 &lt; 0)) __pyx_t_23 = 0;
    } else if (unlikely(__pyx_t_34 &gt;= __pyx_v_rs3.shape[0])) __pyx_t_23 = 0;
    if (__pyx_t_35 &lt; 0) {
      __pyx_t_35 += __pyx_v_rs3.shape[1];
      if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_23 = 1;
    } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_rs3.shape[1])) __pyx_t_23 = 1;
    if (unlikely(__pyx_t_23 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
      <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
    }
    __pyx_v_x3 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs3.data + __pyx_t_34 * __pyx_v_rs3.strides[0]) ) + __pyx_t_35 * __pyx_v_rs3.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:             <span class="n">y3</span> <span class="o">=</span> <span class="n">rs3</span><span class="p">[</span><span class="mf">1</span><span class="p">][</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_36 = 1;
    __pyx_t_37 = __pyx_v_tt;
    __pyx_t_23 = -1;
    if (__pyx_t_36 &lt; 0) {
      __pyx_t_36 += __pyx_v_rs3.shape[0];
      if (unlikely(__pyx_t_36 &lt; 0)) __pyx_t_23 = 0;
    } else if (unlikely(__pyx_t_36 &gt;= __pyx_v_rs3.shape[0])) __pyx_t_23 = 0;
    if (__pyx_t_37 &lt; 0) {
      __pyx_t_37 += __pyx_v_rs3.shape[1];
      if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_23 = 1;
    } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_rs3.shape[1])) __pyx_t_23 = 1;
    if (unlikely(__pyx_t_23 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
      <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
    }
    __pyx_v_y3 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs3.data + __pyx_t_36 * __pyx_v_rs3.strides[0]) ) + __pyx_t_37 * __pyx_v_rs3.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:             <span class="n">z3</span> <span class="o">=</span> <span class="n">rs3</span><span class="p">[</span><span class="mf">2</span><span class="p">][</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_38 = 2;
    __pyx_t_39 = __pyx_v_tt;
    __pyx_t_23 = -1;
    if (__pyx_t_38 &lt; 0) {
      __pyx_t_38 += __pyx_v_rs3.shape[0];
      if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_23 = 0;
    } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_rs3.shape[0])) __pyx_t_23 = 0;
    if (__pyx_t_39 &lt; 0) {
      __pyx_t_39 += __pyx_v_rs3.shape[1];
      if (unlikely(__pyx_t_39 &lt; 0)) __pyx_t_23 = 1;
    } else if (unlikely(__pyx_t_39 &gt;= __pyx_v_rs3.shape[1])) __pyx_t_23 = 1;
    if (unlikely(__pyx_t_23 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
      <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>
    }
    __pyx_v_z3 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs3.data + __pyx_t_38 * __pyx_v_rs3.strides[0]) ) + __pyx_t_39 * __pyx_v_rs3.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">299</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">300</span>:             <span class="c">## Define vector u at time midpoints[ti]</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">301</span>:             <span class="k">for</span> <span class="n">rr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numdims</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_23 = __pyx_v_numdims;
    __pyx_t_40 = __pyx_t_23;
    for (__pyx_t_41 = 0; __pyx_t_41 &lt; __pyx_t_40; __pyx_t_41+=1) {
      __pyx_v_rr = __pyx_t_41;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">302</span>:                 <span class="n">uvec</span><span class="p">[</span><span class="n">rr</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span><span class="n">tt</span><span class="p">]</span> <span class="o">-</span> <span class="n">rs1</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>      __pyx_t_42 = __pyx_v_rr;
      __pyx_t_43 = __pyx_v_tt;
      __pyx_t_44 = -1;
      if (__pyx_t_42 &lt; 0) {
        __pyx_t_42 += __pyx_v_rs2.shape[0];
        if (unlikely(__pyx_t_42 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_42 &gt;= __pyx_v_rs2.shape[0])) __pyx_t_44 = 0;
      if (__pyx_t_43 &lt; 0) {
        __pyx_t_43 += __pyx_v_rs2.shape[1];
        if (unlikely(__pyx_t_43 &lt; 0)) __pyx_t_44 = 1;
      } else if (unlikely(__pyx_t_43 &gt;= __pyx_v_rs2.shape[1])) __pyx_t_44 = 1;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 302, __pyx_L1_error)</span>
      }
      __pyx_t_45 = __pyx_v_rr;
      __pyx_t_46 = __pyx_v_tt;
      __pyx_t_44 = -1;
      if (__pyx_t_45 &lt; 0) {
        __pyx_t_45 += __pyx_v_rs1.shape[0];
        if (unlikely(__pyx_t_45 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_45 &gt;= __pyx_v_rs1.shape[0])) __pyx_t_44 = 0;
      if (__pyx_t_46 &lt; 0) {
        __pyx_t_46 += __pyx_v_rs1.shape[1];
        if (unlikely(__pyx_t_46 &lt; 0)) __pyx_t_44 = 1;
      } else if (unlikely(__pyx_t_46 &gt;= __pyx_v_rs1.shape[1])) __pyx_t_44 = 1;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 302, __pyx_L1_error)</span>
      }
      __pyx_t_47 = __pyx_v_rr;
      __pyx_t_44 = -1;
      if (__pyx_t_47 &lt; 0) {
        __pyx_t_47 += __pyx_v_uvec.shape[0];
        if (unlikely(__pyx_t_47 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_47 &gt;= __pyx_v_uvec.shape[0])) __pyx_t_44 = 0;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 302, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_uvec.data + __pyx_t_47 * __pyx_v_uvec.strides[0]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs2.data + __pyx_t_42 * __pyx_v_rs2.strides[0]) ) + __pyx_t_43 * __pyx_v_rs2.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs1.data + __pyx_t_45 * __pyx_v_rs1.strides[0]) ) + __pyx_t_46 * __pyx_v_rs1.strides[1]) ))));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">303</span>:                 <span class="n">vvec</span><span class="p">[</span><span class="n">rr</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs3</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span><span class="n">tt</span><span class="p">]</span> <span class="o">-</span> <span class="n">rs1</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>      __pyx_t_48 = __pyx_v_rr;
      __pyx_t_49 = __pyx_v_tt;
      __pyx_t_44 = -1;
      if (__pyx_t_48 &lt; 0) {
        __pyx_t_48 += __pyx_v_rs3.shape[0];
        if (unlikely(__pyx_t_48 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_48 &gt;= __pyx_v_rs3.shape[0])) __pyx_t_44 = 0;
      if (__pyx_t_49 &lt; 0) {
        __pyx_t_49 += __pyx_v_rs3.shape[1];
        if (unlikely(__pyx_t_49 &lt; 0)) __pyx_t_44 = 1;
      } else if (unlikely(__pyx_t_49 &gt;= __pyx_v_rs3.shape[1])) __pyx_t_44 = 1;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span>
      }
      __pyx_t_50 = __pyx_v_rr;
      __pyx_t_51 = __pyx_v_tt;
      __pyx_t_44 = -1;
      if (__pyx_t_50 &lt; 0) {
        __pyx_t_50 += __pyx_v_rs1.shape[0];
        if (unlikely(__pyx_t_50 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_50 &gt;= __pyx_v_rs1.shape[0])) __pyx_t_44 = 0;
      if (__pyx_t_51 &lt; 0) {
        __pyx_t_51 += __pyx_v_rs1.shape[1];
        if (unlikely(__pyx_t_51 &lt; 0)) __pyx_t_44 = 1;
      } else if (unlikely(__pyx_t_51 &gt;= __pyx_v_rs1.shape[1])) __pyx_t_44 = 1;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span>
      }
      __pyx_t_52 = __pyx_v_rr;
      __pyx_t_44 = -1;
      if (__pyx_t_52 &lt; 0) {
        __pyx_t_52 += __pyx_v_vvec.shape[0];
        if (unlikely(__pyx_t_52 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_52 &gt;= __pyx_v_vvec.shape[0])) __pyx_t_44 = 0;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_vvec.data + __pyx_t_52 * __pyx_v_vvec.strides[0]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs3.data + __pyx_t_48 * __pyx_v_rs3.strides[0]) ) + __pyx_t_49 * __pyx_v_rs3.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs1.data + __pyx_t_50 * __pyx_v_rs1.strides[0]) ) + __pyx_t_51 * __pyx_v_rs1.strides[1]) ))));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">304</span>:                 <span class="n">wvec</span><span class="p">[</span><span class="n">rr</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs3</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span><span class="n">tt</span><span class="p">]</span> <span class="o">-</span> <span class="n">rs2</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span><span class="n">tt</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>      __pyx_t_53 = __pyx_v_rr;
      __pyx_t_54 = __pyx_v_tt;
      __pyx_t_44 = -1;
      if (__pyx_t_53 &lt; 0) {
        __pyx_t_53 += __pyx_v_rs3.shape[0];
        if (unlikely(__pyx_t_53 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_53 &gt;= __pyx_v_rs3.shape[0])) __pyx_t_44 = 0;
      if (__pyx_t_54 &lt; 0) {
        __pyx_t_54 += __pyx_v_rs3.shape[1];
        if (unlikely(__pyx_t_54 &lt; 0)) __pyx_t_44 = 1;
      } else if (unlikely(__pyx_t_54 &gt;= __pyx_v_rs3.shape[1])) __pyx_t_44 = 1;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>
      }
      __pyx_t_55 = __pyx_v_rr;
      __pyx_t_56 = __pyx_v_tt;
      __pyx_t_44 = -1;
      if (__pyx_t_55 &lt; 0) {
        __pyx_t_55 += __pyx_v_rs2.shape[0];
        if (unlikely(__pyx_t_55 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_55 &gt;= __pyx_v_rs2.shape[0])) __pyx_t_44 = 0;
      if (__pyx_t_56 &lt; 0) {
        __pyx_t_56 += __pyx_v_rs2.shape[1];
        if (unlikely(__pyx_t_56 &lt; 0)) __pyx_t_44 = 1;
      } else if (unlikely(__pyx_t_56 &gt;= __pyx_v_rs2.shape[1])) __pyx_t_44 = 1;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>
      }
      __pyx_t_57 = __pyx_v_rr;
      __pyx_t_44 = -1;
      if (__pyx_t_57 &lt; 0) {
        __pyx_t_57 += __pyx_v_wvec.shape[0];
        if (unlikely(__pyx_t_57 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_57 &gt;= __pyx_v_wvec.shape[0])) __pyx_t_44 = 0;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_wvec.data + __pyx_t_57 * __pyx_v_wvec.strides[0]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs3.data + __pyx_t_53 * __pyx_v_rs3.strides[0]) ) + __pyx_t_54 * __pyx_v_rs3.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs2.data + __pyx_t_55 * __pyx_v_rs2.strides[0]) ) + __pyx_t_56 * __pyx_v_rs2.strides[1]) ))));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">305</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">306</span>:             <span class="c">## Calculate arm lengths</span></pre>
<pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">307</span>:             <span class="n">Lu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">uvec</span><span class="p">,</span><span class="n">uvec</span><span class="p">))</span></pre>
<pre class='cython code score-75 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_uvec, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_58 = __pyx_memoryview_fromslice(__pyx_v_uvec, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_58)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_58);
    __pyx_t_59 = NULL;
    __pyx_t_23 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_59 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_59)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_59);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
        __pyx_t_23 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_12)) {
      PyObject *__pyx_temp[3] = {__pyx_t_59, __pyx_t_1, __pyx_t_58};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_12, __pyx_temp+1-__pyx_t_23, 2+__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_58); __pyx_t_58 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_12)) {
      PyObject *__pyx_temp[3] = {__pyx_t_59, __pyx_t_1, __pyx_t_58};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_12, __pyx_temp+1-__pyx_t_23, 2+__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_58); __pyx_t_58 = 0;
    } else
    #endif
    {
      __pyx_t_60 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_60)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_60);
      if (__pyx_t_59) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_59); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_60, 0, __pyx_t_59); __pyx_t_59 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_60, 0+__pyx_t_23, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_58);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_60, 1+__pyx_t_23, __pyx_t_58);
      __pyx_t_1 = 0;
      __pyx_t_58 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_60, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_60); __pyx_t_60 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_5 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_5); if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 307, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_Lu = __pyx_t_13;
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">308</span>:             <span class="n">Lv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vvec</span><span class="p">,</span><span class="n">vvec</span><span class="p">))</span></pre>
<pre class='cython code score-75 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_12, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_60 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_60)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_60);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_vvec, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_58 = __pyx_memoryview_fromslice(__pyx_v_vvec, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_58)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_58);
    __pyx_t_1 = NULL;
    __pyx_t_23 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_60))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_60);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_60);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_60, function);
        __pyx_t_23 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_60)) {
      PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_12, __pyx_t_58};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_60, __pyx_temp+1-__pyx_t_23, 2+__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_58); __pyx_t_58 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_60)) {
      PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_12, __pyx_t_58};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_60, __pyx_temp+1-__pyx_t_23, 2+__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_58); __pyx_t_58 = 0;
    } else
    #endif
    {
      __pyx_t_59 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
      if (__pyx_t_1) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_59, 0, __pyx_t_1); __pyx_t_1 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_59, 0+__pyx_t_23, __pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_58);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_59, 1+__pyx_t_23, __pyx_t_58);
      __pyx_t_12 = 0;
      __pyx_t_58 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_60, __pyx_t_59, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_60); __pyx_t_60 = 0;
    __pyx_t_60 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_60 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_60)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_60);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_5 = (__pyx_t_60) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_60, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_60); __pyx_t_60 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_5); if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_Lv = __pyx_t_13;
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">309</span>:             <span class="n">Lw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">wvec</span><span class="p">,</span><span class="n">wvec</span><span class="p">))</span></pre>
<pre class='cython code score-75 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_60, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_60)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_60);
    __pyx_t_59 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_60, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_60); __pyx_t_60 = 0;
    __pyx_t_60 = __pyx_memoryview_fromslice(__pyx_v_wvec, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_60)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_60);
    __pyx_t_58 = __pyx_memoryview_fromslice(__pyx_v_wvec, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_58)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_58);
    __pyx_t_12 = NULL;
    __pyx_t_23 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_59))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_59);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_59);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_59, function);
        __pyx_t_23 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_59)) {
      PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_60, __pyx_t_58};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_59, __pyx_temp+1-__pyx_t_23, 2+__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_60); __pyx_t_60 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_58); __pyx_t_58 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_59)) {
      PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_60, __pyx_t_58};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_59, __pyx_temp+1-__pyx_t_23, 2+__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_60); __pyx_t_60 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_58); __pyx_t_58 = 0;
    } else
    #endif
    {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (__pyx_t_12) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_12); __pyx_t_12 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_60);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_23, __pyx_t_60);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_58);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_23, __pyx_t_58);
      __pyx_t_60 = 0;
      __pyx_t_58 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_59, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
    __pyx_t_59 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_59 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_59)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_59);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_5 = (__pyx_t_59) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_59, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_5); if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_Lw = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">310</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>:             <span class="n">x21u</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">Lu</span></pre>
<pre class='cython code score-5 '>    __pyx_t_13 = (__pyx_v_x2 - __pyx_v_x1);
    if (unlikely(__pyx_v_Lu == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
    }
    __pyx_v_x21u = (__pyx_t_13 / __pyx_v_Lu);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>:             <span class="n">y21u</span> <span class="o">=</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="n">Lu</span></pre>
<pre class='cython code score-5 '>    __pyx_t_13 = (__pyx_v_y2 - __pyx_v_y1);
    if (unlikely(__pyx_v_Lu == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L1_error)</span>
    }
    __pyx_v_y21u = (__pyx_t_13 / __pyx_v_Lu);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>:             <span class="n">z21u</span> <span class="o">=</span> <span class="p">(</span><span class="n">z2</span><span class="o">-</span><span class="n">z1</span><span class="p">)</span><span class="o">/</span><span class="n">Lu</span></pre>
<pre class='cython code score-5 '>    __pyx_t_13 = (__pyx_v_z2 - __pyx_v_z1);
    if (unlikely(__pyx_v_Lu == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 313, __pyx_L1_error)</span>
    }
    __pyx_v_z21u = (__pyx_t_13 / __pyx_v_Lu);
</pre><pre class="cython line score-0">&#xA0;<span class="">314</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:             <span class="n">x31v</span> <span class="o">=</span> <span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">Lv</span></pre>
<pre class='cython code score-5 '>    __pyx_t_13 = (__pyx_v_x3 - __pyx_v_x1);
    if (unlikely(__pyx_v_Lv == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span>
    }
    __pyx_v_x31v = (__pyx_t_13 / __pyx_v_Lv);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>:             <span class="n">y31v</span> <span class="o">=</span> <span class="p">(</span><span class="n">y3</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="n">Lv</span></pre>
<pre class='cython code score-5 '>    __pyx_t_13 = (__pyx_v_y3 - __pyx_v_y1);
    if (unlikely(__pyx_v_Lv == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 316, __pyx_L1_error)</span>
    }
    __pyx_v_y31v = (__pyx_t_13 / __pyx_v_Lv);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:             <span class="n">z31v</span> <span class="o">=</span> <span class="p">(</span><span class="n">z3</span><span class="o">-</span><span class="n">z1</span><span class="p">)</span><span class="o">/</span><span class="n">Lv</span></pre>
<pre class='cython code score-5 '>    __pyx_t_13 = (__pyx_v_z3 - __pyx_v_z1);
    if (unlikely(__pyx_v_Lv == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>
    }
    __pyx_v_z31v = (__pyx_t_13 / __pyx_v_Lv);
</pre><pre class="cython line score-0">&#xA0;<span class="">318</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>:             <span class="n">x32w</span> <span class="o">=</span> <span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">/</span><span class="n">Lw</span></pre>
<pre class='cython code score-5 '>    __pyx_t_13 = (__pyx_v_x3 - __pyx_v_x2);
    if (unlikely(__pyx_v_Lw == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>
    }
    __pyx_v_x32w = (__pyx_t_13 / __pyx_v_Lw);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>:             <span class="n">y32w</span> <span class="o">=</span> <span class="p">(</span><span class="n">y3</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span><span class="o">/</span><span class="n">Lw</span></pre>
<pre class='cython code score-5 '>    __pyx_t_13 = (__pyx_v_y3 - __pyx_v_y2);
    if (unlikely(__pyx_v_Lw == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>
    }
    __pyx_v_y32w = (__pyx_t_13 / __pyx_v_Lw);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">321</span>:             <span class="n">z32w</span> <span class="o">=</span> <span class="p">(</span><span class="n">z3</span><span class="o">-</span><span class="n">z2</span><span class="p">)</span><span class="o">/</span><span class="n">Lw</span></pre>
<pre class='cython code score-5 '>    __pyx_t_13 = (__pyx_v_z3 - __pyx_v_z2);
    if (unlikely(__pyx_v_Lw == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>
    }
    __pyx_v_z32w = (__pyx_t_13 / __pyx_v_Lw);
</pre><pre class="cython line score-0">&#xA0;<span class="">322</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">323</span>:             <span class="c">#udir = ((x2-x1)/Lu)*np.cos(phi)*st + ((y2-y1)/Lu)*np.sin(phi)*st + ((z2-z1)/Lu)*ct</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>:             <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numphi</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_23 = __pyx_v_numphi;
    __pyx_t_40 = __pyx_t_23;
    for (__pyx_t_41 = 0; __pyx_t_41 &lt; __pyx_t_40; __pyx_t_41+=1) {
      __pyx_v_ii = __pyx_t_41;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>:                 <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numtheta</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_44 = __pyx_v_numtheta;
      __pyx_t_61 = __pyx_t_44;
      for (__pyx_t_62 = 0; __pyx_t_62 &lt; __pyx_t_61; __pyx_t_62+=1) {
        __pyx_v_jj = __pyx_t_62;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>:                     <span class="n">udir</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">x21u</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="o">+</span> <span class="n">y21u</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="o">+</span> <span class="n">z21u</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span></pre>
<pre class='cython code score-12 '>        __pyx_t_63 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_63 &lt; 0) {
          __pyx_t_63 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_63 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_63 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
        }
        __pyx_t_65 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_65 &lt; 0) {
          __pyx_t_65 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_65 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_65 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
        }
        __pyx_t_66 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_66 &lt; 0) {
          __pyx_t_66 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_66 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_66 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
        }
        __pyx_t_67 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_67 &lt; 0) {
          __pyx_t_67 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_67 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_67 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
        }
        __pyx_t_68 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_68 &lt; 0) {
          __pyx_t_68 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_68 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_68 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
        }
        __pyx_t_69 = __pyx_v_ii;
        __pyx_t_70 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_69 &lt; 0) {
          __pyx_t_69 += __pyx_v_udir.shape[0];
          if (unlikely(__pyx_t_69 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_69 &gt;= __pyx_v_udir.shape[0])) __pyx_t_64 = 0;
        if (__pyx_t_70 &lt; 0) {
          __pyx_t_70 += __pyx_v_udir.shape[1];
          if (unlikely(__pyx_t_70 &lt; 0)) __pyx_t_64 = 1;
        } else if (unlikely(__pyx_t_70 &gt;= __pyx_v_udir.shape[1])) __pyx_t_64 = 1;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_69 * __pyx_v_udir.strides[0]) ) + __pyx_t_70 * __pyx_v_udir.strides[1]) )) = ((((__pyx_v_x21u * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_63 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_65 * __pyx_v_st.strides[0]) )))) + ((__pyx_v_y21u * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_66 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_67 * __pyx_v_st.strides[0]) ))))) + (__pyx_v_z21u * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_68 * __pyx_v_ct.strides[0]) )))));
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">327</span>:                     <span class="n">vdir</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">x31v</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="o">+</span> <span class="n">y31v</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="o">+</span> <span class="n">z31v</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span></pre>
<pre class='cython code score-12 '>        __pyx_t_71 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_71 &lt; 0) {
          __pyx_t_71 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_71 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_71 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
        }
        __pyx_t_72 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_72 &lt; 0) {
          __pyx_t_72 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_72 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_72 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
        }
        __pyx_t_73 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_73 &lt; 0) {
          __pyx_t_73 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_73 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_73 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
        }
        __pyx_t_74 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_74 &lt; 0) {
          __pyx_t_74 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_74 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_74 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
        }
        __pyx_t_75 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_75 &lt; 0) {
          __pyx_t_75 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_75 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_75 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
        }
        __pyx_t_76 = __pyx_v_ii;
        __pyx_t_77 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_76 &lt; 0) {
          __pyx_t_76 += __pyx_v_vdir.shape[0];
          if (unlikely(__pyx_t_76 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_76 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_64 = 0;
        if (__pyx_t_77 &lt; 0) {
          __pyx_t_77 += __pyx_v_vdir.shape[1];
          if (unlikely(__pyx_t_77 &lt; 0)) __pyx_t_64 = 1;
        } else if (unlikely(__pyx_t_77 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_64 = 1;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_76 * __pyx_v_vdir.strides[0]) ) + __pyx_t_77 * __pyx_v_vdir.strides[1]) )) = ((((__pyx_v_x31v * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_71 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_72 * __pyx_v_st.strides[0]) )))) + ((__pyx_v_y31v * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_73 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_74 * __pyx_v_st.strides[0]) ))))) + (__pyx_v_z31v * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_75 * __pyx_v_ct.strides[0]) )))));
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>:                     <span class="n">wdir</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">x32w</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="o">+</span> <span class="n">y32w</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="o">+</span> <span class="n">z32w</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span></pre>
<pre class='cython code score-12 '>        __pyx_t_78 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_78 &lt; 0) {
          __pyx_t_78 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_78 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_78 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
        }
        __pyx_t_79 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_79 &lt; 0) {
          __pyx_t_79 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_79 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_79 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
        }
        __pyx_t_80 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_80 &lt; 0) {
          __pyx_t_80 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_80 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_80 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
        }
        __pyx_t_81 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_81 &lt; 0) {
          __pyx_t_81 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_81 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_81 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
        }
        __pyx_t_82 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_82 &lt; 0) {
          __pyx_t_82 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_82 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_82 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
        }
        __pyx_t_83 = __pyx_v_ii;
        __pyx_t_84 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_83 &lt; 0) {
          __pyx_t_83 += __pyx_v_wdir.shape[0];
          if (unlikely(__pyx_t_83 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_83 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_64 = 0;
        if (__pyx_t_84 &lt; 0) {
          __pyx_t_84 += __pyx_v_wdir.shape[1];
          if (unlikely(__pyx_t_84 &lt; 0)) __pyx_t_64 = 1;
        } else if (unlikely(__pyx_t_84 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_64 = 1;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_83 * __pyx_v_wdir.strides[0]) ) + __pyx_t_84 * __pyx_v_wdir.strides[1]) )) = ((((__pyx_v_x32w * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_78 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_79 * __pyx_v_st.strides[0]) )))) + ((__pyx_v_y32w * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_80 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_81 * __pyx_v_st.strides[0]) ))))) + (__pyx_v_z32w * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_82 * __pyx_v_ct.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">329</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">330</span>:                     <span class="c">## Calculate 1/2(u x u):eplus</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">331</span>:                     <span class="n">Pcontract_u</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span><span class="o">/</span><span class="mf">2</span><span class="o">*</span><span class="p">((</span><span class="n">x21u</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">-</span><span class="n">y21u</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span><span class="o">**</span><span class="mf">2</span> <span class="o">-</span> \</pre>
<pre class='cython code score-6 '>        __pyx_t_85 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_85 &lt; 0) {
          __pyx_t_85 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_85 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_85 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 331, __pyx_L1_error)</span>
        }
        __pyx_t_86 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_86 &lt; 0) {
          __pyx_t_86 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_86 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_86 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 331, __pyx_L1_error)</span>
        }
/* … */
        __pyx_t_92 = __pyx_v_ii;
        __pyx_t_93 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_92 &lt; 0) {
          __pyx_t_92 += __pyx_v_Pcontract_u.shape[0];
          if (unlikely(__pyx_t_92 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_92 &gt;= __pyx_v_Pcontract_u.shape[0])) __pyx_t_64 = 0;
        if (__pyx_t_93 &lt; 0) {
          __pyx_t_93 += __pyx_v_Pcontract_u.shape[1];
          if (unlikely(__pyx_t_93 &lt; 0)) __pyx_t_64 = 1;
        } else if (unlikely(__pyx_t_93 &gt;= __pyx_v_Pcontract_u.shape[1])) __pyx_t_64 = 1;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 331, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Pcontract_u.data + __pyx_t_92 * __pyx_v_Pcontract_u.strides[0]) ) + __pyx_t_93 * __pyx_v_Pcontract_u.strides[1]) )) = ((1.0 / 2.0) * (pow(((__pyx_v_x21u * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_85 * __pyx_v_phi.strides[0]) ))))) - (__pyx_v_y21u * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_86 * __pyx_v_phi.strides[0]) )))))), 2.0) - pow(((((__pyx_v_x21u * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_87 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_88 * __pyx_v_ct.strides[0]) )))) + ((__pyx_v_y21u * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_89 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_90 * __pyx_v_ct.strides[0]) ))))) - (__pyx_v_z21u * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_91 * __pyx_v_st.strides[0]) ))))), 2.0)));
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">332</span>:                                      <span class="p">(</span><span class="n">x21u</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">y21u</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">-</span><span class="n">z21u</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>        __pyx_t_87 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_87 &lt; 0) {
          __pyx_t_87 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_87 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_87 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
        }
        __pyx_t_88 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_88 &lt; 0) {
          __pyx_t_88 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_88 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_88 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
        }
        __pyx_t_89 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_89 &lt; 0) {
          __pyx_t_89 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_89 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_89 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
        }
        __pyx_t_90 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_90 &lt; 0) {
          __pyx_t_90 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_90 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_90 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
        }
        __pyx_t_91 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_91 &lt; 0) {
          __pyx_t_91 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_91 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_91 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">333</span>:                     <span class="n">Pcontract_v</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span><span class="o">/</span><span class="mf">2</span><span class="o">*</span><span class="p">((</span><span class="n">x31v</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">-</span><span class="n">y31v</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span><span class="o">**</span><span class="mf">2</span> <span class="o">-</span> \</pre>
<pre class='cython code score-6 '>        __pyx_t_94 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_94 &lt; 0) {
          __pyx_t_94 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_94 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_94 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 333, __pyx_L1_error)</span>
        }
        __pyx_t_95 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_95 &lt; 0) {
          __pyx_t_95 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_95 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_95 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 333, __pyx_L1_error)</span>
        }
/* … */
        __pyx_t_101 = __pyx_v_ii;
        __pyx_t_102 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_101 &lt; 0) {
          __pyx_t_101 += __pyx_v_Pcontract_v.shape[0];
          if (unlikely(__pyx_t_101 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_101 &gt;= __pyx_v_Pcontract_v.shape[0])) __pyx_t_64 = 0;
        if (__pyx_t_102 &lt; 0) {
          __pyx_t_102 += __pyx_v_Pcontract_v.shape[1];
          if (unlikely(__pyx_t_102 &lt; 0)) __pyx_t_64 = 1;
        } else if (unlikely(__pyx_t_102 &gt;= __pyx_v_Pcontract_v.shape[1])) __pyx_t_64 = 1;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 333, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Pcontract_v.data + __pyx_t_101 * __pyx_v_Pcontract_v.strides[0]) ) + __pyx_t_102 * __pyx_v_Pcontract_v.strides[1]) )) = ((1.0 / 2.0) * (pow(((__pyx_v_x31v * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_94 * __pyx_v_phi.strides[0]) ))))) - (__pyx_v_y31v * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_95 * __pyx_v_phi.strides[0]) )))))), 2.0) - pow(((((__pyx_v_x31v * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_96 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_97 * __pyx_v_ct.strides[0]) )))) + ((__pyx_v_y31v * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_98 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_99 * __pyx_v_ct.strides[0]) ))))) - (__pyx_v_z31v * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_100 * __pyx_v_st.strides[0]) ))))), 2.0)));
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>:                                      <span class="p">(</span><span class="n">x31v</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">y31v</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">-</span><span class="n">z31v</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>        __pyx_t_96 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_96 &lt; 0) {
          __pyx_t_96 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_96 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_96 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 334, __pyx_L1_error)</span>
        }
        __pyx_t_97 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_97 &lt; 0) {
          __pyx_t_97 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_97 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_97 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 334, __pyx_L1_error)</span>
        }
        __pyx_t_98 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_98 &lt; 0) {
          __pyx_t_98 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_98 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_98 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 334, __pyx_L1_error)</span>
        }
        __pyx_t_99 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_99 &lt; 0) {
          __pyx_t_99 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_99 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_99 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 334, __pyx_L1_error)</span>
        }
        __pyx_t_100 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_100 &lt; 0) {
          __pyx_t_100 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_100 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_100 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 334, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">335</span>:                     <span class="n">Pcontract_w</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span><span class="o">/</span><span class="mf">2</span><span class="o">*</span><span class="p">((</span><span class="n">x32w</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">-</span><span class="n">y32w</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span><span class="o">**</span><span class="mf">2</span> <span class="o">-</span> \</pre>
<pre class='cython code score-6 '>        __pyx_t_103 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_103 &lt; 0) {
          __pyx_t_103 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_103 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_103 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span>
        }
        __pyx_t_104 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_104 &lt; 0) {
          __pyx_t_104 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_104 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_104 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span>
        }
/* … */
        __pyx_t_110 = __pyx_v_ii;
        __pyx_t_111 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_110 &lt; 0) {
          __pyx_t_110 += __pyx_v_Pcontract_w.shape[0];
          if (unlikely(__pyx_t_110 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_110 &gt;= __pyx_v_Pcontract_w.shape[0])) __pyx_t_64 = 0;
        if (__pyx_t_111 &lt; 0) {
          __pyx_t_111 += __pyx_v_Pcontract_w.shape[1];
          if (unlikely(__pyx_t_111 &lt; 0)) __pyx_t_64 = 1;
        } else if (unlikely(__pyx_t_111 &gt;= __pyx_v_Pcontract_w.shape[1])) __pyx_t_64 = 1;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Pcontract_w.data + __pyx_t_110 * __pyx_v_Pcontract_w.strides[0]) ) + __pyx_t_111 * __pyx_v_Pcontract_w.strides[1]) )) = ((1.0 / 2.0) * (pow(((__pyx_v_x32w * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_103 * __pyx_v_phi.strides[0]) ))))) - (__pyx_v_y32w * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_104 * __pyx_v_phi.strides[0]) )))))), 2.0) - pow(((((__pyx_v_x32w * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_105 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_106 * __pyx_v_ct.strides[0]) )))) + ((__pyx_v_y32w * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_107 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_108 * __pyx_v_ct.strides[0]) ))))) - (__pyx_v_z32w * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_109 * __pyx_v_st.strides[0]) ))))), 2.0)));
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">336</span>:                                      <span class="p">(</span><span class="n">x32w</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">y32w</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">-</span><span class="n">z32w</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>        __pyx_t_105 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_105 &lt; 0) {
          __pyx_t_105 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_105 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_105 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>
        }
        __pyx_t_106 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_106 &lt; 0) {
          __pyx_t_106 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_106 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_106 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>
        }
        __pyx_t_107 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_107 &lt; 0) {
          __pyx_t_107 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_107 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_107 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>
        }
        __pyx_t_108 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_108 &lt; 0) {
          __pyx_t_108 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_108 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_108 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>
        }
        __pyx_t_109 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_109 &lt; 0) {
          __pyx_t_109 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_109 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_109 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">337</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">338</span>:                     <span class="c">## Calculate 1/2(u x u):ecross</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">339</span>:                     <span class="n">Ccontract_u</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x21u</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">-</span><span class="n">y21u</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span> <span class="o">*</span> \</pre>
<pre class='cython code score-6 '>        __pyx_t_112 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_112 &lt; 0) {
          __pyx_t_112 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_112 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_112 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 339, __pyx_L1_error)</span>
        }
        __pyx_t_113 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_113 &lt; 0) {
          __pyx_t_113 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_113 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_113 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 339, __pyx_L1_error)</span>
        }
/* … */
        __pyx_t_119 = __pyx_v_ii;
        __pyx_t_120 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_119 &lt; 0) {
          __pyx_t_119 += __pyx_v_Ccontract_u.shape[0];
          if (unlikely(__pyx_t_119 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_119 &gt;= __pyx_v_Ccontract_u.shape[0])) __pyx_t_64 = 0;
        if (__pyx_t_120 &lt; 0) {
          __pyx_t_120 += __pyx_v_Ccontract_u.shape[1];
          if (unlikely(__pyx_t_120 &lt; 0)) __pyx_t_64 = 1;
        } else if (unlikely(__pyx_t_120 &gt;= __pyx_v_Ccontract_u.shape[1])) __pyx_t_64 = 1;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 339, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Ccontract_u.data + __pyx_t_119 * __pyx_v_Ccontract_u.strides[0]) ) + __pyx_t_120 * __pyx_v_Ccontract_u.strides[1]) )) = (((__pyx_v_x21u * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_112 * __pyx_v_phi.strides[0]) ))))) - (__pyx_v_y21u * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_113 * __pyx_v_phi.strides[0]) )))))) * ((((__pyx_v_x21u * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_114 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_115 * __pyx_v_ct.strides[0]) )))) + ((__pyx_v_y21u * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_116 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_117 * __pyx_v_ct.strides[0]) ))))) - (__pyx_v_z21u * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_118 * __pyx_v_st.strides[0]) ))))));
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">340</span>:                                     <span class="p">(</span><span class="n">x21u</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">y21u</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">-</span><span class="n">z21u</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span></pre>
<pre class='cython code score-10 '>        __pyx_t_114 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_114 &lt; 0) {
          __pyx_t_114 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_114 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_114 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 340, __pyx_L1_error)</span>
        }
        __pyx_t_115 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_115 &lt; 0) {
          __pyx_t_115 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_115 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_115 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 340, __pyx_L1_error)</span>
        }
        __pyx_t_116 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_116 &lt; 0) {
          __pyx_t_116 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_116 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_116 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 340, __pyx_L1_error)</span>
        }
        __pyx_t_117 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_117 &lt; 0) {
          __pyx_t_117 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_117 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_117 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 340, __pyx_L1_error)</span>
        }
        __pyx_t_118 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_118 &lt; 0) {
          __pyx_t_118 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_118 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_118 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 340, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">341</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">342</span>:                     <span class="n">Ccontract_v</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x31v</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">-</span><span class="n">y31v</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span> <span class="o">*</span> \</pre>
<pre class='cython code score-6 '>        __pyx_t_121 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_121 &lt; 0) {
          __pyx_t_121 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_121 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_121 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
        }
        __pyx_t_122 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_122 &lt; 0) {
          __pyx_t_122 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_122 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_122 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
        }
/* … */
        __pyx_t_128 = __pyx_v_ii;
        __pyx_t_129 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_128 &lt; 0) {
          __pyx_t_128 += __pyx_v_Ccontract_v.shape[0];
          if (unlikely(__pyx_t_128 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_128 &gt;= __pyx_v_Ccontract_v.shape[0])) __pyx_t_64 = 0;
        if (__pyx_t_129 &lt; 0) {
          __pyx_t_129 += __pyx_v_Ccontract_v.shape[1];
          if (unlikely(__pyx_t_129 &lt; 0)) __pyx_t_64 = 1;
        } else if (unlikely(__pyx_t_129 &gt;= __pyx_v_Ccontract_v.shape[1])) __pyx_t_64 = 1;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Ccontract_v.data + __pyx_t_128 * __pyx_v_Ccontract_v.strides[0]) ) + __pyx_t_129 * __pyx_v_Ccontract_v.strides[1]) )) = (((__pyx_v_x31v * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_121 * __pyx_v_phi.strides[0]) ))))) - (__pyx_v_y31v * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_122 * __pyx_v_phi.strides[0]) )))))) * ((((__pyx_v_x31v * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_123 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_124 * __pyx_v_ct.strides[0]) )))) + ((__pyx_v_y31v * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_125 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_126 * __pyx_v_ct.strides[0]) ))))) - (__pyx_v_z31v * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_127 * __pyx_v_st.strides[0]) ))))));
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">343</span>:                                     <span class="p">(</span><span class="n">x31v</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">y31v</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">-</span><span class="n">z31v</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span></pre>
<pre class='cython code score-10 '>        __pyx_t_123 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_123 &lt; 0) {
          __pyx_t_123 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_123 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_123 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
        }
        __pyx_t_124 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_124 &lt; 0) {
          __pyx_t_124 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_124 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_124 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
        }
        __pyx_t_125 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_125 &lt; 0) {
          __pyx_t_125 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_125 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_125 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
        }
        __pyx_t_126 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_126 &lt; 0) {
          __pyx_t_126 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_126 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_126 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
        }
        __pyx_t_127 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_127 &lt; 0) {
          __pyx_t_127 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_127 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_127 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">344</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">345</span>:                     <span class="n">Ccontract_w</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x32w</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">-</span><span class="n">y32w</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span> <span class="o">*</span> \</pre>
<pre class='cython code score-6 '>        __pyx_t_130 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_130 &lt; 0) {
          __pyx_t_130 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_130 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_130 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span>
        }
        __pyx_t_131 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_131 &lt; 0) {
          __pyx_t_131 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_131 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_131 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span>
        }
/* … */
        __pyx_t_137 = __pyx_v_ii;
        __pyx_t_138 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_137 &lt; 0) {
          __pyx_t_137 += __pyx_v_Ccontract_w.shape[0];
          if (unlikely(__pyx_t_137 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_137 &gt;= __pyx_v_Ccontract_w.shape[0])) __pyx_t_64 = 0;
        if (__pyx_t_138 &lt; 0) {
          __pyx_t_138 += __pyx_v_Ccontract_w.shape[1];
          if (unlikely(__pyx_t_138 &lt; 0)) __pyx_t_64 = 1;
        } else if (unlikely(__pyx_t_138 &gt;= __pyx_v_Ccontract_w.shape[1])) __pyx_t_64 = 1;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Ccontract_w.data + __pyx_t_137 * __pyx_v_Ccontract_w.strides[0]) ) + __pyx_t_138 * __pyx_v_Ccontract_w.strides[1]) )) = (((__pyx_v_x32w * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_130 * __pyx_v_phi.strides[0]) ))))) - (__pyx_v_y32w * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_131 * __pyx_v_phi.strides[0]) )))))) * ((((__pyx_v_x32w * __pyx_f_15cython_response_cos_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_132 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_133 * __pyx_v_ct.strides[0]) )))) + ((__pyx_v_y32w * __pyx_f_15cython_response_sine_gsl((*((double *) ( /* dim=0 */ (__pyx_v_phi.data + __pyx_t_134 * __pyx_v_phi.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_ct.data + __pyx_t_135 * __pyx_v_ct.strides[0]) ))))) - (__pyx_v_z32w * (*((double *) ( /* dim=0 */ (__pyx_v_st.data + __pyx_t_136 * __pyx_v_st.strides[0]) ))))));
      }
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">346</span>:                                     <span class="p">(</span><span class="n">x32w</span><span class="o">*</span><span class="n">cos_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">y32w</span><span class="o">*</span><span class="n">sine_gsl</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">-</span><span class="n">z32w</span><span class="o">*</span><span class="n">st</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span></pre>
<pre class='cython code score-10 '>        __pyx_t_132 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_132 &lt; 0) {
          __pyx_t_132 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_132 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_132 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span>
        }
        __pyx_t_133 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_133 &lt; 0) {
          __pyx_t_133 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_133 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_133 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span>
        }
        __pyx_t_134 = __pyx_v_ii;
        __pyx_t_64 = -1;
        if (__pyx_t_134 &lt; 0) {
          __pyx_t_134 += __pyx_v_phi.shape[0];
          if (unlikely(__pyx_t_134 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_134 &gt;= __pyx_v_phi.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span>
        }
        __pyx_t_135 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_135 &lt; 0) {
          __pyx_t_135 += __pyx_v_ct.shape[0];
          if (unlikely(__pyx_t_135 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_135 &gt;= __pyx_v_ct.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span>
        }
        __pyx_t_136 = __pyx_v_jj;
        __pyx_t_64 = -1;
        if (__pyx_t_136 &lt; 0) {
          __pyx_t_136 += __pyx_v_st.shape[0];
          if (unlikely(__pyx_t_136 &lt; 0)) __pyx_t_64 = 0;
        } else if (unlikely(__pyx_t_136 &gt;= __pyx_v_st.shape[0])) __pyx_t_64 = 0;
        if (unlikely(__pyx_t_64 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
          <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">347</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">348</span>:             <span class="c"># Calculate the detector response for each frequency</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">349</span>:             <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numfreqs</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_23 = __pyx_v_numfreqs;
    __pyx_t_40 = __pyx_t_23;
    for (__pyx_t_41 = 0; __pyx_t_41 &lt; __pyx_t_40; __pyx_t_41+=1) {
      __pyx_v_ii = __pyx_t_41;
</pre><pre class="cython line score-0">&#xA0;<span class="">350</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">351</span>:                 <span class="n">exp_3f0</span> <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="o">-</span><span class="mf">3</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span></pre>
<pre class='cython code score-2 '>      __pyx_t_139 = __pyx_v_ii;
      __pyx_t_44 = -1;
      if (__pyx_t_139 &lt; 0) {
        __pyx_t_139 += __pyx_v_f0.shape[0];
        if (unlikely(__pyx_t_139 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_139 &gt;= __pyx_v_f0.shape[0])) __pyx_t_44 = 0;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 351, __pyx_L1_error)</span>
      }
      __pyx_v_exp_3f0 = __pyx_f_15cython_response_cmp_exp_gsl((-3.0 * (*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_139 * __pyx_v_f0.strides[0]) )))));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">352</span>:                 <span class="n">exp_f0</span> <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="o">-</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span></pre>
<pre class='cython code score-2 '>      __pyx_t_140 = __pyx_v_ii;
      __pyx_t_44 = -1;
      if (__pyx_t_140 &lt; 0) {
        __pyx_t_140 += __pyx_v_f0.shape[0];
        if (unlikely(__pyx_t_140 &lt; 0)) __pyx_t_44 = 0;
      } else if (unlikely(__pyx_t_140 &gt;= __pyx_v_f0.shape[0])) __pyx_t_44 = 0;
      if (unlikely(__pyx_t_44 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_44);
        <span class='error_goto'>__PYX_ERR(0, 352, __pyx_L1_error)</span>
      }
      __pyx_v_exp_f0 = __pyx_f_15cython_response_cmp_exp_gsl((-(*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_140 * __pyx_v_f0.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">353</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:                 <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numphi</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_44 = __pyx_v_numphi;
      __pyx_t_61 = __pyx_t_44;
      for (__pyx_t_62 = 0; __pyx_t_62 &lt; __pyx_t_61; __pyx_t_62+=1) {
        __pyx_v_jj = __pyx_t_62;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">355</span>:                     <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numtheta</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_64 = __pyx_v_numtheta;
        __pyx_t_141 = __pyx_t_64;
        for (__pyx_t_142 = 0; __pyx_t_142 &lt; __pyx_t_141; __pyx_t_142+=1) {
          __pyx_v_kk = __pyx_t_142;
</pre><pre class="cython line score-0">&#xA0;<span class="">356</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>:                         <span class="n">exp_u_minus</span> <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="o">-</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>          __pyx_t_143 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_143 &lt; 0) {
            __pyx_t_143 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_143 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_143 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
          }
          __pyx_t_145 = __pyx_v_jj;
          __pyx_t_146 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_145 &lt; 0) {
            __pyx_t_145 += __pyx_v_udir.shape[0];
            if (unlikely(__pyx_t_145 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_145 &gt;= __pyx_v_udir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_146 &lt; 0) {
            __pyx_t_146 += __pyx_v_udir.shape[1];
            if (unlikely(__pyx_t_146 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_146 &gt;= __pyx_v_udir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
          }
          __pyx_v_exp_u_minus = __pyx_f_15cython_response_cmp_exp_gsl(((-(*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_143 * __pyx_v_f0.strides[0]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_145 * __pyx_v_udir.strides[0]) ) + __pyx_t_146 * __pyx_v_udir.strides[1]) )))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>:                         <span class="n">exp_v_minus</span> <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="o">-</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>          __pyx_t_147 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_147 &lt; 0) {
            __pyx_t_147 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_147 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_147 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 358, __pyx_L1_error)</span>
          }
          __pyx_t_148 = __pyx_v_jj;
          __pyx_t_149 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_148 &lt; 0) {
            __pyx_t_148 += __pyx_v_vdir.shape[0];
            if (unlikely(__pyx_t_148 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_148 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_149 &lt; 0) {
            __pyx_t_149 += __pyx_v_vdir.shape[1];
            if (unlikely(__pyx_t_149 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_149 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 358, __pyx_L1_error)</span>
          }
          __pyx_v_exp_v_minus = __pyx_f_15cython_response_cmp_exp_gsl(((-(*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_147 * __pyx_v_f0.strides[0]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_148 * __pyx_v_vdir.strides[0]) ) + __pyx_t_149 * __pyx_v_vdir.strides[1]) )))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>:                         <span class="n">exp_w_minus</span> <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="o">-</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">wdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>          __pyx_t_150 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_150 &lt; 0) {
            __pyx_t_150 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_150 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_150 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 359, __pyx_L1_error)</span>
          }
          __pyx_t_151 = __pyx_v_jj;
          __pyx_t_152 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_151 &lt; 0) {
            __pyx_t_151 += __pyx_v_wdir.shape[0];
            if (unlikely(__pyx_t_151 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_151 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_152 &lt; 0) {
            __pyx_t_152 += __pyx_v_wdir.shape[1];
            if (unlikely(__pyx_t_152 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_152 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 359, __pyx_L1_error)</span>
          }
          __pyx_v_exp_w_minus = __pyx_f_15cython_response_cmp_exp_gsl(((-(*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_150 * __pyx_v_f0.strides[0]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_151 * __pyx_v_wdir.strides[0]) ) + __pyx_t_152 * __pyx_v_wdir.strides[1]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">360</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>:                         <span class="n">exp_u_plus</span><span class="p">,</span> <span class="n">exp_v_plus</span><span class="p">,</span> <span class="n">exp_w_plus</span>   <span class="o">=</span> <span class="n">exp_u_minus</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),</span> <span class="n">exp_v_minus</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),</span> <span class="n">exp_w_minus</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>          __pyx_t_153 = __Pyx_c_conj_double(__pyx_v_exp_u_minus);
          __pyx_t_154 = __Pyx_c_conj_double(__pyx_v_exp_v_minus);
          __pyx_t_155 = __Pyx_c_conj_double(__pyx_v_exp_w_minus);
          __pyx_v_exp_u_plus = __pyx_t_153;
          __pyx_v_exp_v_plus = __pyx_t_154;
          __pyx_v_exp_w_plus = __pyx_t_155;
</pre><pre class="cython line score-0">&#xA0;<span class="">362</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">363</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">364</span>:                         <span class="c"># Calculate GW transfer function for the michelson channels</span></pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">365</span>:                         <span class="n">gammaU_plus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>          __pyx_t_156 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_156 &lt; 0) {
            __pyx_t_156 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_156 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_156 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L1_error)</span>
          }
          __pyx_t_157 = __pyx_v_jj;
          __pyx_t_158 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_157 &lt; 0) {
            __pyx_t_157 += __pyx_v_udir.shape[0];
            if (unlikely(__pyx_t_157 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_157 &gt;= __pyx_v_udir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_158 &lt; 0) {
            __pyx_t_158 += __pyx_v_udir.shape[1];
            if (unlikely(__pyx_t_158 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_158 &gt;= __pyx_v_udir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L1_error)</span>
          }
          __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_156 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_157 * __pyx_v_udir.strides[0]) ) + __pyx_t_158 * __pyx_v_udir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L1_error)</span>
          }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">366</span>:                                      <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_u_minus</span></pre>
<pre class='cython code score-9 '>          __pyx_t_159 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_159 &lt; 0) {
            __pyx_t_159 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_159 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_159 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
          }
          __pyx_t_160 = __pyx_v_jj;
          __pyx_t_161 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_160 &lt; 0) {
            __pyx_t_160 += __pyx_v_udir.shape[0];
            if (unlikely(__pyx_t_160 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_160 &gt;= __pyx_v_udir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_161 &lt; 0) {
            __pyx_t_161 += __pyx_v_udir.shape[1];
            if (unlikely(__pyx_t_161 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_161 &gt;= __pyx_v_udir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
          }
          __pyx_t_162 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_159 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_160 * __pyx_v_udir.strides[0]) ) + __pyx_t_161 * __pyx_v_udir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
          }
/* … */
          __pyx_v_gammaU_plus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_162 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_u_minus);
</pre><pre class="cython line score-0">&#xA0;<span class="">367</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">368</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:                         <span class="n">gammaV_plus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>          __pyx_t_163 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_163 &lt; 0) {
            __pyx_t_163 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_163 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_163 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
          }
          __pyx_t_164 = __pyx_v_jj;
          __pyx_t_165 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_164 &lt; 0) {
            __pyx_t_164 += __pyx_v_vdir.shape[0];
            if (unlikely(__pyx_t_164 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_164 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_165 &lt; 0) {
            __pyx_t_165 += __pyx_v_vdir.shape[1];
            if (unlikely(__pyx_t_165 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_165 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
          }
          __pyx_t_162 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_163 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_164 * __pyx_v_vdir.strides[0]) ) + __pyx_t_165 * __pyx_v_vdir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
          }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>:                                      <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_v_minus</span></pre>
<pre class='cython code score-9 '>          __pyx_t_166 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_166 &lt; 0) {
            __pyx_t_166 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_166 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_166 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
          }
          __pyx_t_167 = __pyx_v_jj;
          __pyx_t_168 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_167 &lt; 0) {
            __pyx_t_167 += __pyx_v_vdir.shape[0];
            if (unlikely(__pyx_t_167 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_167 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_168 &lt; 0) {
            __pyx_t_168 += __pyx_v_vdir.shape[1];
            if (unlikely(__pyx_t_168 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_168 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
          }
          __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_166 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_167 * __pyx_v_vdir.strides[0]) ) + __pyx_t_168 * __pyx_v_vdir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
          }
/* … */
          __pyx_v_gammaV_plus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_162 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_v_minus);
</pre><pre class="cython line score-0">&#xA0;<span class="">371</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>:                         <span class="n">gammaW_plus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">wdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>          __pyx_t_169 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_169 &lt; 0) {
            __pyx_t_169 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_169 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_169 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span>
          }
          __pyx_t_170 = __pyx_v_jj;
          __pyx_t_171 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_170 &lt; 0) {
            __pyx_t_170 += __pyx_v_wdir.shape[0];
            if (unlikely(__pyx_t_170 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_170 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_171 &lt; 0) {
            __pyx_t_171 += __pyx_v_wdir.shape[1];
            if (unlikely(__pyx_t_171 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_171 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span>
          }
          __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_169 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_170 * __pyx_v_wdir.strides[0]) ) + __pyx_t_171 * __pyx_v_wdir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span>
          }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>:                                      <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">wdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_w_minus</span></pre>
<pre class='cython code score-9 '>          __pyx_t_172 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_172 &lt; 0) {
            __pyx_t_172 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_172 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_172 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>
          }
          __pyx_t_173 = __pyx_v_jj;
          __pyx_t_174 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_173 &lt; 0) {
            __pyx_t_173 += __pyx_v_wdir.shape[0];
            if (unlikely(__pyx_t_173 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_173 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_174 &lt; 0) {
            __pyx_t_174 += __pyx_v_wdir.shape[1];
            if (unlikely(__pyx_t_174 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_174 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>
          }
          __pyx_t_162 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_172 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_173 * __pyx_v_wdir.strides[0]) ) + __pyx_t_174 * __pyx_v_wdir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>
          }
/* … */
          __pyx_v_gammaW_plus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_162 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_w_minus);
</pre><pre class="cython line score-0">&#xA0;<span class="">374</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">375</span>:                         <span class="c"># Calculate GW transfer function for the michelson channels</span></pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">376</span>:                         <span class="n">gammaU_minus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>          __pyx_t_175 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_175 &lt; 0) {
            __pyx_t_175 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_175 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_175 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L1_error)</span>
          }
          __pyx_t_176 = __pyx_v_jj;
          __pyx_t_177 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_176 &lt; 0) {
            __pyx_t_176 += __pyx_v_udir.shape[0];
            if (unlikely(__pyx_t_176 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_176 &gt;= __pyx_v_udir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_177 &lt; 0) {
            __pyx_t_177 += __pyx_v_udir.shape[1];
            if (unlikely(__pyx_t_177 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_177 &gt;= __pyx_v_udir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L1_error)</span>
          }
          __pyx_t_162 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_175 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_176 * __pyx_v_udir.strides[0]) ) + __pyx_t_177 * __pyx_v_udir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L1_error)</span>
          }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>:                                      <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_u_plus</span></pre>
<pre class='cython code score-9 '>          __pyx_t_178 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_178 &lt; 0) {
            __pyx_t_178 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_178 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_178 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
          }
          __pyx_t_179 = __pyx_v_jj;
          __pyx_t_180 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_179 &lt; 0) {
            __pyx_t_179 += __pyx_v_udir.shape[0];
            if (unlikely(__pyx_t_179 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_179 &gt;= __pyx_v_udir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_180 &lt; 0) {
            __pyx_t_180 += __pyx_v_udir.shape[1];
            if (unlikely(__pyx_t_180 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_180 &gt;= __pyx_v_udir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
          }
          __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_178 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_179 * __pyx_v_udir.strides[0]) ) + __pyx_t_180 * __pyx_v_udir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
          }
/* … */
          __pyx_v_gammaU_minus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_162 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_u_plus);
</pre><pre class="cython line score-0">&#xA0;<span class="">378</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">379</span>:                         <span class="n">gammaV_minus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>          __pyx_t_181 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_181 &lt; 0) {
            __pyx_t_181 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_181 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_181 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
          }
          __pyx_t_182 = __pyx_v_jj;
          __pyx_t_183 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_182 &lt; 0) {
            __pyx_t_182 += __pyx_v_vdir.shape[0];
            if (unlikely(__pyx_t_182 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_182 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_183 &lt; 0) {
            __pyx_t_183 += __pyx_v_vdir.shape[1];
            if (unlikely(__pyx_t_183 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_183 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
          }
          __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_181 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_182 * __pyx_v_vdir.strides[0]) ) + __pyx_t_183 * __pyx_v_vdir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
          }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>:                                      <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_v_plus</span></pre>
<pre class='cython code score-9 '>          __pyx_t_184 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_184 &lt; 0) {
            __pyx_t_184 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_184 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_184 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 380, __pyx_L1_error)</span>
          }
          __pyx_t_185 = __pyx_v_jj;
          __pyx_t_186 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_185 &lt; 0) {
            __pyx_t_185 += __pyx_v_vdir.shape[0];
            if (unlikely(__pyx_t_185 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_185 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_186 &lt; 0) {
            __pyx_t_186 += __pyx_v_vdir.shape[1];
            if (unlikely(__pyx_t_186 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_186 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 380, __pyx_L1_error)</span>
          }
          __pyx_t_162 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_184 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_185 * __pyx_v_vdir.strides[0]) ) + __pyx_t_186 * __pyx_v_vdir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 380, __pyx_L1_error)</span>
          }
/* … */
          __pyx_v_gammaV_minus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_162 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_v_plus);
</pre><pre class="cython line score-0">&#xA0;<span class="">381</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">382</span>:                         <span class="n">gammaW_minus</span>    <span class="o">=</span>    <span class="mf">1</span><span class="o">/</span><span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">wdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span> <span class="o">+</span> \</pre>
<pre class='cython code score-9 '>          __pyx_t_187 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_187 &lt; 0) {
            __pyx_t_187 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_187 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_187 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>
          }
          __pyx_t_188 = __pyx_v_jj;
          __pyx_t_189 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_188 &lt; 0) {
            __pyx_t_188 += __pyx_v_wdir.shape[0];
            if (unlikely(__pyx_t_188 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_188 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_189 &lt; 0) {
            __pyx_t_189 += __pyx_v_wdir.shape[1];
            if (unlikely(__pyx_t_189 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_189 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>
          }
          __pyx_t_162 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_187 * __pyx_v_f0.strides[0]) ))) * (1.0 + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_188 * __pyx_v_wdir.strides[0]) ) + __pyx_t_189 * __pyx_v_wdir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>
          }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>:                                      <span class="n">sinc_gsl</span><span class="p">((</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">wdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span><span class="o">/</span><span class="n">pi_val</span><span class="p">)</span><span class="o">*</span><span class="n">exp_3f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp_w_plus</span></pre>
<pre class='cython code score-9 '>          __pyx_t_190 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_190 &lt; 0) {
            __pyx_t_190 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_190 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_190 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 383, __pyx_L1_error)</span>
          }
          __pyx_t_191 = __pyx_v_jj;
          __pyx_t_192 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_191 &lt; 0) {
            __pyx_t_191 += __pyx_v_wdir.shape[0];
            if (unlikely(__pyx_t_191 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_191 &gt;= __pyx_v_wdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_192 &lt; 0) {
            __pyx_t_192 += __pyx_v_wdir.shape[1];
            if (unlikely(__pyx_t_192 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_192 &gt;= __pyx_v_wdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 383, __pyx_L1_error)</span>
          }
          __pyx_t_13 = ((*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_190 * __pyx_v_f0.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_wdir.data + __pyx_t_191 * __pyx_v_wdir.strides[0]) ) + __pyx_t_192 * __pyx_v_wdir.strides[1]) )))));
          if (unlikely(__pyx_v_pi_val == 0)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            <span class='error_goto'>__PYX_ERR(0, 383, __pyx_L1_error)</span>
          }
/* … */
          __pyx_v_gammaW_minus = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((1.0 / 2.0), 0), __Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_162 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_sinc_gsl((__pyx_t_13 / __pyx_v_pi_val)), 0), __pyx_v_exp_3f0))), __pyx_v_exp_w_plus);
</pre><pre class="cython line score-0">&#xA0;<span class="">384</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">385</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>:                         <span class="n">exp_u</span>  <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">udir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>          __pyx_t_193 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_193 &lt; 0) {
            __pyx_t_193 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_193 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_193 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 386, __pyx_L1_error)</span>
          }
          __pyx_t_194 = __pyx_v_jj;
          __pyx_t_195 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_194 &lt; 0) {
            __pyx_t_194 += __pyx_v_udir.shape[0];
            if (unlikely(__pyx_t_194 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_194 &gt;= __pyx_v_udir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_195 &lt; 0) {
            __pyx_t_195 += __pyx_v_udir.shape[1];
            if (unlikely(__pyx_t_195 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_195 &gt;= __pyx_v_udir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 386, __pyx_L1_error)</span>
          }
          __pyx_v_exp_u = __pyx_f_15cython_response_cmp_exp_gsl(((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_193 * __pyx_v_f0.strides[0]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_udir.data + __pyx_t_194 * __pyx_v_udir.strides[0]) ) + __pyx_t_195 * __pyx_v_udir.strides[1]) )))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">387</span>:                         <span class="n">exp_v</span>  <span class="o">=</span> <span class="n">cmp_exp_gsl</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">f0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">vdir</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>          __pyx_t_196 = __pyx_v_ii;
          __pyx_t_144 = -1;
          if (__pyx_t_196 &lt; 0) {
            __pyx_t_196 += __pyx_v_f0.shape[0];
            if (unlikely(__pyx_t_196 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_196 &gt;= __pyx_v_f0.shape[0])) __pyx_t_144 = 0;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 387, __pyx_L1_error)</span>
          }
          __pyx_t_197 = __pyx_v_jj;
          __pyx_t_198 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_197 &lt; 0) {
            __pyx_t_197 += __pyx_v_vdir.shape[0];
            if (unlikely(__pyx_t_197 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_197 &gt;= __pyx_v_vdir.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_198 &lt; 0) {
            __pyx_t_198 += __pyx_v_vdir.shape[1];
            if (unlikely(__pyx_t_198 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_198 &gt;= __pyx_v_vdir.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 387, __pyx_L1_error)</span>
          }
          __pyx_v_exp_v = __pyx_f_15cython_response_cmp_exp_gsl(((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_f0.data + __pyx_t_196 * __pyx_v_f0.strides[0]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vdir.data + __pyx_t_197 * __pyx_v_vdir.strides[0]) ) + __pyx_t_198 * __pyx_v_vdir.strides[1]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">388</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">389</span>:                         <span class="c">## Michelson antenna patterns: Calculate Fplus</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>:                         <span class="n">Fplus1</span> <span class="o">=</span> <span class="n">Pcontract_u</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaU_plus</span> <span class="o">-</span> <span class="n">Pcontract_v</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaV_plus</span></pre>
<pre class='cython code score-4 '>          __pyx_t_199 = __pyx_v_jj;
          __pyx_t_200 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_199 &lt; 0) {
            __pyx_t_199 += __pyx_v_Pcontract_u.shape[0];
            if (unlikely(__pyx_t_199 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_199 &gt;= __pyx_v_Pcontract_u.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_200 &lt; 0) {
            __pyx_t_200 += __pyx_v_Pcontract_u.shape[1];
            if (unlikely(__pyx_t_200 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_200 &gt;= __pyx_v_Pcontract_u.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 390, __pyx_L1_error)</span>
          }
          __pyx_t_201 = __pyx_v_jj;
          __pyx_t_202 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_201 &lt; 0) {
            __pyx_t_201 += __pyx_v_Pcontract_v.shape[0];
            if (unlikely(__pyx_t_201 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_201 &gt;= __pyx_v_Pcontract_v.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_202 &lt; 0) {
            __pyx_t_202 += __pyx_v_Pcontract_v.shape[1];
            if (unlikely(__pyx_t_202 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_202 &gt;= __pyx_v_Pcontract_v.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 390, __pyx_L1_error)</span>
          }
          __pyx_v_Fplus1 = __Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Pcontract_u.data + __pyx_t_199 * __pyx_v_Pcontract_u.strides[0]) ) + __pyx_t_200 * __pyx_v_Pcontract_u.strides[1]) ))), 0), __pyx_v_gammaU_plus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Pcontract_v.data + __pyx_t_201 * __pyx_v_Pcontract_v.strides[0]) ) + __pyx_t_202 * __pyx_v_Pcontract_v.strides[1]) ))), 0), __pyx_v_gammaV_plus));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">391</span>:                         <span class="n">Fplus2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pcontract_w</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaW_plus</span> <span class="o">-</span> <span class="n">Pcontract_u</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaU_minus</span><span class="p">)</span><span class="o">*</span><span class="n">exp_u</span></pre>
<pre class='cython code score-4 '>          __pyx_t_203 = __pyx_v_jj;
          __pyx_t_204 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_203 &lt; 0) {
            __pyx_t_203 += __pyx_v_Pcontract_w.shape[0];
            if (unlikely(__pyx_t_203 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_203 &gt;= __pyx_v_Pcontract_w.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_204 &lt; 0) {
            __pyx_t_204 += __pyx_v_Pcontract_w.shape[1];
            if (unlikely(__pyx_t_204 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_204 &gt;= __pyx_v_Pcontract_w.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 391, __pyx_L1_error)</span>
          }
          __pyx_t_205 = __pyx_v_jj;
          __pyx_t_206 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_205 &lt; 0) {
            __pyx_t_205 += __pyx_v_Pcontract_u.shape[0];
            if (unlikely(__pyx_t_205 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_205 &gt;= __pyx_v_Pcontract_u.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_206 &lt; 0) {
            __pyx_t_206 += __pyx_v_Pcontract_u.shape[1];
            if (unlikely(__pyx_t_206 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_206 &gt;= __pyx_v_Pcontract_u.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 391, __pyx_L1_error)</span>
          }
          __pyx_v_Fplus2 = __Pyx_c_prod_double(__Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Pcontract_w.data + __pyx_t_203 * __pyx_v_Pcontract_w.strides[0]) ) + __pyx_t_204 * __pyx_v_Pcontract_w.strides[1]) ))), 0), __pyx_v_gammaW_plus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Pcontract_u.data + __pyx_t_205 * __pyx_v_Pcontract_u.strides[0]) ) + __pyx_t_206 * __pyx_v_Pcontract_u.strides[1]) ))), 0), __pyx_v_gammaU_minus)), __pyx_v_exp_u);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">392</span>:                         <span class="n">Fplus3</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pcontract_v</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaV_minus</span> <span class="o">-</span> <span class="n">Pcontract_w</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaW_minus</span><span class="p">)</span><span class="o">*</span><span class="n">exp_v</span></pre>
<pre class='cython code score-4 '>          __pyx_t_207 = __pyx_v_jj;
          __pyx_t_208 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_207 &lt; 0) {
            __pyx_t_207 += __pyx_v_Pcontract_v.shape[0];
            if (unlikely(__pyx_t_207 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_207 &gt;= __pyx_v_Pcontract_v.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_208 &lt; 0) {
            __pyx_t_208 += __pyx_v_Pcontract_v.shape[1];
            if (unlikely(__pyx_t_208 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_208 &gt;= __pyx_v_Pcontract_v.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 392, __pyx_L1_error)</span>
          }
          __pyx_t_209 = __pyx_v_jj;
          __pyx_t_210 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_209 &lt; 0) {
            __pyx_t_209 += __pyx_v_Pcontract_w.shape[0];
            if (unlikely(__pyx_t_209 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_209 &gt;= __pyx_v_Pcontract_w.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_210 &lt; 0) {
            __pyx_t_210 += __pyx_v_Pcontract_w.shape[1];
            if (unlikely(__pyx_t_210 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_210 &gt;= __pyx_v_Pcontract_w.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 392, __pyx_L1_error)</span>
          }
          __pyx_v_Fplus3 = __Pyx_c_prod_double(__Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Pcontract_v.data + __pyx_t_207 * __pyx_v_Pcontract_v.strides[0]) ) + __pyx_t_208 * __pyx_v_Pcontract_v.strides[1]) ))), 0), __pyx_v_gammaV_minus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Pcontract_w.data + __pyx_t_209 * __pyx_v_Pcontract_w.strides[0]) ) + __pyx_t_210 * __pyx_v_Pcontract_w.strides[1]) ))), 0), __pyx_v_gammaW_minus)), __pyx_v_exp_v);
</pre><pre class="cython line score-0">&#xA0;<span class="">393</span>:                         <span class="c">## Michelson antenna patterns: Calculate Fcross</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">394</span>:                         <span class="n">Fcross1</span> <span class="o">=</span> <span class="n">Ccontract_u</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaU_plus</span> <span class="o">-</span> <span class="n">Ccontract_v</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaV_plus</span></pre>
<pre class='cython code score-4 '>          __pyx_t_211 = __pyx_v_jj;
          __pyx_t_212 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_211 &lt; 0) {
            __pyx_t_211 += __pyx_v_Ccontract_u.shape[0];
            if (unlikely(__pyx_t_211 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_211 &gt;= __pyx_v_Ccontract_u.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_212 &lt; 0) {
            __pyx_t_212 += __pyx_v_Ccontract_u.shape[1];
            if (unlikely(__pyx_t_212 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_212 &gt;= __pyx_v_Ccontract_u.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 394, __pyx_L1_error)</span>
          }
          __pyx_t_213 = __pyx_v_jj;
          __pyx_t_214 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_213 &lt; 0) {
            __pyx_t_213 += __pyx_v_Ccontract_v.shape[0];
            if (unlikely(__pyx_t_213 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_213 &gt;= __pyx_v_Ccontract_v.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_214 &lt; 0) {
            __pyx_t_214 += __pyx_v_Ccontract_v.shape[1];
            if (unlikely(__pyx_t_214 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_214 &gt;= __pyx_v_Ccontract_v.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 394, __pyx_L1_error)</span>
          }
          __pyx_v_Fcross1 = __Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Ccontract_u.data + __pyx_t_211 * __pyx_v_Ccontract_u.strides[0]) ) + __pyx_t_212 * __pyx_v_Ccontract_u.strides[1]) ))), 0), __pyx_v_gammaU_plus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Ccontract_v.data + __pyx_t_213 * __pyx_v_Ccontract_v.strides[0]) ) + __pyx_t_214 * __pyx_v_Ccontract_v.strides[1]) ))), 0), __pyx_v_gammaV_plus));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">395</span>:                         <span class="n">Fcross2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ccontract_w</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaW_plus</span> <span class="o">-</span> <span class="n">Ccontract_u</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaU_minus</span><span class="p">)</span><span class="o">*</span><span class="n">exp_u</span></pre>
<pre class='cython code score-4 '>          __pyx_t_215 = __pyx_v_jj;
          __pyx_t_216 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_215 &lt; 0) {
            __pyx_t_215 += __pyx_v_Ccontract_w.shape[0];
            if (unlikely(__pyx_t_215 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_215 &gt;= __pyx_v_Ccontract_w.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_216 &lt; 0) {
            __pyx_t_216 += __pyx_v_Ccontract_w.shape[1];
            if (unlikely(__pyx_t_216 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_216 &gt;= __pyx_v_Ccontract_w.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 395, __pyx_L1_error)</span>
          }
          __pyx_t_217 = __pyx_v_jj;
          __pyx_t_218 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_217 &lt; 0) {
            __pyx_t_217 += __pyx_v_Ccontract_u.shape[0];
            if (unlikely(__pyx_t_217 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_217 &gt;= __pyx_v_Ccontract_u.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_218 &lt; 0) {
            __pyx_t_218 += __pyx_v_Ccontract_u.shape[1];
            if (unlikely(__pyx_t_218 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_218 &gt;= __pyx_v_Ccontract_u.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 395, __pyx_L1_error)</span>
          }
          __pyx_v_Fcross2 = __Pyx_c_prod_double(__Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Ccontract_w.data + __pyx_t_215 * __pyx_v_Ccontract_w.strides[0]) ) + __pyx_t_216 * __pyx_v_Ccontract_w.strides[1]) ))), 0), __pyx_v_gammaW_plus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Ccontract_u.data + __pyx_t_217 * __pyx_v_Ccontract_u.strides[0]) ) + __pyx_t_218 * __pyx_v_Ccontract_u.strides[1]) ))), 0), __pyx_v_gammaU_minus)), __pyx_v_exp_u);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">396</span>:                         <span class="n">Fcross3</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ccontract_v</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaV_minus</span> <span class="o">-</span> <span class="n">Ccontract_w</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">gammaW_minus</span><span class="p">)</span><span class="o">*</span><span class="n">exp_v</span></pre>
<pre class='cython code score-4 '>          __pyx_t_219 = __pyx_v_jj;
          __pyx_t_220 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_219 &lt; 0) {
            __pyx_t_219 += __pyx_v_Ccontract_v.shape[0];
            if (unlikely(__pyx_t_219 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_219 &gt;= __pyx_v_Ccontract_v.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_220 &lt; 0) {
            __pyx_t_220 += __pyx_v_Ccontract_v.shape[1];
            if (unlikely(__pyx_t_220 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_220 &gt;= __pyx_v_Ccontract_v.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 396, __pyx_L1_error)</span>
          }
          __pyx_t_221 = __pyx_v_jj;
          __pyx_t_222 = __pyx_v_kk;
          __pyx_t_144 = -1;
          if (__pyx_t_221 &lt; 0) {
            __pyx_t_221 += __pyx_v_Ccontract_w.shape[0];
            if (unlikely(__pyx_t_221 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_221 &gt;= __pyx_v_Ccontract_w.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_222 &lt; 0) {
            __pyx_t_222 += __pyx_v_Ccontract_w.shape[1];
            if (unlikely(__pyx_t_222 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_222 &gt;= __pyx_v_Ccontract_w.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 396, __pyx_L1_error)</span>
          }
          __pyx_v_Fcross3 = __Pyx_c_prod_double(__Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Ccontract_v.data + __pyx_t_219 * __pyx_v_Ccontract_v.strides[0]) ) + __pyx_t_220 * __pyx_v_Ccontract_v.strides[1]) ))), 0), __pyx_v_gammaV_minus), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Ccontract_w.data + __pyx_t_221 * __pyx_v_Ccontract_w.strides[0]) ) + __pyx_t_222 * __pyx_v_Ccontract_w.strides[1]) ))), 0), __pyx_v_gammaW_minus)), __pyx_v_exp_v);
</pre><pre class="cython line score-0">&#xA0;<span class="">397</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">398</span>:                         <span class="c">## Directional random number</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>:                         <span class="n">rand_plus</span> <span class="o">=</span> <span class="n">unit_nrm_gsl</span><span class="p">()</span> <span class="o">+</span> <span class="mf">1</span><span class="n">j</span><span class="o">*</span><span class="n">unit_nrm_gsl</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>          __pyx_v_rand_plus = __Pyx_c_sum_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_unit_nrm_gsl(), 0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0, 1.0), __pyx_t_double_complex_from_parts(__pyx_f_15cython_response_unit_nrm_gsl(), 0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">400</span>:                         <span class="n">rand_cross</span> <span class="o">=</span> <span class="n">unit_nrm_gsl</span><span class="p">()</span> <span class="o">+</span> <span class="mf">1</span><span class="n">j</span><span class="o">*</span> <span class="n">unit_nrm_gsl</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>          __pyx_v_rand_cross = __Pyx_c_sum_double(__pyx_t_double_complex_from_parts(__pyx_f_15cython_response_unit_nrm_gsl(), 0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0, 1.0), __pyx_t_double_complex_from_parts(__pyx_f_15cython_response_unit_nrm_gsl(), 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">401</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">402</span>:                         <span class="c">## Detector response summed over polarization and integrated over sky direction</span></pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">403</span>:                         <span class="n">R1</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">R1</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R1</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fplus1</span><span class="o">*</span><span class="n">rand_plus</span><span class="p">,</span> <span class="n">R1</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fcross1</span><span class="o">*</span><span class="n">rand_cross</span></pre>
<pre class='cython code score-84 '>          __pyx_t_223 = __pyx_v_ii;
          __pyx_t_224 = 0;
          __pyx_t_144 = -1;
          if (__pyx_t_223 &lt; 0) {
            __pyx_t_223 += __pyx_v_R1.shape[0];
            if (unlikely(__pyx_t_223 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_223 &gt;= __pyx_v_R1.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_224 &lt; 0) {
            __pyx_t_224 += __pyx_v_R1.shape[1];
            if (unlikely(__pyx_t_224 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_224 &gt;= __pyx_v_R1.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
          }
          __pyx_t_155 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R1.data + __pyx_t_223 * __pyx_v_R1.strides[0]) ) + __pyx_t_224 * __pyx_v_R1.strides[1]) )));
          __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_155);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fplus1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_plus);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_59 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_59);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
          __pyx_t_155 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_225 = __pyx_v_ii;
          __pyx_t_226 = 1;
          __pyx_t_144 = -1;
          if (__pyx_t_225 &lt; 0) {
            __pyx_t_225 += __pyx_v_R1.shape[0];
            if (unlikely(__pyx_t_225 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_225 &gt;= __pyx_v_R1.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_226 &lt; 0) {
            __pyx_t_226 += __pyx_v_R1.shape[1];
            if (unlikely(__pyx_t_226 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_226 &gt;= __pyx_v_R1.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
          }
          __pyx_t_154 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R1.data + __pyx_t_225 * __pyx_v_R1.strides[0]) ) + __pyx_t_226 * __pyx_v_R1.strides[1]) )));
          __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_154);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_59 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fcross1);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
          __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_59);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
          __pyx_t_59 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_cross);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
          __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_59);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
          __pyx_t_59 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_154 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_59);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 403, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
          __pyx_t_227 = __pyx_v_ii;
          __pyx_t_228 = 0;
          __pyx_t_144 = -1;
          if (__pyx_t_227 &lt; 0) {
            __pyx_t_227 += __pyx_v_R1.shape[0];
            if (unlikely(__pyx_t_227 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_227 &gt;= __pyx_v_R1.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_228 &lt; 0) {
            __pyx_t_228 += __pyx_v_R1.shape[1];
            if (unlikely(__pyx_t_228 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_228 &gt;= __pyx_v_R1.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
          }
          *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R1.data + __pyx_t_227 * __pyx_v_R1.strides[0]) ) + __pyx_t_228 * __pyx_v_R1.strides[1]) )) = __pyx_t_155;
          __pyx_t_229 = __pyx_v_ii;
          __pyx_t_230 = 1;
          __pyx_t_144 = -1;
          if (__pyx_t_229 &lt; 0) {
            __pyx_t_229 += __pyx_v_R1.shape[0];
            if (unlikely(__pyx_t_229 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_229 &gt;= __pyx_v_R1.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_230 &lt; 0) {
            __pyx_t_230 += __pyx_v_R1.shape[1];
            if (unlikely(__pyx_t_230 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_230 &gt;= __pyx_v_R1.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
          }
          *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R1.data + __pyx_t_229 * __pyx_v_R1.strides[0]) ) + __pyx_t_230 * __pyx_v_R1.strides[1]) )) = __pyx_t_154;
</pre><pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">404</span>:                         <span class="n">R2</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">R2</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R2</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fplus2</span><span class="o">*</span><span class="n">rand_plus</span><span class="p">,</span> <span class="n">R2</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fcross2</span><span class="o">*</span><span class="n">rand_cross</span></pre>
<pre class='cython code score-84 '>          __pyx_t_231 = __pyx_v_ii;
          __pyx_t_232 = 0;
          __pyx_t_144 = -1;
          if (__pyx_t_231 &lt; 0) {
            __pyx_t_231 += __pyx_v_R2.shape[0];
            if (unlikely(__pyx_t_231 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_231 &gt;= __pyx_v_R2.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_232 &lt; 0) {
            __pyx_t_232 += __pyx_v_R2.shape[1];
            if (unlikely(__pyx_t_232 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_232 &gt;= __pyx_v_R2.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L1_error)</span>
          }
          __pyx_t_154 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R2.data + __pyx_t_231 * __pyx_v_R2.strides[0]) ) + __pyx_t_232 * __pyx_v_R2.strides[1]) )));
          __pyx_t_59 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_154);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
          __pyx_t_4 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fplus2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_plus);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_59, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_154 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_233 = __pyx_v_ii;
          __pyx_t_234 = 1;
          __pyx_t_144 = -1;
          if (__pyx_t_233 &lt; 0) {
            __pyx_t_233 += __pyx_v_R2.shape[0];
            if (unlikely(__pyx_t_233 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_233 &gt;= __pyx_v_R2.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_234 &lt; 0) {
            __pyx_t_234 += __pyx_v_R2.shape[1];
            if (unlikely(__pyx_t_234 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_234 &gt;= __pyx_v_R2.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L1_error)</span>
          }
          __pyx_t_155 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R2.data + __pyx_t_233 * __pyx_v_R2.strides[0]) ) + __pyx_t_234 * __pyx_v_R2.strides[1]) )));
          __pyx_t_4 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_155);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fcross2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          __pyx_t_59 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_cross);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_59, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_155 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 404, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_235 = __pyx_v_ii;
          __pyx_t_236 = 0;
          __pyx_t_144 = -1;
          if (__pyx_t_235 &lt; 0) {
            __pyx_t_235 += __pyx_v_R2.shape[0];
            if (unlikely(__pyx_t_235 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_235 &gt;= __pyx_v_R2.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_236 &lt; 0) {
            __pyx_t_236 += __pyx_v_R2.shape[1];
            if (unlikely(__pyx_t_236 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_236 &gt;= __pyx_v_R2.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L1_error)</span>
          }
          *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R2.data + __pyx_t_235 * __pyx_v_R2.strides[0]) ) + __pyx_t_236 * __pyx_v_R2.strides[1]) )) = __pyx_t_154;
          __pyx_t_237 = __pyx_v_ii;
          __pyx_t_238 = 1;
          __pyx_t_144 = -1;
          if (__pyx_t_237 &lt; 0) {
            __pyx_t_237 += __pyx_v_R2.shape[0];
            if (unlikely(__pyx_t_237 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_237 &gt;= __pyx_v_R2.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_238 &lt; 0) {
            __pyx_t_238 += __pyx_v_R2.shape[1];
            if (unlikely(__pyx_t_238 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_238 &gt;= __pyx_v_R2.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L1_error)</span>
          }
          *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R2.data + __pyx_t_237 * __pyx_v_R2.strides[0]) ) + __pyx_t_238 * __pyx_v_R2.strides[1]) )) = __pyx_t_155;
</pre><pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">405</span>:                         <span class="n">R3</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">R3</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R3</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fplus3</span><span class="o">*</span><span class="n">rand_plus</span><span class="p">,</span> <span class="n">R3</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="o">*</span><span class="n">Fcross3</span><span class="o">*</span><span class="n">rand_cross</span></pre>
<pre class='cython code score-84 '>          __pyx_t_239 = __pyx_v_ii;
          __pyx_t_240 = 0;
          __pyx_t_144 = -1;
          if (__pyx_t_239 &lt; 0) {
            __pyx_t_239 += __pyx_v_R3.shape[0];
            if (unlikely(__pyx_t_239 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_239 &gt;= __pyx_v_R3.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_240 &lt; 0) {
            __pyx_t_240 += __pyx_v_R3.shape[1];
            if (unlikely(__pyx_t_240 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_240 &gt;= __pyx_v_R3.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>
          }
          __pyx_t_155 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R3.data + __pyx_t_239 * __pyx_v_R3.strides[0]) ) + __pyx_t_240 * __pyx_v_R3.strides[1]) )));
          __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_155);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fplus3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_plus);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_59 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_59);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
          __pyx_t_155 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_241 = __pyx_v_ii;
          __pyx_t_242 = 1;
          __pyx_t_144 = -1;
          if (__pyx_t_241 &lt; 0) {
            __pyx_t_241 += __pyx_v_R3.shape[0];
            if (unlikely(__pyx_t_241 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_241 &gt;= __pyx_v_R3.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_242 &lt; 0) {
            __pyx_t_242 += __pyx_v_R3.shape[1];
            if (unlikely(__pyx_t_242 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_242 &gt;= __pyx_v_R3.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>
          }
          __pyx_t_154 = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R3.data + __pyx_t_241 * __pyx_v_R3.strides[0]) ) + __pyx_t_242 * __pyx_v_R3.strides[1]) )));
          __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_154);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_59 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_Fcross3);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
          __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_norm, __pyx_t_59);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
          __pyx_t_59 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_rand_cross);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
          __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_59);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
          __pyx_t_59 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_59)) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_59);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_154 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_59);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 405, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_59); __pyx_t_59 = 0;
          __pyx_t_243 = __pyx_v_ii;
          __pyx_t_244 = 0;
          __pyx_t_144 = -1;
          if (__pyx_t_243 &lt; 0) {
            __pyx_t_243 += __pyx_v_R3.shape[0];
            if (unlikely(__pyx_t_243 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_243 &gt;= __pyx_v_R3.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_244 &lt; 0) {
            __pyx_t_244 += __pyx_v_R3.shape[1];
            if (unlikely(__pyx_t_244 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_244 &gt;= __pyx_v_R3.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>
          }
          *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R3.data + __pyx_t_243 * __pyx_v_R3.strides[0]) ) + __pyx_t_244 * __pyx_v_R3.strides[1]) )) = __pyx_t_155;
          __pyx_t_245 = __pyx_v_ii;
          __pyx_t_246 = 1;
          __pyx_t_144 = -1;
          if (__pyx_t_245 &lt; 0) {
            __pyx_t_245 += __pyx_v_R3.shape[0];
            if (unlikely(__pyx_t_245 &lt; 0)) __pyx_t_144 = 0;
          } else if (unlikely(__pyx_t_245 &gt;= __pyx_v_R3.shape[0])) __pyx_t_144 = 0;
          if (__pyx_t_246 &lt; 0) {
            __pyx_t_246 += __pyx_v_R3.shape[1];
            if (unlikely(__pyx_t_246 &lt; 0)) __pyx_t_144 = 1;
          } else if (unlikely(__pyx_t_246 &gt;= __pyx_v_R3.shape[1])) __pyx_t_144 = 1;
          if (unlikely(__pyx_t_144 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_144);
            <span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>
          }
          *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_R3.data + __pyx_t_245 * __pyx_v_R3.strides[0]) ) + __pyx_t_246 * __pyx_v_R3.strides[1]) )) = __pyx_t_154;
        }
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">406</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">407</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">408</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">409</span>:         <span class="c">#return R1, R2, R3</span></pre>
</div></body></html>
